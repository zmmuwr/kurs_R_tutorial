<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Wykresy - pakiet ggplot2 | Kurs R - Tutorial</title>
  <meta name="description" content="Pomoc do kursu R - zawiera przykłady użycia języka R do analizy i wizualizacji danych głównie przy użyciu pakietów tidyverse" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Wykresy - pakiet ggplot2 | Kurs R - Tutorial" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Pomoc do kursu R - zawiera przykłady użycia języka R do analizy i wizualizacji danych głównie przy użyciu pakietów tidyverse" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Wykresy - pakiet ggplot2 | Kurs R - Tutorial" />
  
  <meta name="twitter:description" content="Pomoc do kursu R - zawiera przykłady użycia języka R do analizy i wizualizacji danych głównie przy użyciu pakietów tidyverse" />
  

<meta name="author" content="Agnieszka Strzałka" />


<meta name="date" content="2021-08-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="analiza-i-transformacja-danych.html"/>
<link rel="next" href="wykresy---pakiet-podstawowy.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Pomoc do kursu R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Wstęp</a></li>
<li class="chapter" data-level="2" data-path="skąd-ściągnąć-r.html"><a href="skąd-ściągnąć-r.html"><i class="fa fa-check"></i><b>2</b> Skąd ściągnąć R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="skąd-ściągnąć-r.html"><a href="skąd-ściągnąć-r.html#pomoc"><i class="fa fa-check"></i><b>2.1</b> Pomoc</a></li>
<li class="chapter" data-level="2.2" data-path="skąd-ściągnąć-r.html"><a href="skąd-ściągnąć-r.html#packages"><i class="fa fa-check"></i><b>2.2</b> Packages</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="skąd-ściągnąć-r.html"><a href="skąd-ściągnąć-r.html#lista-pakietów-które-pojawiają-się-w-książce-uwaga-może-być-niekompletna"><i class="fa fa-check"></i><b>2.2.1</b> Lista pakietów, które pojawiają się w książce (uwaga może być niekompletna)</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="skąd-ściągnąć-r.html"><a href="skąd-ściągnąć-r.html#r-studio"><i class="fa fa-check"></i><b>2.3</b> R Studio</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dane.html"><a href="dane.html"><i class="fa fa-check"></i><b>3</b> Dane</a>
<ul>
<li class="chapter" data-level="3.1" data-path="dane.html"><a href="dane.html#wczytanie-danych"><i class="fa fa-check"></i><b>3.1</b> Wczytanie danych</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="dane.html"><a href="dane.html#wczytanie-danych-z-plików-tekstowych"><i class="fa fa-check"></i><b>3.1.1</b> Wczytanie danych z plików tekstowych</a></li>
<li class="chapter" data-level="3.1.2" data-path="dane.html"><a href="dane.html#wczytanie-danych-z-plików-excel"><i class="fa fa-check"></i><b>3.1.2</b> Wczytanie danych z plików excel</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="dane.html"><a href="dane.html#zapisanie-danych"><i class="fa fa-check"></i><b>3.2</b> Zapisanie danych</a></li>
<li class="chapter" data-level="3.3" data-path="dane.html"><a href="dane.html#podstawowe-typy-danych-w-r"><i class="fa fa-check"></i><b>3.3</b> Podstawowe typy danych w R</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="dane.html"><a href="dane.html#wektor-vector"><i class="fa fa-check"></i><b>3.3.1</b> Wektor (vector)</a></li>
<li class="chapter" data-level="3.3.2" data-path="dane.html"><a href="dane.html#ramka-danych-data-frame"><i class="fa fa-check"></i><b>3.3.2</b> Ramka danych (data frame)</a></li>
<li class="chapter" data-level="3.3.3" data-path="dane.html"><a href="dane.html#matryca-matrix"><i class="fa fa-check"></i><b>3.3.3</b> Matryca (matrix)</a></li>
<li class="chapter" data-level="3.3.4" data-path="dane.html"><a href="dane.html#lista-list"><i class="fa fa-check"></i><b>3.3.4</b> Lista (list)</a></li>
<li class="chapter" data-level="3.3.5" data-path="dane.html"><a href="dane.html#typ-liczbowy-numeric-znakowy-character-logiczny-logical"><i class="fa fa-check"></i><b>3.3.5</b> Typ liczbowy (numeric), znakowy (character), logiczny (logical)</a></li>
<li class="chapter" data-level="3.3.6" data-path="dane.html"><a href="dane.html#typ-czynnikowy-factor"><i class="fa fa-check"></i><b>3.3.6</b> Typ czynnikowy (factor)</a></li>
<li class="chapter" data-level="3.3.7" data-path="dane.html"><a href="dane.html#funkcje"><i class="fa fa-check"></i><b>3.3.7</b> Funkcje</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="analiza-i-transformacja-danych.html"><a href="analiza-i-transformacja-danych.html"><i class="fa fa-check"></i><b>4</b> Analiza i transformacja danych</a>
<ul>
<li class="chapter" data-level="4.1" data-path="analiza-i-transformacja-danych.html"><a href="analiza-i-transformacja-danych.html#format-uporządkowany-wąski"><i class="fa fa-check"></i><b>4.1</b> Format uporządkowany (wąski)</a></li>
<li class="chapter" data-level="4.2" data-path="analiza-i-transformacja-danych.html"><a href="analiza-i-transformacja-danych.html#pipes-potoki"><i class="fa fa-check"></i><b>4.2</b> Pipes (potoki)</a></li>
<li class="chapter" data-level="4.3" data-path="analiza-i-transformacja-danych.html"><a href="analiza-i-transformacja-danych.html#sortowanie"><i class="fa fa-check"></i><b>4.3</b> Sortowanie</a></li>
<li class="chapter" data-level="4.4" data-path="analiza-i-transformacja-danych.html"><a href="analiza-i-transformacja-danych.html#filtrowanie"><i class="fa fa-check"></i><b>4.4</b> Filtrowanie</a></li>
<li class="chapter" data-level="4.5" data-path="analiza-i-transformacja-danych.html"><a href="analiza-i-transformacja-danych.html#grupowanie-i-obliczanie-nowych-zmiennych"><i class="fa fa-check"></i><b>4.5</b> Grupowanie i obliczanie nowych zmiennych</a></li>
<li class="chapter" data-level="4.6" data-path="analiza-i-transformacja-danych.html"><a href="analiza-i-transformacja-danych.html#łączenie-tabel"><i class="fa fa-check"></i><b>4.6</b> Łączenie tabel</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html"><i class="fa fa-check"></i><b>5</b> Wykresy - pakiet ggplot2</a>
<ul>
<li class="chapter" data-level="5.1" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#używane-dane"><i class="fa fa-check"></i><b>5.1</b> Używane dane</a></li>
<li class="chapter" data-level="5.2" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#histogram-boxplot-i-inne"><i class="fa fa-check"></i><b>5.2</b> Histogram, boxplot i inne</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#histogram-i-density"><i class="fa fa-check"></i><b>5.2.1</b> Histogram i density</a></li>
<li class="chapter" data-level="5.2.2" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#wykres-pudełkowy---boxplot"><i class="fa fa-check"></i><b>5.2.2</b> Wykres pudełkowy - boxplot</a></li>
<li class="chapter" data-level="5.2.3" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#wykres-skrzypcowy"><i class="fa fa-check"></i><b>5.2.3</b> Wykres skrzypcowy</a></li>
<li class="chapter" data-level="5.2.4" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#dodanie-wszystkich-obserwacji-do-boxplotviolin"><i class="fa fa-check"></i><b>5.2.4</b> Dodanie wszystkich obserwacji do boxplot/violin</a></li>
<li class="chapter" data-level="5.2.5" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#dotplot"><i class="fa fa-check"></i><b>5.2.5</b> Dotplot</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#barplot---wykres-słupkowy"><i class="fa fa-check"></i><b>5.3</b> Barplot - wykres słupkowy</a></li>
<li class="chapter" data-level="5.4" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#średnia-mediana-itp.-na-wykresie"><i class="fa fa-check"></i><b>5.4</b> Średnia, mediana itp. na wykresie</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#stat_summary"><i class="fa fa-check"></i><b>5.4.1</b> Stat_summary</a></li>
<li class="chapter" data-level="5.4.2" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#summary-z-użyciem-dplyr"><i class="fa fa-check"></i><b>5.4.2</b> Summary z użyciem dplyr</a></li>
<li class="chapter" data-level="5.4.3" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#słupki-błędów"><i class="fa fa-check"></i><b>5.4.3</b> Słupki błędów</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#wykres-punktowy-i-liniowy"><i class="fa fa-check"></i><b>5.5</b> Wykres punktowy i liniowy</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#dopasowanie-linii-trendu-do-wykresu-punktowego"><i class="fa fa-check"></i><b>5.5.1</b> Dopasowanie linii trendu do wykresu punktowego</a></li>
<li class="chapter" data-level="5.5.2" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#jak-poradzić-sobie-z-nadmiarem-punktów-na-wykresie-overplotting"><i class="fa fa-check"></i><b>5.5.2</b> Jak poradzić sobie z nadmiarem punktów na wykresie (overplotting)?</a></li>
<li class="chapter" data-level="5.5.3" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#wykres-wstążka-ribbon"><i class="fa fa-check"></i><b>5.5.3</b> Wykres wstążka (ribbon)</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#kolory-osie-panele"><i class="fa fa-check"></i><b>5.6</b> Kolory, osie, panele</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#porównywanie---fill-color-shape"><i class="fa fa-check"></i><b>5.6.1</b> Porównywanie - fill, color, shape</a></li>
<li class="chapter" data-level="5.6.2" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#zmiana-skali-kolorów"><i class="fa fa-check"></i><b>5.6.2</b> Zmiana skali kolorów</a></li>
<li class="chapter" data-level="5.6.3" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#podział-wykresu-na-panele"><i class="fa fa-check"></i><b>5.6.3</b> Podział wykresu na panele</a></li>
<li class="chapter" data-level="5.6.4" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#zmiana-skali-osi-obracanie-wykresu"><i class="fa fa-check"></i><b>5.6.4</b> Zmiana skali, osi, obracanie wykresu</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#motyw-theme"><i class="fa fa-check"></i><b>5.7</b> Motyw (theme)</a></li>
<li class="chapter" data-level="5.8" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#różne"><i class="fa fa-check"></i><b>5.8</b> Różne</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#łączenie-wykresów"><i class="fa fa-check"></i><b>5.8.1</b> Łączenie wykresów</a></li>
<li class="chapter" data-level="5.8.2" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#ten-sam-wykres-różne-dane"><i class="fa fa-check"></i><b>5.8.2</b> Ten sam wykres różne dane</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#rozszeżenia-ggplot2"><i class="fa fa-check"></i><b>5.9</b> Rozszeżenia ggplot2</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#pakiet-ggally"><i class="fa fa-check"></i><b>5.9.1</b> Pakiet GGally</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="wykresy---pakiet-podstawowy.html"><a href="wykresy---pakiet-podstawowy.html"><i class="fa fa-check"></i><b>6</b> Wykresy - pakiet podstawowy</a>
<ul>
<li class="chapter" data-level="6.1" data-path="wykresy---pakiet-podstawowy.html"><a href="wykresy---pakiet-podstawowy.html#histogram---hist"><i class="fa fa-check"></i><b>6.1</b> Histogram - hist</a></li>
<li class="chapter" data-level="6.2" data-path="wykresy---pakiet-podstawowy.html"><a href="wykresy---pakiet-podstawowy.html#wykres-rozrzutu---plot"><i class="fa fa-check"></i><b>6.2</b> Wykres rozrzutu - plot</a></li>
<li class="chapter" data-level="6.3" data-path="wykresy---pakiet-podstawowy.html"><a href="wykresy---pakiet-podstawowy.html#wykres-pudełkowy---boxplot-1"><i class="fa fa-check"></i><b>6.3</b> Wykres pudełkowy - boxplot</a></li>
<li class="chapter" data-level="6.4" data-path="wykresy---pakiet-podstawowy.html"><a href="wykresy---pakiet-podstawowy.html#wykres-słupkowy---barplot"><i class="fa fa-check"></i><b>6.4</b> Wykres słupkowy - barplot</a></li>
<li class="chapter" data-level="6.5" data-path="wykresy---pakiet-podstawowy.html"><a href="wykresy---pakiet-podstawowy.html#wykres-mozaikowy---mosaicplot"><i class="fa fa-check"></i><b>6.5</b> Wykres mozaikowy - mosaicplot</a></li>
<li class="chapter" data-level="6.6" data-path="wykresy---pakiet-podstawowy.html"><a href="wykresy---pakiet-podstawowy.html#wykres-kwantylowy---qqplot"><i class="fa fa-check"></i><b>6.6</b> Wykres kwantylowy - qqPlot</a></li>
<li class="chapter" data-level="6.7" data-path="wykresy---pakiet-podstawowy.html"><a href="wykresy---pakiet-podstawowy.html#diagram-venna"><i class="fa fa-check"></i><b>6.7</b> Diagram venna</a></li>
<li class="chapter" data-level="6.8" data-path="wykresy---pakiet-podstawowy.html"><a href="wykresy---pakiet-podstawowy.html#wykres-korelacji---corrplot"><i class="fa fa-check"></i><b>6.8</b> Wykres korelacji - corrplot</a></li>
<li class="chapter" data-level="6.9" data-path="wykresy---pakiet-podstawowy.html"><a href="wykresy---pakiet-podstawowy.html#clustering---analiza-skupień"><i class="fa fa-check"></i><b>6.9</b> Clustering - analiza skupień</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="statystyka.html"><a href="statystyka.html"><i class="fa fa-check"></i><b>7</b> Statystyka</a>
<ul>
<li class="chapter" data-level="7.1" data-path="statystyka.html"><a href="statystyka.html#podstawowe-statystyki-opisowe"><i class="fa fa-check"></i><b>7.1</b> Podstawowe statystyki opisowe</a></li>
<li class="chapter" data-level="7.2" data-path="statystyka.html"><a href="statystyka.html#liczby-pseudolosowe"><i class="fa fa-check"></i><b>7.2</b> Liczby pseudolosowe</a></li>
<li class="chapter" data-level="7.3" data-path="statystyka.html"><a href="statystyka.html#podstawowe-testy-statystyczne"><i class="fa fa-check"></i><b>7.3</b> Podstawowe testy statystyczne</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="statystyka.html"><a href="statystyka.html#test-t-studenta---weryfikacja-równości-średnich"><i class="fa fa-check"></i><b>7.3.1</b> Test t-studenta - weryfikacja równości średnich</a></li>
<li class="chapter" data-level="7.3.2" data-path="statystyka.html"><a href="statystyka.html#test-f---weryfikacja-równości-wariancji"><i class="fa fa-check"></i><b>7.3.2</b> Test F - weryfikacja równości wariancji</a></li>
<li class="chapter" data-level="7.3.3" data-path="statystyka.html"><a href="statystyka.html#testowanie-zgodności-z-rozkładem-normalnym-i-dopasowywanie-parametrów-rozkładu"><i class="fa fa-check"></i><b>7.3.3</b> Testowanie zgodności z rozkładem normalnym i dopasowywanie parametrów rozkładu</a></li>
<li class="chapter" data-level="7.3.4" data-path="statystyka.html"><a href="statystyka.html#obliczanie-przedziałów-ufności-dla-średniej-i-błędu-standardowego"><i class="fa fa-check"></i><b>7.3.4</b> Obliczanie przedziałów ufności dla średniej i błędu standardowego</a></li>
<li class="chapter" data-level="7.3.5" data-path="statystyka.html"><a href="statystyka.html#testowanie-korelacji"><i class="fa fa-check"></i><b>7.3.5</b> Testowanie korelacji</a></li>
<li class="chapter" data-level="7.3.6" data-path="statystyka.html"><a href="statystyka.html#test-chi-kwadrat---zgodność-rozkładu-zmiennych-jakościowych"><i class="fa fa-check"></i><b>7.3.6</b> Test chi-kwadrat - zgodność rozkładu zmiennych jakościowych</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="statystyka.html"><a href="statystyka.html#modelowanie---czyli-jak-dopasować-linię-trendu"><i class="fa fa-check"></i><b>7.4</b> Modelowanie - czyli jak dopasować linię trendu</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="statystyka.html"><a href="statystyka.html#regresja-liniowa"><i class="fa fa-check"></i><b>7.4.1</b> Regresja liniowa</a></li>
<li class="chapter" data-level="7.4.2" data-path="statystyka.html"><a href="statystyka.html#zmienne-jakościowe-w-modelu"><i class="fa fa-check"></i><b>7.4.2</b> Zmienne jakościowe w modelu</a></li>
<li class="chapter" data-level="7.4.3" data-path="statystyka.html"><a href="statystyka.html#pakiet-drc---dose-response-models"><i class="fa fa-check"></i><b>7.4.3</b> Pakiet drc - dose response models</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="statystyka.html"><a href="statystyka.html#analiza-anova"><i class="fa fa-check"></i><b>7.5</b> Analiza ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="miscellaneous.html"><a href="miscellaneous.html"><i class="fa fa-check"></i><b>8</b> Miscellaneous</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Kurs R - Tutorial</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="wykresy---pakiet-ggplot2" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Wykresy - pakiet ggplot2</h1>
<pre><code>## 
## If anything, there should be a Law: Thou Shalt Not Even Think Of Producing A
## Graph That Looks Like Anything From A Spreadsheet.
##    -- Ted Harding (in a discussion about producing graphics)
##       R-help (August 2007)</code></pre>
<p>Do tworzenia wykresów można użyć kilku pakietów:</p>
<ul>
<li><p><strong>graphics</strong> - podstawowy pakiet graficzny instalowany razem z R, pełna kontrola nad wyglądem wykresu, ale często wymaga to więcej pracy niż w innych pakietach. Przydatny jeżeli chcemy coś szybko sprawdzić, a nie interesuje nas wygląd wykresu, niektóre wykresy można stworzyć tylko w tym pakiecie</p></li>
<li><p><strong>lattice</strong> - umożliwia łatwe tworzenie kilku wykresów na raz np. do porównania różnych cech, ale obecnie mniej popularny niż np. ggplot2</p></li>
<li><p><strong>ggplot2</strong> - jeden z najpopularniejszych pakietów R i mój ulubiony do przygotowywania wykresów. Oparty na grammar of graphics. Przygotowanie “ładnych” wykresów wymaga mniej pracy niż w podstawowym, ale składnia jest znacząco różna. Łatwe porównywanie i tworzenie kilku wykresów na jednym obrazku</p></li>
<li><p><strong>plotly</strong> - pozwala na tworzenie interaktywnych wykresów np. do wykorzystania na stronach www lub w shiny. Pakiet ggplotly umożliwia konwersję wykresów ggplot do postaci interaktywnej</p></li>
</ul>
<p><strong>Wykresy w ggplot2 składają się z kilku elementów: data, aesthetics, geom, scale, facet, theme itd.</strong></p>
<p>Pierwsze trzy są niezbędne do przygotowania wykresu.</p>
<p>Poszczególne elementy można ze sobą łączyć na różne sposoby, co pozwala w prosty sposób robić bardzo różne wykresy.</p>
<p>Podstawowa funkcja : <code>ggplot()</code>. W niej określany jest tylko data i aesthetic, pozostałe elementy dodawane są przy pomocy <code>+</code></p>
<ul>
<li><p>data - określa ramkę danych, na podstawie której będzie przygotowany wykres, najlepiej żeby była w formacie ‘tidy’</p></li>
<li><p>aesthetics (aes) - pokazuje (mapuje), które kolumny mają być wykorzystane np. x=kolumna_1 dla histogramu, można też określać pod względem których zmiennych dane mają zostać pogrupowane (group), rozróżnione (color, fill, shape itp) np. aes(x = kolumna_1, color = kolumna_2) znaczy że dane z kolumny_1 zostaną wykorzystane do stowrzenia osi X, a dane z kolumny_2 posłużą do stowrzenia skali kolorów.</p></li>
<li><p>geom - rodzaj wykresu - to co widzimy - np histogram, density, bar, boxplot, point, line itp., można użyć kilka jednocześnie np. point i line, histogram i density</p></li>
<li><p>scale - osie wykresu np. czy mają być logarytmiczne, procentowe, miejsce start i koniec, ale też skale kolorów, wypełnienia, kształtów itp.</p></li>
<li><p>facet - umożliwia podział wykresu na kilka mniejszych pod względem danej zmiennej</p></li>
<li><p>theme - wygląd poszczególnych elementów wykresu (motyw) np. czcionki, rodzaj linii, kolor tła, legenda itp., istnieje sporo już przygotowanych. Można przygotować własny i zapisać - łatwo można zrobić kilka wykresów w jednym stylu</p></li>
</ul>
<p>Istnieje również funkcja <code>qplot</code>, która jest podobna do funkcji plot w podstawowym R, ale jej możliwości są uboższe w porównaniu z <code>ggplot</code>.</p>
<p>Wykresy ggplot są przypisywane do zmiennych np <code>p &lt;- ggplot(...)</code>, zmienna p przechowuje wszystkie dane dotyczące wykresu. Możemy je sprawdzić funkcją <code>summary</code>. Dodanie kolejnych elementów do wykresu np. <code>p + geom_point()</code>, jeżeli chcemy nadpisać dotychczasowy wykres - <code>p &lt;- p + geom_point()</code>. Korzystając z <code>+</code> możemy dodawać tyle elementów ile chcemy.</p>
<div id="używane-dane" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Używane dane</h2>
<p>Dane 1 opisują jakąś cechę zmierzoną dla trzech szczepów w dwóch rodzajach warunków.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="wykresy---pakiet-ggplot2.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="co"># ładujemy niezbędne pakiety</span></span>
<span id="cb146-2"><a href="wykresy---pakiet-ggplot2.html#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb146-3"><a href="wykresy---pakiet-ggplot2.html#cb146-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-4"><a href="wykresy---pakiet-ggplot2.html#cb146-4" aria-hidden="true" tabindex="-1"></a>dane1 <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;data/dane1.txt&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">quote =</span> <span class="st">&quot;</span><span class="sc">\&quot;</span><span class="st">&quot;</span>)</span>
<span id="cb146-5"><a href="wykresy---pakiet-ggplot2.html#cb146-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-6"><a href="wykresy---pakiet-ggplot2.html#cb146-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dane1)</span></code></pre></div>
<pre><code>##     pomiar Szczep warunki
## 1 3.389738      A       1
## 2 5.992065      A       1
## 3 4.464553      A       1
## 4 4.546082      A       1
## 5 6.521751      A       1
## 6 5.713088      A       1</code></pre>
<p>Dane 2 zawierają ten sam zestaw szczepów i warunków, ale tym razem zostały one podzielone na 4 grupy: tak, nie, może i NA (brak danych).</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="wykresy---pakiet-ggplot2.html#cb148-1" aria-hidden="true" tabindex="-1"></a>dane2 <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;data/dane2.txt&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">quote =</span> <span class="st">&quot;</span><span class="sc">\&quot;</span><span class="st">&quot;</span>)</span>
<span id="cb148-2"><a href="wykresy---pakiet-ggplot2.html#cb148-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-3"><a href="wykresy---pakiet-ggplot2.html#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dane2)</span></code></pre></div>
<pre><code>##   pomiar Szczep warunki
## 1    Tak      A       1
## 2    Nie      A       1
## 3    Tak      A       1
## 4    Tak      A       1
## 5   &lt;NA&gt;      A       1
## 6    Tak      A       1</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="wykresy---pakiet-ggplot2.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dane2)</span></code></pre></div>
<pre><code>##     pomiar             Szczep             warunki   
##  Length:1200        Length:1200        Min.   :1.0  
##  Class :character   Class :character   1st Qu.:1.0  
##  Mode  :character   Mode  :character   Median :1.5  
##                                        Mean   :1.5  
##                                        3rd Qu.:2.0  
##                                        Max.   :2.0</code></pre>
<p>Dane 3 to wzrost dwóch szczepów w trzech powtórzeniach w czasie 1-100.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="wykresy---pakiet-ggplot2.html#cb152-1" aria-hidden="true" tabindex="-1"></a>dane3 <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;data/dane3.txt&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">quote =</span> <span class="st">&quot;</span><span class="sc">\&quot;</span><span class="st">&quot;</span>)</span>
<span id="cb152-2"><a href="wykresy---pakiet-ggplot2.html#cb152-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-3"><a href="wykresy---pakiet-ggplot2.html#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dane3)</span></code></pre></div>
<pre><code>##       pomiar Szczep powt czas
## 1 0.09639497      A    1    1
## 2 0.11830818      A    1    2
## 3 0.11839652      A    1    3
## 4 0.13904646      A    1    4
## 5 0.15544315      A    1    5
## 6 0.13080412      A    1    6</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="wykresy---pakiet-ggplot2.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dane3)</span></code></pre></div>
<pre><code>##      pomiar           Szczep               powt        czas       
##  Min.   :0.09175   Length:1200        Min.   :1   Min.   :  1.00  
##  1st Qu.:0.33428   Class :character   1st Qu.:1   1st Qu.: 25.75  
##  Median :0.52688   Mode  :character   Median :2   Median : 50.50  
##  Mean   :0.54175                      Mean   :2   Mean   : 50.50  
##  3rd Qu.:0.74753                      3rd Qu.:3   3rd Qu.: 75.25  
##  Max.   :1.10474                      Max.   :3   Max.   :100.00</code></pre>
<p>Dane tego typu możemy przedstawić jako wykres np. liniowy, punktowy, ribbon (liniowy z zaznaczonym błędem, przedziałem ufności itp.).</p>
</div>
<div id="histogram-boxplot-i-inne" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Histogram, boxplot i inne</h2>
<div id="histogram-i-density" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Histogram i density</h3>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="wykresy---pakiet-ggplot2.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>()) <span class="co"># żeby wszystkie wykresy miały białe tło, a nie szare - będzie o tym później</span></span>
<span id="cb156-2"><a href="wykresy---pakiet-ggplot2.html#cb156-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-3"><a href="wykresy---pakiet-ggplot2.html#cb156-3" aria-hidden="true" tabindex="-1"></a>dane1_1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(dane1, Szczep <span class="sc">==</span> <span class="st">&quot;A&quot;</span> <span class="sc">&amp;</span> warunki <span class="sc">==</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb156-4"><a href="wykresy---pakiet-ggplot2.html#cb156-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-5"><a href="wykresy---pakiet-ggplot2.html#cb156-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dane1_1, <span class="fu">aes</span>(<span class="at">x =</span> pomiar))</span>
<span id="cb156-6"><a href="wykresy---pakiet-ggplot2.html#cb156-6" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>Dla histogramu najważniejszy parametr to <code>binwidth</code> określający szerokość “słupków.”</p>
<p>Możemy też wybrać czy chcemy żeby były zliczane ilości elementów (domyślnie), czy ma być pokazana gęstość rozkładu - w <code>aes</code> należy wpisać <code>y=..density..</code> albo procenty <code>y=((..count..)/sum(..count..))*100</code> (w przypadku procentów lepiej jednak policzyć je wcześniej i podać już gotowe wartości do ggplot, w bardziej skomplikowanych przypadkach ggplot może sobie nie poradzić). Do dodania znaków % potrzebna jest zmiana parametrów osi, o tym później.</p>
<p>Można też zmienić kolor wypełnienia słupków - <code>fill</code> lub kolor linii - color.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="wykresy---pakiet-ggplot2.html#cb158-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="wykresy---pakiet-ggplot2.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram z gęstością na osi Y</span></span>
<span id="cb159-2"><a href="wykresy---pakiet-ggplot2.html#cb159-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> ..density..))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-33-2.png" width="672" /></p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="wykresy---pakiet-ggplot2.html#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram z wartością % na osi Y</span></span>
<span id="cb160-2"><a href="wykresy---pakiet-ggplot2.html#cb160-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> ((..count..)<span class="sc">/</span><span class="fu">sum</span>(..count..)<span class="sc">*</span><span class="dv">100</span>)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-33-3.png" width="672" /></p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="wykresy---pakiet-ggplot2.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Zmiana koloru wypełnienia histogramu</span></span>
<span id="cb161-2"><a href="wykresy---pakiet-ggplot2.html#cb161-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> ..density..), </span>
<span id="cb161-3"><a href="wykresy---pakiet-ggplot2.html#cb161-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="st">&quot;lightgreen&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-33-4.png" width="672" /></p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="wykresy---pakiet-ggplot2.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dodanie wszystkich obserwacji do wykresu - geom_rug()</span></span>
<span id="cb162-2"><a href="wykresy---pakiet-ggplot2.html#cb162-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> ..density..), </span>
<span id="cb162-3"><a href="wykresy---pakiet-ggplot2.html#cb162-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="st">&quot;lightgreen&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb162-4"><a href="wykresy---pakiet-ggplot2.html#cb162-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-33-5.png" width="672" /></p>
<p>Histogram możemy łatwo zmienić na <code>geom_density</code> (gęstość) albo połączyć oba na jednym wykresie (należy pamiętać żeby ujednolicić oś Y - w histogramie ustawić <code>y=..density..</code> albo w density <code>y = ..count..</code>)</p>
<p>Wykresy gęstości są dużo czytelniejsze od histogramów przy większej liczbie grup/kolorów na wykresie.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="wykresy---pakiet-ggplot2.html#cb163-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="wykresy---pakiet-ggplot2.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres łączący histogram i gęstość</span></span>
<span id="cb164-2"><a href="wykresy---pakiet-ggplot2.html#cb164-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> ..density..))<span class="sc">+</span></span>
<span id="cb164-3"><a href="wykresy---pakiet-ggplot2.html#cb164-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-34-2.png" width="672" /></p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="wykresy---pakiet-ggplot2.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># albo tak, ale wtedy trzeba count w density podzielić przez coś - konkretną liczbę lepiej dobrać indywidualnie do każdego wykresu</span></span>
<span id="cb165-2"><a href="wykresy---pakiet-ggplot2.html#cb165-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb165-3"><a href="wykresy---pakiet-ggplot2.html#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="fu">aes</span>(<span class="at">y =</span> ..count..<span class="sc">/</span><span class="dv">2</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-34-3.png" width="672" /></p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="wykresy---pakiet-ggplot2.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Zamiast density można też użyć geom_freqpoly, który da bardziej &quot;kanciasty&quot; wykres</span></span>
<span id="cb166-2"><a href="wykresy---pakiet-ggplot2.html#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Wymaga parametru binwidth tak samo jak histogram</span></span>
<span id="cb166-3"><a href="wykresy---pakiet-ggplot2.html#cb166-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_freqpoly</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-34-4.png" width="672" /></p>
</div>
<div id="wykres-pudełkowy---boxplot" class="section level3" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Wykres pudełkowy - boxplot</h3>
<p>Na wykresie pudełkowym linia obrazuje medianę, pudełko to przestrzeń między 1 i 3 kwantylem, wąsy to zakres danych, a wszystkie punkty to obserwacje odstające.</p>
<p>Zamiast histogramu możemy zrobić boxplot, w tym wypadku x to nazwa szczepu, a y to mierzona cecha. Na osi X należy zawsze umieszczać zmienną jakościową, a na osi Y zmienną ilościową</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="wykresy---pakiet-ggplot2.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pojedynczy boxplot</span></span>
<span id="cb167-2"><a href="wykresy---pakiet-ggplot2.html#cb167-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dane1_1, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">&quot;Szczep A&quot;</span>, <span class="at">y =</span> pomiar))</span>
<span id="cb167-3"><a href="wykresy---pakiet-ggplot2.html#cb167-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="wykresy---pakiet-ggplot2.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># boxplot dla każdej kategorii</span></span>
<span id="cb168-2"><a href="wykresy---pakiet-ggplot2.html#cb168-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dane1, <span class="fu">aes</span>(<span class="at">x =</span> Szczep, <span class="at">y =</span> pomiar))</span>
<span id="cb168-3"><a href="wykresy---pakiet-ggplot2.html#cb168-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-35-2.png" width="672" /></p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="wykresy---pakiet-ggplot2.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># do boxplota można dodać wcięcia, jeżeli wcięcia dwóch boxplotów na siebie nie zachodzą </span></span>
<span id="cb169-2"><a href="wykresy---pakiet-ggplot2.html#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="co"># można uznać że mediany tych dwóch grup są od siebie znacząco różne</span></span>
<span id="cb169-3"><a href="wykresy---pakiet-ggplot2.html#cb169-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="at">notch =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-35-3.png" width="672" /></p>
</div>
<div id="wykres-skrzypcowy" class="section level3" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Wykres skrzypcowy</h3>
<p>Odmianą boxplotów są tzw. wykresy skrzypcowe, które pozwalają też na pokazanie kształtu rozkładu - pozwala to np. na wykrycie rozkładu, który ma dwa maksima. W ggplot2 można je wygenerować funkcją <code>geom_violin</code>.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="wykresy---pakiet-ggplot2.html#cb170-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>dane1, <span class="fu">aes</span>(<span class="at">x =</span> Szczep, <span class="at">y =</span> pomiar))</span>
<span id="cb170-2"><a href="wykresy---pakiet-ggplot2.html#cb170-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(warunki)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="wykresy---pakiet-ggplot2.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># przykładowe dane</span></span>
<span id="cb171-2"><a href="wykresy---pakiet-ggplot2.html#cb171-2" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">3</span>), <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">1</span>), <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">5</span>)), </span>
<span id="cb171-3"><a href="wykresy---pakiet-ggplot2.html#cb171-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">faktor =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="at">each =</span> <span class="dv">200</span>))</span>
<span id="cb171-4"><a href="wykresy---pakiet-ggplot2.html#cb171-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-5"><a href="wykresy---pakiet-ggplot2.html#cb171-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dane, <span class="fu">aes</span>(<span class="at">y =</span> x, <span class="at">x =</span> faktor, <span class="at">fill =</span> faktor))</span>
<span id="cb171-6"><a href="wykresy---pakiet-ggplot2.html#cb171-6" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_violin</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-36-2.png" width="672" /></p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="wykresy---pakiet-ggplot2.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nie przyciety wykres</span></span>
<span id="cb172-2"><a href="wykresy---pakiet-ggplot2.html#cb172-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_violin</span>(<span class="at">trim=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-36-3.png" width="672" /></p>
</div>
<div id="dodanie-wszystkich-obserwacji-do-boxplotviolin" class="section level3" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> Dodanie wszystkich obserwacji do boxplot/violin</h3>
<p>Dobrą praktyką jest przy używaniu wykresów pudełkowych lub skrzypcowych pokazanie wszystkich uzyskanych obserwacji (o ile nie ma ich za dużo). Można w tym celu użyć funkcji <code>geom_jitter</code> albo ładniejszych <code>geom_beeswarm</code> i <code>geom_quasirandom</code> z pakietu ggbeeswarm.</p>
<p>Przy pomocy argumentu alpha można kontrolować przezroczystość punktów - przydatne gdy jest ich dużo.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="wykresy---pakiet-ggplot2.html#cb173-1" aria-hidden="true" tabindex="-1"></a>dane1_2 <span class="ot">&lt;-</span> dane1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(warunki <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb173-2"><a href="wykresy---pakiet-ggplot2.html#cb173-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-3"><a href="wykresy---pakiet-ggplot2.html#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot dla każdego szczepu</span></span>
<span id="cb173-4"><a href="wykresy---pakiet-ggplot2.html#cb173-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dane1_2, <span class="fu">aes</span>(<span class="at">x =</span> Szczep, <span class="at">y =</span> pomiar))</span>
<span id="cb173-5"><a href="wykresy---pakiet-ggplot2.html#cb173-5" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> Szczep))<span class="sc">+</span></span>
<span id="cb173-6"><a href="wykresy---pakiet-ggplot2.html#cb173-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> Szczep), <span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="wykresy---pakiet-ggplot2.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># usuwamy punkty pochodzące od boxplota</span></span>
<span id="cb174-2"><a href="wykresy---pakiet-ggplot2.html#cb174-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> Szczep), <span class="at">outlier.alpha =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb174-3"><a href="wykresy---pakiet-ggplot2.html#cb174-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> Szczep), <span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-37-2.png" width="672" /></p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="wykresy---pakiet-ggplot2.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># beeswarm</span></span>
<span id="cb175-2"><a href="wykresy---pakiet-ggplot2.html#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbeeswarm)</span>
<span id="cb175-3"><a href="wykresy---pakiet-ggplot2.html#cb175-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-4"><a href="wykresy---pakiet-ggplot2.html#cb175-4" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> Szczep), <span class="at">outlier.alpha =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb175-5"><a href="wykresy---pakiet-ggplot2.html#cb175-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>(<span class="fu">aes</span>(<span class="at">color =</span> Szczep), <span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-37-3.png" width="672" /></p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="wykresy---pakiet-ggplot2.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quasirandom</span></span>
<span id="cb176-2"><a href="wykresy---pakiet-ggplot2.html#cb176-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> Szczep), <span class="at">outlier.alpha =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb176-3"><a href="wykresy---pakiet-ggplot2.html#cb176-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="fu">aes</span>(<span class="at">color =</span> Szczep), <span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-37-4.png" width="672" /></p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="wykresy---pakiet-ggplot2.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quasirandom + geom_violin</span></span>
<span id="cb177-2"><a href="wykresy---pakiet-ggplot2.html#cb177-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>dane1, <span class="fu">aes</span>(<span class="at">x =</span> Szczep, <span class="at">y =</span> pomiar))</span>
<span id="cb177-3"><a href="wykresy---pakiet-ggplot2.html#cb177-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(warunki)))<span class="sc">+</span></span>
<span id="cb177-4"><a href="wykresy---pakiet-ggplot2.html#cb177-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(warunki)), </span>
<span id="cb177-5"><a href="wykresy---pakiet-ggplot2.html#cb177-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dodge.width =</span> <span class="fl">0.9</span>, <span class="co"># pozwala na rodział kolorów na dwie grupy</span></span>
<span id="cb177-6"><a href="wykresy---pakiet-ggplot2.html#cb177-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">alpha =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-37-5.png" width="672" /></p>
<p>Można też połączyć wszystko w całość korzystając z dodatkowych pakietów ggdist i gghalves, na podstawie strony: <a href="https://www.cedricscherer.com/2021/06/06/visualizing-distributions-with-raincloud-plots-with-ggplot2/">visualizing-distributions-with-raincloud-plots-with-ggplot2</a></p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="wykresy---pakiet-ggplot2.html#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane1_2, <span class="fu">aes</span>(<span class="at">x =</span> Szczep, <span class="at">y =</span> pomiar, <span class="at">color =</span> Szczep, <span class="at">fill =</span> Szczep)) <span class="sc">+</span> </span>
<span id="cb178-2"><a href="wykresy---pakiet-ggplot2.html#cb178-2" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb178-3"><a href="wykresy---pakiet-ggplot2.html#cb178-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> .<span class="dv">5</span>, </span>
<span id="cb178-4"><a href="wykresy---pakiet-ggplot2.html#cb178-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">6</span>, </span>
<span id="cb178-5"><a href="wykresy---pakiet-ggplot2.html#cb178-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="dv">0</span>, </span>
<span id="cb178-6"><a href="wykresy---pakiet-ggplot2.html#cb178-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">2</span>, </span>
<span id="cb178-7"><a href="wykresy---pakiet-ggplot2.html#cb178-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb178-8"><a href="wykresy---pakiet-ggplot2.html#cb178-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb178-9"><a href="wykresy---pakiet-ggplot2.html#cb178-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb178-10"><a href="wykresy---pakiet-ggplot2.html#cb178-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>, </span>
<span id="cb178-11"><a href="wykresy---pakiet-ggplot2.html#cb178-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span>,</span>
<span id="cb178-12"><a href="wykresy---pakiet-ggplot2.html#cb178-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span></span>
<span id="cb178-13"><a href="wykresy---pakiet-ggplot2.html#cb178-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb178-14"><a href="wykresy---pakiet-ggplot2.html#cb178-14" aria-hidden="true" tabindex="-1"></a>  <span class="do">## add justified jitter from the {gghalves} package</span></span>
<span id="cb178-15"><a href="wykresy---pakiet-ggplot2.html#cb178-15" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb178-16"><a href="wykresy---pakiet-ggplot2.html#cb178-16" aria-hidden="true" tabindex="-1"></a>    <span class="do">## draw jitter on the left</span></span>
<span id="cb178-17"><a href="wykresy---pakiet-ggplot2.html#cb178-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">side =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb178-18"><a href="wykresy---pakiet-ggplot2.html#cb178-18" aria-hidden="true" tabindex="-1"></a>    <span class="do">## control range of jitter</span></span>
<span id="cb178-19"><a href="wykresy---pakiet-ggplot2.html#cb178-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">range_scale =</span> .<span class="dv">4</span>, </span>
<span id="cb178-20"><a href="wykresy---pakiet-ggplot2.html#cb178-20" aria-hidden="true" tabindex="-1"></a>    <span class="do">## add some transparency</span></span>
<span id="cb178-21"><a href="wykresy---pakiet-ggplot2.html#cb178-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">3</span></span>
<span id="cb178-22"><a href="wykresy---pakiet-ggplot2.html#cb178-22" aria-hidden="true" tabindex="-1"></a>  ) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
</div>
<div id="dotplot" class="section level3" number="5.2.5">
<h3><span class="header-section-number">5.2.5</span> Dotplot</h3>
<p>Wykres, na którym obserwacje są zaznaczane jako punkty, może być alternatywą dla histogramu albo gęstości jeżeli mamy małą liczbę danych. Punkty mogą być układane na którejś z osi albo wyśrodkowane. Podobnie jak w histogramie możemy określić parametrem <code>binwidth</code> jak mają być ułożone punkty.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="wykresy---pakiet-ggplot2.html#cb179-1" aria-hidden="true" tabindex="-1"></a>dane_dot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">pomiar =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>), <span class="fu">rlnorm</span>(<span class="dv">20</span>), <span class="fu">runif</span>(<span class="dv">20</span>)), </span>
<span id="cb179-2"><a href="wykresy---pakiet-ggplot2.html#cb179-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">kategoria =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>), <span class="at">each =</span> <span class="dv">20</span>))</span>
<span id="cb179-3"><a href="wykresy---pakiet-ggplot2.html#cb179-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-4"><a href="wykresy---pakiet-ggplot2.html#cb179-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dane_dot)</span>
<span id="cb179-5"><a href="wykresy---pakiet-ggplot2.html#cb179-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-6"><a href="wykresy---pakiet-ggplot2.html#cb179-6" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_dotplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pomiar))</span></code></pre></div>
<pre><code>## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="wykresy---pakiet-ggplot2.html#cb181-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_dotplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pomiar), <span class="at">binwidth =</span> <span class="fl">0.25</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-39-2.png" width="672" /></p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="wykresy---pakiet-ggplot2.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># możemy kropki pokolorować według kategorii, </span></span>
<span id="cb182-2"><a href="wykresy---pakiet-ggplot2.html#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="co"># konieczne parametry stackgroups=TRUE i binpositions=&quot;all&quot;</span></span>
<span id="cb182-3"><a href="wykresy---pakiet-ggplot2.html#cb182-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-4"><a href="wykresy---pakiet-ggplot2.html#cb182-4" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_dotplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pomiar, <span class="at">fill =</span> kategoria), <span class="at">binpositions =</span> <span class="st">&quot;all&quot;</span>, <span class="at">stackgroups =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-39-3.png" width="672" /></p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="wykresy---pakiet-ggplot2.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># albo przedstawić każdą kategorię osobno, binaxis określa w jakim kierunku układać kropki,</span></span>
<span id="cb184-2"><a href="wykresy---pakiet-ggplot2.html#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="co"># stackdir czy mają być wyśrodkowane - center lub centerwhole</span></span>
<span id="cb184-3"><a href="wykresy---pakiet-ggplot2.html#cb184-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-4"><a href="wykresy---pakiet-ggplot2.html#cb184-4" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_dotplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> pomiar, <span class="at">x =</span> kategoria), <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">binwidth =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-39-4.png" width="672" /></p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="wykresy---pakiet-ggplot2.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># zmiana wielkości kropki przez dotsize</span></span>
<span id="cb185-2"><a href="wykresy---pakiet-ggplot2.html#cb185-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-3"><a href="wykresy---pakiet-ggplot2.html#cb185-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_dotplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> pomiar, <span class="at">x =</span> kategoria), <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, </span>
<span id="cb185-4"><a href="wykresy---pakiet-ggplot2.html#cb185-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="fl">0.2</span>, <span class="at">dotsize =</span> <span class="fl">0.75</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-39-5.png" width="672" /></p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="wykresy---pakiet-ggplot2.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># można też wybrać metodę układania kropek, domyślnie wedle gęstości, </span></span>
<span id="cb186-2"><a href="wykresy---pakiet-ggplot2.html#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="co"># podobnie jak histogram - method=&quot;histodot&quot;</span></span>
<span id="cb186-3"><a href="wykresy---pakiet-ggplot2.html#cb186-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-4"><a href="wykresy---pakiet-ggplot2.html#cb186-4" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_dotplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> pomiar, <span class="at">x =</span> kategoria), <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, </span>
<span id="cb186-5"><a href="wykresy---pakiet-ggplot2.html#cb186-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="fl">0.2</span>, <span class="at">dotsize =</span> <span class="fl">0.75</span>, <span class="at">method =</span> <span class="st">&quot;histodot&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-39-6.png" width="672" /></p>
</div>
</div>
<div id="barplot---wykres-słupkowy" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Barplot - wykres słupkowy</h2>
<p>Szybkie zliczenie elementów w poszczególnych grupach możemy wykonać stosując funkcję <code>table</code>. Wystarczy podać jej kolumnę z danymi oraz kolumny zawierające wektory według których dane mają zostać podzielone na grupy. Wynikiem <code>table</code> nie jest ramka danych, więc bez przekształcenia nie można go użyć do przygotowania wykresu ggplot.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="wykresy---pakiet-ggplot2.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dane2<span class="sc">$</span>pomiar)</span></code></pre></div>
<pre><code>## 
## Może  Nie  Tak 
##  224  469  437</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="wykresy---pakiet-ggplot2.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dane2<span class="sc">$</span>pomiar, dane2<span class="sc">$</span>Szczep, dane2<span class="sc">$</span>warunki)</span></code></pre></div>
<pre><code>## , ,  = 1
## 
##       
##          A   B   C
##   Może  19  25  38
##   Nie   68  94 123
##   Tak   94  71  21
## 
## , ,  = 2
## 
##       
##          A   B   C
##   Może  51  23  68
##   Nie   15  67 102
##   Tak  134  93  24</code></pre>
<p>Można zauważyć, że funkcja <code>table</code>, w przeciwieństwie do <code>summary</code> pominęła wartości oznaczone jako NA. Można to zmienić używając parametr <code>useNA</code>.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="wykresy---pakiet-ggplot2.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dane2<span class="sc">$</span>pomiar, dane2<span class="sc">$</span>Szczep, dane2<span class="sc">$</span>warunki, <span class="at">useNA =</span> <span class="st">&quot;ifany&quot;</span>)</span></code></pre></div>
<pre><code>## , ,  = 1
## 
##       
##          A   B   C
##   Może  19  25  38
##   Nie   68  94 123
##   Tak   94  71  21
##   &lt;NA&gt;  19  10  18
## 
## , ,  = 2
## 
##       
##          A   B   C
##   Może  51  23  68
##   Nie   15  67 102
##   Tak  134  93  24
##   &lt;NA&gt;   0  17   6</code></pre>
<p>Wykres słupkowy wymaga użycia <code>geom_bar</code>. Zasady rozróżniania zmiennych według kolorów i dzielenia wykresów na części pozostają takie same.</p>
<p>Domyślnie również wartości NA zostaną wzięte pod uwagę podczas zliczania. Jeżeli chcemy temu zapobiec, należałoby np. usunąć je wcześniej przy pomocy funkcji <code>filter</code>.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="wykresy---pakiet-ggplot2.html#cb193-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dane2, <span class="fu">aes</span>(<span class="at">x =</span> pomiar, <span class="at">fill =</span> Szczep))</span>
<span id="cb193-2"><a href="wykresy---pakiet-ggplot2.html#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Słupki ustawione obok siebie</span></span>
<span id="cb193-3"><a href="wykresy---pakiet-ggplot2.html#cb193-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span> warunki)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="wykresy---pakiet-ggplot2.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wszystkie słupki tej samej wysokości</span></span>
<span id="cb194-2"><a href="wykresy---pakiet-ggplot2.html#cb194-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;fill&quot;</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span> warunki)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-42-2.png" width="672" /></p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="wykresy---pakiet-ggplot2.html#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Szerokość słupków można zmieniać parametrem width</span></span>
<span id="cb195-2"><a href="wykresy---pakiet-ggplot2.html#cb195-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>, <span class="at">width =</span> <span class="fl">0.4</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span> warunki)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-42-3.png" width="672" /></p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="wykresy---pakiet-ggplot2.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres bez wartości NA, filter można zrobić też wcześniej albo w obrębie ggplot</span></span>
<span id="cb196-2"><a href="wykresy---pakiet-ggplot2.html#cb196-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dane2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(pomiar)), <span class="fu">aes</span>(<span class="at">x =</span> pomiar, <span class="at">fill =</span> Szczep))</span>
<span id="cb196-3"><a href="wykresy---pakiet-ggplot2.html#cb196-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span> warunki)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-42-4.png" width="672" /></p>
<p>Przy dużej ilości różnokolorowych słupków wykres może być trudny do odczytania. Można wtedy rozważyć zastosowanie dotchart - czyli wykresu na którym wartości zliczenia są oznaczane przez pojedyncze punkty, a nie przez wysokość słupków. W ggplot2 do zrobienia dotchart możemy użyć <code>geom_point</code></p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="wykresy---pakiet-ggplot2.html#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ustawiamy stat=&quot;bin&quot; - oznacza że ggplot ma zliczyć częstości występowania elementów,</span></span>
<span id="cb197-2"><a href="wykresy---pakiet-ggplot2.html#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="co"># a nie narysować każdy z osobna i obracamy wykres - ułatwia odczytanie</span></span>
<span id="cb197-3"><a href="wykresy---pakiet-ggplot2.html#cb197-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">stat=</span><span class="st">&#39;count&#39;</span>, <span class="fu">aes</span>(<span class="at">color=</span>Szczep))<span class="sc">+</span></span>
<span id="cb197-4"><a href="wykresy---pakiet-ggplot2.html#cb197-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>warunki)<span class="sc">+</span><span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>Nasze dane mogą też zawierać wysokości słupków. W takim wypadku należy użyć <code>geom_col</code></p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="wykresy---pakiet-ggplot2.html#cb198-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">9</span>), <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;E&quot;</span>))</span>
<span id="cb198-2"><a href="wykresy---pakiet-ggplot2.html#cb198-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-3"><a href="wykresy---pakiet-ggplot2.html#cb198-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> x, <span class="fu">aes</span>(<span class="at">x =</span> name, <span class="at">y =</span> x))</span>
<span id="cb198-4"><a href="wykresy---pakiet-ggplot2.html#cb198-4" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
</div>
<div id="średnia-mediana-itp.-na-wykresie" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Średnia, mediana itp. na wykresie</h2>
<div id="stat_summary" class="section level3" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Stat_summary</h3>
<p>Możemy również potrzebować wykres z zaznaczoną średnią i przedziałem ufności albo błędem standardowym.</p>
<p>W takim wypadku możemy sami policzyć te wartości, a następnie pokazać je używając <code>geom_pointrange</code> albo <code>geom_crossbar</code>.</p>
<p>Można też wykorzystać <code>stat_summary</code>, który policzy je za nas.</p>
<p>W <code>stat_summary</code> najważniejszym argumentem jest funkcja jaką zastosujemy do podsumowania danych. Może to być albo fun.y - należy podać funckję, której wynikiem jest jedna wartość np. <code>mean</code>, <code>median</code>, <code>sd</code> albo fun.data - należy podać funkcję, której wynikiem jest więcej wartości np. <code>mean_cl_boot</code> i <code>mean_cl_normal</code> policzą średnią i przedział ufności. Należy też dobrać odpowiedni geom: dla jednej wartości np. point albo line, dla większej: linerange, crossbar, pointrange, errorbar.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="wykresy---pakiet-ggplot2.html#cb199-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>dane1, <span class="fu">aes</span>(<span class="at">x=</span>Szczep, <span class="at">y=</span>pomiar, <span class="at">color=</span>Szczep))</span>
<span id="cb199-2"><a href="wykresy---pakiet-ggplot2.html#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres tylko z wartością średnią</span></span>
<span id="cb199-3"><a href="wykresy---pakiet-ggplot2.html#cb199-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb199-4"><a href="wykresy---pakiet-ggplot2.html#cb199-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> warunki, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="wykresy---pakiet-ggplot2.html#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres ze średnią i przedziałem ufności policzonym metodą bootstrap</span></span>
<span id="cb200-2"><a href="wykresy---pakiet-ggplot2.html#cb200-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>)<span class="sc">+</span></span>
<span id="cb200-3"><a href="wykresy---pakiet-ggplot2.html#cb200-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> warunki, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-45-2.png" width="672" /></p>
</div>
<div id="summary-z-użyciem-dplyr" class="section level3" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Summary z użyciem dplyr</h3>
<p>Do samodzielnego policzenia średnich możemy wykorzystać pakiet dplyr. Pozwala on m.in. na szybkie tworzenie podsumowań danych ze względu na zmienne np. różne szczepy.</p>
<p>Najpierw dane są dzielone na grupy, następnie każda grupa jest poddawana działaniu pewnej funkcji lub kilku funkcji, a wynik jest zapisywany do nowej ramki danych.</p>
<p>W pakiecie dplyr pierwszym krokiem jest podział na grupy - <code>group_by</code> i potem przekazania wyniku do funkcji <code>summarize</code>.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="wykresy---pakiet-ggplot2.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb201-2"><a href="wykresy---pakiet-ggplot2.html#cb201-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-3"><a href="wykresy---pakiet-ggplot2.html#cb201-3" aria-hidden="true" tabindex="-1"></a>summ <span class="ot">&lt;-</span> dane1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Szczep, warunki) <span class="sc">%&gt;%</span> </span>
<span id="cb201-4"><a href="wykresy---pakiet-ggplot2.html#cb201-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(pomiar), <span class="at">odch =</span> <span class="fu">sd</span>(pomiar), </span>
<span id="cb201-5"><a href="wykresy---pakiet-ggplot2.html#cb201-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">blad =</span> odch<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(pomiar)),</span>
<span id="cb201-6"><a href="wykresy---pakiet-ggplot2.html#cb201-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">lower =</span> mean<span class="sc">-</span>blad, </span>
<span id="cb201-7"><a href="wykresy---pakiet-ggplot2.html#cb201-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">upper =</span> mean<span class="sc">+</span>blad)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;Szczep&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="wykresy---pakiet-ggplot2.html#cb203-1" aria-hidden="true" tabindex="-1"></a>summ</span></code></pre></div>
<pre><code>## # A tibble: 6 × 7
## # Groups:   Szczep [3]
##   Szczep warunki  mean  odch   blad lower upper
##   &lt;chr&gt;    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 A            1  4.98 0.973 0.0562  4.93  5.04
## 2 A            2  3.96 0.748 0.0432  3.92  4.00
## 3 B            1  6.02 1.43  0.0828  5.93  6.10
## 4 B            2  6.07 1.13  0.0654  6.00  6.13
## 5 C            1  5.96 1.85  0.107   5.85  6.07
## 6 C            2  8.08 3.40  0.196   7.89  8.28</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="wykresy---pakiet-ggplot2.html#cb205-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> summ, <span class="fu">aes</span>(<span class="at">x =</span> Szczep, <span class="at">y =</span> mean, <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper, </span>
<span id="cb205-2"><a href="wykresy---pakiet-ggplot2.html#cb205-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">color =</span> Szczep)) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span> warunki, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb205-3"><a href="wykresy---pakiet-ggplot2.html#cb205-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-4"><a href="wykresy---pakiet-ggplot2.html#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres ze średnią i błędem standardowym</span></span>
<span id="cb205-5"><a href="wykresy---pakiet-ggplot2.html#cb205-5" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_pointrange</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="wykresy---pakiet-ggplot2.html#cb206-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_crossbar</span>(<span class="at">width =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-46-2.png" width="672" /></p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="wykresy---pakiet-ggplot2.html#cb207-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_errorbar</span>(<span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-46-3.png" width="672" /></p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="wykresy---pakiet-ggplot2.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Z wykresem przedstawiającym średnie można postąpić tak samo jak z boxplotem</span></span>
<span id="cb208-2"><a href="wykresy---pakiet-ggplot2.html#cb208-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> summ, <span class="fu">aes</span>(<span class="at">x =</span> Szczep, <span class="at">y =</span> mean, <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper, </span>
<span id="cb208-3"><a href="wykresy---pakiet-ggplot2.html#cb208-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">color=</span><span class="fu">factor</span>(warunki)))</span>
<span id="cb208-4"><a href="wykresy---pakiet-ggplot2.html#cb208-4" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_crossbar</span>(<span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-46-4.png" width="672" /></p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="wykresy---pakiet-ggplot2.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Jeżeli średnie połączymy za pomocą linii otrzymamy wykres interakcji opisany w dalszej części</span></span>
<span id="cb209-2"><a href="wykresy---pakiet-ggplot2.html#cb209-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> summ, <span class="fu">aes</span>(<span class="at">x =</span> Szczep, <span class="at">y =</span> mean, <span class="at">color =</span> <span class="fu">factor</span>(warunki)))</span>
<span id="cb209-3"><a href="wykresy---pakiet-ggplot2.html#cb209-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> warunki))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-46-5.png" width="672" /></p>
</div>
<div id="słupki-błędów" class="section level3" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> Słupki błędów</h3>
<p>W publikacja często spotyka się wykresy słupkowe z dodanym słupkiem błędu. Podobny efekt w ggplot2 można uzyskać przy pomocy <code>geom_errorbar</code> albo <code>geom_linerange</code>. Należy w <code>aes</code> podać dolną i górną granicę słupka. Jednak jeżeli słupki pochodzą np. z trzech powtórzeń danego eksperymentu to może lepiej byłoby je zaznaczyć w postaci kropek z przedziałem ufności niż rysować słupki.</p>
<p>Wartość średnią i ewentualny błąd standardowy albo przedział ufności możemy policzyć sami albo wykorzystać w tym celu <code>stat_summary</code>.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="wykresy---pakiet-ggplot2.html#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Przykładowe dane</span></span>
<span id="cb210-2"><a href="wykresy---pakiet-ggplot2.html#cb210-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-3"><a href="wykresy---pakiet-ggplot2.html#cb210-3" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">kontrola =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">6</span>), <span class="at">eksp_1 =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">9</span>,<span class="fl">7.5</span>), <span class="at">eksp_2 =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">6</span>), <span class="at">eksp_3 =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">8</span>), <span class="at">eksp_4 =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">12</span>,<span class="dv">4</span>))</span>
<span id="cb210-4"><a href="wykresy---pakiet-ggplot2.html#cb210-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-5"><a href="wykresy---pakiet-ggplot2.html#cb210-5" aria-hidden="true" tabindex="-1"></a><span class="co"># przechodzimy do formatu tidy</span></span>
<span id="cb210-6"><a href="wykresy---pakiet-ggplot2.html#cb210-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb210-7"><a href="wykresy---pakiet-ggplot2.html#cb210-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-8"><a href="wykresy---pakiet-ggplot2.html#cb210-8" aria-hidden="true" tabindex="-1"></a>dane <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&#39;key&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;value&#39;</span>) <span class="ot">-&gt;</span> dane</span>
<span id="cb210-9"><a href="wykresy---pakiet-ggplot2.html#cb210-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dane)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##   key      value
##   &lt;chr&gt;    &lt;dbl&gt;
## 1 kontrola     3
## 2 eksp_1       5
## 3 eksp_2       3
## 4 eksp_3      10
## 5 eksp_4       1
## 6 kontrola     7</code></pre>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="wykresy---pakiet-ggplot2.html#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># liczymy średnią i np. błąd standardowy</span></span>
<span id="cb212-2"><a href="wykresy---pakiet-ggplot2.html#cb212-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-3"><a href="wykresy---pakiet-ggplot2.html#cb212-3" aria-hidden="true" tabindex="-1"></a>podsumowanie <span class="ot">&lt;-</span> dane <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(key) <span class="sc">%&gt;%</span></span>
<span id="cb212-4"><a href="wykresy---pakiet-ggplot2.html#cb212-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(                      <span class="at">srednia =</span> <span class="fu">mean</span>(value), </span>
<span id="cb212-5"><a href="wykresy---pakiet-ggplot2.html#cb212-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">odchylenie =</span> <span class="fu">sd</span>(value), </span>
<span id="cb212-6"><a href="wykresy---pakiet-ggplot2.html#cb212-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">dolny =</span> srednia<span class="sc">-</span>(odchylenie<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(value))), </span>
<span id="cb212-7"><a href="wykresy---pakiet-ggplot2.html#cb212-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">gorny =</span> srednia<span class="sc">+</span>(odchylenie<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(value))))</span>
<span id="cb212-8"><a href="wykresy---pakiet-ggplot2.html#cb212-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-9"><a href="wykresy---pakiet-ggplot2.html#cb212-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres słupkowy z zaznaczonym błędem standardowym</span></span>
<span id="cb212-10"><a href="wykresy---pakiet-ggplot2.html#cb212-10" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> podsumowanie)</span>
<span id="cb212-11"><a href="wykresy---pakiet-ggplot2.html#cb212-11" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> key, <span class="at">y =</span> srednia), <span class="at">fill =</span> <span class="st">&quot;lightblue3&quot;</span>)<span class="sc">+</span></span>
<span id="cb212-12"><a href="wykresy---pakiet-ggplot2.html#cb212-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> dolny, <span class="at">ymax =</span> gorny, <span class="at">x =</span> key), <span class="at">width =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="wykresy---pakiet-ggplot2.html#cb213-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> key, <span class="at">y =</span> srednia), <span class="at">fill =</span> <span class="st">&quot;lightblue3&quot;</span>)<span class="sc">+</span></span>
<span id="cb213-2"><a href="wykresy---pakiet-ggplot2.html#cb213-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> dolny, <span class="at">ymax =</span> gorny, <span class="at">x =</span> key))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-47-2.png" width="672" /></p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="wykresy---pakiet-ggplot2.html#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres punktowy wyników z zaznaczonym błędem standardowym</span></span>
<span id="cb214-2"><a href="wykresy---pakiet-ggplot2.html#cb214-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data =</span> dane, <span class="fu">aes</span>(<span class="at">x =</span> key, <span class="at">y =</span> value))<span class="sc">+</span></span>
<span id="cb214-3"><a href="wykresy---pakiet-ggplot2.html#cb214-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">x =</span> key, <span class="at">ymin =</span> dolny, <span class="at">ymax =</span> gorny, <span class="at">y =</span> srednia), <span class="at">col =</span> <span class="st">&quot;red2&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-47-3.png" width="672" /></p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="wykresy---pakiet-ggplot2.html#cb215-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data =</span> dane, <span class="fu">aes</span>(<span class="at">x =</span> key, <span class="at">y =</span> value))<span class="sc">+</span></span>
<span id="cb215-2"><a href="wykresy---pakiet-ggplot2.html#cb215-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_crossbar</span>(<span class="fu">aes</span>(<span class="at">x =</span> key, <span class="at">ymin =</span> dolny, <span class="at">ymax =</span> gorny, <span class="at">y =</span> srednia), <span class="at">col =</span> <span class="st">&quot;red2&quot;</span>, <span class="at">width =</span> <span class="fl">0.25</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-47-4.png" width="672" /></p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="wykresy---pakiet-ggplot2.html#cb216-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data =</span> dane, <span class="fu">aes</span>(<span class="at">x =</span> key, <span class="at">y =</span> value))<span class="sc">+</span></span>
<span id="cb216-2"><a href="wykresy---pakiet-ggplot2.html#cb216-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x =</span> key, <span class="at">ymin =</span> dolny, <span class="at">ymax =</span> gorny, <span class="at">y =</span> srednia), <span class="at">col =</span> <span class="st">&quot;red2&quot;</span>, <span class="at">width =</span> <span class="fl">0.25</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-47-5.png" width="672" /></p>
</div>
</div>
<div id="wykres-punktowy-i-liniowy" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Wykres punktowy i liniowy</h2>
<p>Zacznijmy od pojedynczego pomiaru szczepu A z dane3</p>
<p>Dla <code>geom_point</code> albo <code>geom_line</code> konieczne jest w aes podanie x i y.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="wykresy---pakiet-ggplot2.html#cb217-1" aria-hidden="true" tabindex="-1"></a>dane3_1 <span class="ot">&lt;-</span> <span class="fu">filter</span>(dane3, Szczep <span class="sc">==</span> <span class="st">&quot;A&quot;</span> , powt <span class="sc">==</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb217-2"><a href="wykresy---pakiet-ggplot2.html#cb217-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-3"><a href="wykresy---pakiet-ggplot2.html#cb217-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dane3_1, <span class="fu">aes</span>(<span class="at">x =</span> czas, <span class="at">y =</span> pomiar))</span>
<span id="cb217-4"><a href="wykresy---pakiet-ggplot2.html#cb217-4" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="wykresy---pakiet-ggplot2.html#cb218-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-48-2.png" width="672" /></p>
<div id="dopasowanie-linii-trendu-do-wykresu-punktowego" class="section level3" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Dopasowanie linii trendu do wykresu punktowego</h3>
<p>Zamiast rysować linię, możemy dopasować do wyników linię trendu (może być też inna niż liniowa np. logarytmiczna, kwadratowa, ograniczają nas tylko umiejętności pisania formuł w R ;)). Dopasowanie wykona <code>stat_smooth</code>. Domyślnie dopasuje linię do danych korzystając z własnego algorytmu (loess - lokalne wygładzanie wielomianami niskich stopni ;)), który ma za zadanie uzyskać jak najlepsze dopasowanie do danych, zaznaczy również przedział ufności. Możemy narzucić własną metodę i formułę.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="wykresy---pakiet-ggplot2.html#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># metoda loess</span></span>
<span id="cb219-2"><a href="wykresy---pakiet-ggplot2.html#cb219-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">stat_smooth</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="wykresy---pakiet-ggplot2.html#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co"># metoda lm - dopasowanie do linii prostej</span></span>
<span id="cb221-2"><a href="wykresy---pakiet-ggplot2.html#cb221-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-49-2.png" width="672" /></p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="wykresy---pakiet-ggplot2.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># metoda lm z podaną formułą</span></span>
<span id="cb223-2"><a href="wykresy---pakiet-ggplot2.html#cb223-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y<span class="sc">~</span><span class="fu">log</span>(x))<span class="sc">+</span></span>
<span id="cb223-3"><a href="wykresy---pakiet-ggplot2.html#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-49-3.png" width="672" /></p>
<p>Sprawdzenie dopasowania można wykonać funkcją <code>lm</code>. Jej <code>summary</code> podaje wartośc R^2, istotność, parametry wzoru(coefficients).</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="wykresy---pakiet-ggplot2.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(pomiar<span class="sc">~</span>czas, <span class="at">data=</span>dane3_1))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = pomiar ~ czas, data = dane3_1)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.094113 -0.014337  0.009274  0.023692  0.055815 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 6.352e-02  4.631e-03   13.72   &lt;2e-16 ***
## czas        1.027e-02  7.962e-05  128.97   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.0325 on 198 degrees of freedom
## Multiple R-squared:  0.9882, Adjusted R-squared:  0.9882 
## F-statistic: 1.663e+04 on 1 and 198 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="wykresy---pakiet-ggplot2.html#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dodanie tekstu do wykresu np. równanie opisujące linię trendu</span></span>
<span id="cb227-2"><a href="wykresy---pakiet-ggplot2.html#cb227-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb227-3"><a href="wykresy---pakiet-ggplot2.html#cb227-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="cn">NULL</span>, <span class="at">x =</span> <span class="dv">50</span>, <span class="at">y =</span> <span class="fl">0.2</span>, <span class="at">label =</span> <span class="st">&quot;y = ax + b&quot;</span>, <span class="at">size =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<p>Możemy zastosować <code>stat_smooth</code> dla wszystkich danych.</p>
<p><code>geom_point</code> można rozróżniać pod względem: color, shape, size, a <code>geom_line</code> pod względem: color i linetype.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="wykresy---pakiet-ggplot2.html#cb229-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>dane3, <span class="fu">aes</span>(<span class="at">x =</span> czas, <span class="at">y =</span> pomiar, <span class="at">color =</span> Szczep))</span>
<span id="cb229-2"><a href="wykresy---pakiet-ggplot2.html#cb229-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="wykresy---pakiet-ggplot2.html#cb231-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Szczep)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-51-2.png" width="672" /></p>
<p>Do przedstawienia takich danych można też użyć boxplot.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="wykresy---pakiet-ggplot2.html#cb233-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>dane3, <span class="fu">aes</span>(<span class="at">x=</span>czas, <span class="at">group =</span> plyr<span class="sc">::</span><span class="fu">round_any</span>(czas, <span class="dv">10</span>, floor), <span class="at">y=</span>pomiar))</span>
<span id="cb233-2"><a href="wykresy---pakiet-ggplot2.html#cb233-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_boxplot</span>()<span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>Szczep)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
</div>
<div id="jak-poradzić-sobie-z-nadmiarem-punktów-na-wykresie-overplotting" class="section level3" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> Jak poradzić sobie z nadmiarem punktów na wykresie (overplotting)?</h3>
<p>Jednym z problemów podczas stosowania wykresów punktowych może być zbyt duża liczba punktów powodująca zacieranie się informacji.</p>
<p>W ggplot2 możemy skorzystać z kilku sposobów poradzenia sobie z “overplotting.” W przypadku danych ciągłych można wykorzystać parametr <code>alpha</code> pozwalający na ustawienie półprzezroczystych punktów albo wykorzystać punkty niewypełnione w środku - <code>shape = 1:14</code>.</p>
<p>Innym sposobem może być wykorzystanie <code>geom_density2d</code>, który wylicza gęstość w układzie dwuwymiarowym i zaznacza liniami na wykresie albo <code>geom_bin2d</code> , który pozwala zrobić dwuwymiarowy histogram, możliwa kotrola <code>binwidth</code> (trzeba podać wektor dwóch wartości).</p>
<p>Dla danych dyskretnych pomóc może wykorzystanie <code>position="jitter"</code>, która pozwala losowo rozrzucić punkty albo zastosowanie parametru alpha oraz <code>stat_sum</code> - wielkość punktów zależy od ilości nakładających się punktów.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="wykresy---pakiet-ggplot2.html#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co"># przykładowe dane ciągłe</span></span>
<span id="cb234-2"><a href="wykresy---pakiet-ggplot2.html#cb234-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-3"><a href="wykresy---pakiet-ggplot2.html#cb234-3" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">4000</span>), <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">4000</span>))</span>
<span id="cb234-4"><a href="wykresy---pakiet-ggplot2.html#cb234-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-5"><a href="wykresy---pakiet-ggplot2.html#cb234-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> x,<span class="at">y =</span> y))</span>
<span id="cb234-6"><a href="wykresy---pakiet-ggplot2.html#cb234-6" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="wykresy---pakiet-ggplot2.html#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># zastosowanie alpha</span></span>
<span id="cb235-2"><a href="wykresy---pakiet-ggplot2.html#cb235-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-2.png" width="672" /></p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="wykresy---pakiet-ggplot2.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co"># puste punkty</span></span>
<span id="cb236-2"><a href="wykresy---pakiet-ggplot2.html#cb236-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-3.png" width="672" /></p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="wykresy---pakiet-ggplot2.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># geom_density2d albo geom_bin2d()</span></span>
<span id="cb237-2"><a href="wykresy---pakiet-ggplot2.html#cb237-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">geom_density2d</span>(<span class="at">color =</span> <span class="st">&quot;red2&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-4.png" width="672" /></p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="wykresy---pakiet-ggplot2.html#cb238-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_bin2d</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-5.png" width="672" /></p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="wykresy---pakiet-ggplot2.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co"># można również użyć stat_density2d z innym geomem niż linia</span></span>
<span id="cb239-2"><a href="wykresy---pakiet-ggplot2.html#cb239-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-3"><a href="wykresy---pakiet-ggplot2.html#cb239-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">stat_density2d</span>(<span class="at">geom =</span> <span class="st">&quot;polygon&quot;</span>, <span class="fu">aes</span>(<span class="at">fill  =</span>  ..level..))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-6.png" width="672" /></p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="wykresy---pakiet-ggplot2.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co"># linie widoczne na wykresach są wynikiem konwersji do pdf, nie będzie ich na wykresach zapisanych np. w formacie .tiff</span></span>
<span id="cb240-2"><a href="wykresy---pakiet-ggplot2.html#cb240-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">stat_density2d</span>(<span class="at">geom =</span> <span class="st">&quot;tile&quot;</span>, <span class="at">contour  =</span>  <span class="cn">FALSE</span>, <span class="fu">aes</span>(<span class="at">fill  =</span>  ..density..))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-7.png" width="672" /></p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="wykresy---pakiet-ggplot2.html#cb241-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">stat_density2d</span>(<span class="at">geom =</span> <span class="st">&quot;tile&quot;</span>, <span class="at">contour  =</span>  <span class="cn">FALSE</span>, <span class="fu">aes</span>(<span class="at">fill  =</span>  ..density..))<span class="sc">+</span></span>
<span id="cb241-2"><a href="wykresy---pakiet-ggplot2.html#cb241-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low  =</span>  <span class="st">&quot;lightyellow&quot;</span>, <span class="at">high  =</span>  <span class="st">&quot;darkgreen&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-8.png" width="672" /></p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="wykresy---pakiet-ggplot2.html#cb242-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">stat_density2d</span>(<span class="at">geom =</span> <span class="st">&quot;tile&quot;</span>, <span class="at">contour  =</span>  <span class="cn">FALSE</span>, <span class="fu">aes</span>(<span class="at">fill  =</span>  ..density..))<span class="sc">+</span></span>
<span id="cb242-2"><a href="wykresy---pakiet-ggplot2.html#cb242-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-9.png" width="672" /></p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="wykresy---pakiet-ggplot2.html#cb243-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">stat_density2d</span>(<span class="at">geom =</span> <span class="st">&quot;tile&quot;</span>, <span class="at">contour  =</span>  <span class="cn">FALSE</span>, <span class="fu">aes</span>(<span class="at">alpha  =</span>  ..density..))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-10.png" width="672" /></p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="wykresy---pakiet-ggplot2.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># zamiast kwadratów można użyć sześciokątów, wymaga zainstalowanie pakietu hexbin</span></span>
<span id="cb244-2"><a href="wykresy---pakiet-ggplot2.html#cb244-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-3"><a href="wykresy---pakiet-ggplot2.html#cb244-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hexbin)</span>
<span id="cb244-4"><a href="wykresy---pakiet-ggplot2.html#cb244-4" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">stat_binhex</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-11.png" width="672" /></p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="wykresy---pakiet-ggplot2.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dane dyskretne</span></span>
<span id="cb245-2"><a href="wykresy---pakiet-ggplot2.html#cb245-2" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">2</span><span class="sc">*</span>dane)</span>
<span id="cb245-3"><a href="wykresy---pakiet-ggplot2.html#cb245-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-4"><a href="wykresy---pakiet-ggplot2.html#cb245-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> x,<span class="at">y =</span> y))</span>
<span id="cb245-5"><a href="wykresy---pakiet-ggplot2.html#cb245-5" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-12.png" width="672" /></p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="wykresy---pakiet-ggplot2.html#cb246-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-13.png" width="672" /></p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="wykresy---pakiet-ggplot2.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wykorzystanie position = &quot;jitter&quot; i alpha</span></span>
<span id="cb247-2"><a href="wykresy---pakiet-ggplot2.html#cb247-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">&quot;jitter&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-14.png" width="672" /></p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="wykresy---pakiet-ggplot2.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co"># z wykorzystaniem stat_sum</span></span>
<span id="cb248-2"><a href="wykresy---pakiet-ggplot2.html#cb248-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">stat_sum</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-15.png" width="672" /></p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="wykresy---pakiet-ggplot2.html#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="co"># czasem pomóc może też zmiana skali na logarytmiczną</span></span>
<span id="cb249-2"><a href="wykresy---pakiet-ggplot2.html#cb249-2" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rlnorm</span>(<span class="dv">1000</span>), <span class="at">y =</span> <span class="fu">rlnorm</span>(<span class="dv">1000</span>))</span>
<span id="cb249-3"><a href="wykresy---pakiet-ggplot2.html#cb249-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> x,<span class="at">y =</span> y))</span>
<span id="cb249-4"><a href="wykresy---pakiet-ggplot2.html#cb249-4" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-16.png" width="672" /></p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="wykresy---pakiet-ggplot2.html#cb250-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">scale_y_log10</span>()<span class="sc">+</span><span class="fu">scale_x_log10</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-17.png" width="672" /></p>
</div>
<div id="wykres-wstążka-ribbon" class="section level3" number="5.5.3">
<h3><span class="header-section-number">5.5.3</span> Wykres wstążka (ribbon)</h3>
<p>Użycie <code>geom_ribbon</code> wymaga wstępnego podsumowania danych np. przy użyciu dplyr - analogicznie jak dane1. W tym wypadku zmiennymi, pod względem których będziemy dzielić dane na grupy będą szczep i czas.</p>
<p>Półprzezroczystą wstążkę uzyskujemy dzięki parametrowi alpha.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="wykresy---pakiet-ggplot2.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb251-2"><a href="wykresy---pakiet-ggplot2.html#cb251-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-3"><a href="wykresy---pakiet-ggplot2.html#cb251-3" aria-hidden="true" tabindex="-1"></a>summ <span class="ot">&lt;-</span> dane3 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Szczep, czas) <span class="sc">%&gt;%</span> </span>
<span id="cb251-4"><a href="wykresy---pakiet-ggplot2.html#cb251-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(pomiar), </span>
<span id="cb251-5"><a href="wykresy---pakiet-ggplot2.html#cb251-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(pomiar), </span>
<span id="cb251-6"><a href="wykresy---pakiet-ggplot2.html#cb251-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">blad =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(pomiar)), </span>
<span id="cb251-7"><a href="wykresy---pakiet-ggplot2.html#cb251-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">lower =</span> mean<span class="sc">-</span>blad, </span>
<span id="cb251-8"><a href="wykresy---pakiet-ggplot2.html#cb251-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">upper =</span> mean<span class="sc">+</span>blad)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;Szczep&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="wykresy---pakiet-ggplot2.html#cb253-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> summ, <span class="fu">aes</span>(<span class="at">x =</span> czas, <span class="at">y =</span> mean, <span class="at">color =</span> Szczep, <span class="at">fill =</span> Szczep))</span>
<span id="cb253-2"><a href="wykresy---pakiet-ggplot2.html#cb253-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), <span class="at">alpha =</span> <span class="fl">0.25</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
</div>
</div>
<div id="kolory-osie-panele" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> Kolory, osie, panele</h2>
<div id="porównywanie---fill-color-shape" class="section level3" number="5.6.1">
<h3><span class="header-section-number">5.6.1</span> Porównywanie - fill, color, shape</h3>
<p>Porównanie kilku szczepów można zrobić w ten sam sposób, wybierając w <code>aes</code> - <code>fill=Szczep</code> albo <code>color=Szczep</code> (w zależności od geomu, fill pasuje do histogram i density, color do density, line, point, boxplot itd.)</p>
<p>W histogramie domyślnie dostaniemy słupki ustawione jeden na drugim, jeżeli chcemy słupki ustawione obok siebie należy ustawić parametr <code>position="dodge"</code>.</p>
<p>W przypadku boxplot dla kilku cech można pod x podstawić Szczep - otrzymamy wykres zawierający po jednym boxplocie dla jednego szczepu.</p>
<p>Wybieram dane tylko dla warunków 1.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="wykresy---pakiet-ggplot2.html#cb254-1" aria-hidden="true" tabindex="-1"></a>dane1_2 <span class="ot">&lt;-</span> dane1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(warunki <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb254-2"><a href="wykresy---pakiet-ggplot2.html#cb254-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-3"><a href="wykresy---pakiet-ggplot2.html#cb254-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dane1_2, <span class="fu">aes</span>(<span class="at">x =</span> pomiar))</span>
<span id="cb254-4"><a href="wykresy---pakiet-ggplot2.html#cb254-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram dla trzech szczepów</span></span>
<span id="cb254-5"><a href="wykresy---pakiet-ggplot2.html#cb254-5" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Szczep, <span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="fl">0.5</span>, </span>
<span id="cb254-6"><a href="wykresy---pakiet-ggplot2.html#cb254-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">position=</span><span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="wykresy---pakiet-ggplot2.html#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gęstość dla trzech szczepów rozróżniona przez color</span></span>
<span id="cb255-2"><a href="wykresy---pakiet-ggplot2.html#cb255-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">color =</span> Szczep))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-55-2.png" width="672" /></p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="wykresy---pakiet-ggplot2.html#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gęstość rozróżniona przez fill, półprzezroczystość uzyskujemy parametrem alpha</span></span>
<span id="cb256-2"><a href="wykresy---pakiet-ggplot2.html#cb256-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Szczep), <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">size =</span> <span class="fl">0.75</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-55-3.png" width="672" /></p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="wykresy---pakiet-ggplot2.html#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogramy nałożone na siebie - wymaga ustawienia position = &quot;identity&quot;</span></span>
<span id="cb257-2"><a href="wykresy---pakiet-ggplot2.html#cb257-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>dane1_2, <span class="fu">aes</span>(<span class="at">x =</span> pomiar))</span>
<span id="cb257-3"><a href="wykresy---pakiet-ggplot2.html#cb257-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density.., <span class="at">fill =</span> Szczep), <span class="at">binwidth =</span> <span class="fl">0.75</span>, <span class="at">alpha =</span> <span class="fl">0.45</span>, <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-55-4.png" width="672" /></p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="wykresy---pakiet-ggplot2.html#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram &quot;back to back&quot; wymaga ustawienia w drugim geom_histogram ujemnego y</span></span>
<span id="cb258-2"><a href="wykresy---pakiet-ggplot2.html#cb258-2" aria-hidden="true" tabindex="-1"></a>dane1_3 <span class="ot">&lt;-</span> dane1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Szczep <span class="sc">==</span> <span class="st">&quot;B&quot;</span>, warunki <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb258-3"><a href="wykresy---pakiet-ggplot2.html#cb258-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dane1_1, <span class="fu">aes</span>(<span class="at">x =</span> pomiar))</span>
<span id="cb258-4"><a href="wykresy---pakiet-ggplot2.html#cb258-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density.., <span class="at">fill =</span> <span class="st">&quot;dodgerblue3&quot;</span>), <span class="at">binwidth =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb258-5"><a href="wykresy---pakiet-ggplot2.html#cb258-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">data =</span> dane1_3, <span class="fu">aes</span>(<span class="at">x =</span> pomiar, <span class="at">y =</span> <span class="sc">-</span>..density.., <span class="at">fill =</span> <span class="st">&quot;coral2&quot;</span>),</span>
<span id="cb258-6"><a href="wykresy---pakiet-ggplot2.html#cb258-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb258-7"><a href="wykresy---pakiet-ggplot2.html#cb258-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">&quot;Szczep&quot;</span>,</span>
<span id="cb258-8"><a href="wykresy---pakiet-ggplot2.html#cb258-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;coral2&quot;</span> <span class="ot">=</span> <span class="st">&quot;coral2&quot;</span>, <span class="st">&quot;dodgerblue3&quot;</span> <span class="ot">=</span> <span class="st">&quot;dodgerblue3&quot;</span>), </span>
<span id="cb258-9"><a href="wykresy---pakiet-ggplot2.html#cb258-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;B&quot;</span>,<span class="st">&quot;A&quot;</span>))</span>
<span id="cb258-10"><a href="wykresy---pakiet-ggplot2.html#cb258-10" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-55-5.png" width="672" /></p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="wykresy---pakiet-ggplot2.html#cb259-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-55-6.png" width="672" /></p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="wykresy---pakiet-ggplot2.html#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot dla każdego szczepu</span></span>
<span id="cb260-2"><a href="wykresy---pakiet-ggplot2.html#cb260-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dane1_2, <span class="fu">aes</span>(<span class="at">x =</span> Szczep, <span class="at">y =</span> pomiar))</span>
<span id="cb260-3"><a href="wykresy---pakiet-ggplot2.html#cb260-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-55-7.png" width="672" /></p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="wykresy---pakiet-ggplot2.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxploty też mogą być kolorowe ;)</span></span>
<span id="cb261-2"><a href="wykresy---pakiet-ggplot2.html#cb261-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> Szczep))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-55-8.png" width="672" /></p>
</div>
<div id="zmiana-skali-kolorów" class="section level3" number="5.6.2">
<h3><span class="header-section-number">5.6.2</span> Zmiana skali kolorów</h3>
<p>Możemy zmienić domyślne kolory wykresu korzystając z funkcji <code>scale_colour\fill_sth</code>. Rodzaj funkcji zależy od rodzaju danych - ilościowe albo jakościowe.</p>
<p>Dla danych jakościowych można użyć: <code>scale_color_grey</code> - odcienie szarości, <code>scale_colour_brewer</code> - zawiera zestawy kolorów ze strony <a href="http://colorbrewer2.org/">Color Brewer</a>, <code>scale_color_viridis_d</code> - zawiera palety viridis, <code>scale_color_hue</code> - pozwala na wybranie kolorów korzystając z palety HCL. Można też ustawić własny zestaw kolorów korzystając z nazw <a href="http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf">kolorów R</a> albo np. przez RGB, korzystając z <code>scale_colour_manual</code></p>
<p>Dla danych ilościowych można wybrać: <code>scale_color_gradient</code> - gradient między dwoma kolorami, <code>scale_color_gradient</code> - gradient pomiędzy 3 kolorami, <code>scale_color_gradientn</code> - gradient pomiędzy dowolną liczbą kolorów albo <code>scale_color_viridis_c</code></p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="wykresy---pakiet-ggplot2.html#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Zmienne jakościowe</span></span>
<span id="cb262-2"><a href="wykresy---pakiet-ggplot2.html#cb262-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-3"><a href="wykresy---pakiet-ggplot2.html#cb262-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Odcienie szarości</span></span>
<span id="cb262-4"><a href="wykresy---pakiet-ggplot2.html#cb262-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dane1_2, <span class="fu">aes</span>(<span class="at">x =</span> pomiar))</span>
<span id="cb262-5"><a href="wykresy---pakiet-ggplot2.html#cb262-5" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Szczep, <span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb262-6"><a href="wykresy---pakiet-ggplot2.html#cb262-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Szczep) <span class="sc">+</span> <span class="fu">scale_fill_grey</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="wykresy---pakiet-ggplot2.html#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co"># można wybrać początek i koniec skali</span></span>
<span id="cb263-2"><a href="wykresy---pakiet-ggplot2.html#cb263-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-3"><a href="wykresy---pakiet-ggplot2.html#cb263-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Szczep, <span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb263-4"><a href="wykresy---pakiet-ggplot2.html#cb263-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Szczep) <span class="sc">+</span> <span class="fu">scale_fill_grey</span>(<span class="at">start =</span> <span class="fl">0.1</span>, <span class="at">end =</span> <span class="fl">0.6</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-56-2.png" width="672" /></p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="wykresy---pakiet-ggplot2.html#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="co"># skala ColorBrewer</span></span>
<span id="cb264-2"><a href="wykresy---pakiet-ggplot2.html#cb264-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb264-3"><a href="wykresy---pakiet-ggplot2.html#cb264-3" aria-hidden="true" tabindex="-1"></a><span class="fu">display.brewer.all</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="wykresy---pakiet-ggplot2.html#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co"># z użyciem ColorBrewer</span></span>
<span id="cb265-2"><a href="wykresy---pakiet-ggplot2.html#cb265-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-3"><a href="wykresy---pakiet-ggplot2.html#cb265-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dane1_2, <span class="fu">aes</span>(<span class="at">x =</span> pomiar))</span>
<span id="cb265-4"><a href="wykresy---pakiet-ggplot2.html#cb265-4" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Szczep, <span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb265-5"><a href="wykresy---pakiet-ggplot2.html#cb265-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Szczep) <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="wykresy---pakiet-ggplot2.html#cb266-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Szczep, <span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb266-2"><a href="wykresy---pakiet-ggplot2.html#cb266-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Szczep) <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-58-2.png" width="672" /></p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="wykresy---pakiet-ggplot2.html#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co"># z użyciem viridis, argument option przyjmuje wartości od A do H</span></span>
<span id="cb267-2"><a href="wykresy---pakiet-ggplot2.html#cb267-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-3"><a href="wykresy---pakiet-ggplot2.html#cb267-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Szczep, <span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb267-4"><a href="wykresy---pakiet-ggplot2.html#cb267-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Szczep) <span class="sc">+</span> <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&#39;C&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-58-3.png" width="672" /></p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="wykresy---pakiet-ggplot2.html#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="co"># zakres palety można modyfikować przy pomocy argumentów begin i end</span></span>
<span id="cb268-2"><a href="wykresy---pakiet-ggplot2.html#cb268-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-3"><a href="wykresy---pakiet-ggplot2.html#cb268-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Szczep, <span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb268-4"><a href="wykresy---pakiet-ggplot2.html#cb268-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Szczep) <span class="sc">+</span> <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&#39;C&#39;</span>, <span class="at">begin =</span> <span class="fl">0.4</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-58-4.png" width="672" /></p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="wykresy---pakiet-ggplot2.html#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="co"># skala z użyciem palety HCL - ustawiamy trzy argumenty: h(zakres barw), c(intensywność) i l(jasność)</span></span>
<span id="cb269-2"><a href="wykresy---pakiet-ggplot2.html#cb269-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-3"><a href="wykresy---pakiet-ggplot2.html#cb269-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Szczep, <span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb269-4"><a href="wykresy---pakiet-ggplot2.html#cb269-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Szczep) <span class="sc">+</span> <span class="fu">scale_fill_hue</span>(<span class="at">h =</span> <span class="fu">c</span>(<span class="dv">160</span>,<span class="dv">320</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-58-5.png" width="672" /></p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="wykresy---pakiet-ggplot2.html#cb270-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Szczep, <span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb270-2"><a href="wykresy---pakiet-ggplot2.html#cb270-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Szczep) <span class="sc">+</span> <span class="fu">scale_fill_hue</span>(<span class="at">c =</span> <span class="dv">200</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-58-6.png" width="672" /></p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="wykresy---pakiet-ggplot2.html#cb271-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Szczep, <span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb271-2"><a href="wykresy---pakiet-ggplot2.html#cb271-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Szczep) <span class="sc">+</span> <span class="fu">scale_fill_hue</span>(<span class="at">l =</span> <span class="dv">85</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-58-7.png" width="672" /></p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="wykresy---pakiet-ggplot2.html#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="co"># skala manualna</span></span>
<span id="cb272-2"><a href="wykresy---pakiet-ggplot2.html#cb272-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-3"><a href="wykresy---pakiet-ggplot2.html#cb272-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Szczep, <span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb272-4"><a href="wykresy---pakiet-ggplot2.html#cb272-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Szczep) <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;forestgreen&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;coral&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-58-8.png" width="672" /></p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="wykresy---pakiet-ggplot2.html#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Zmienne ilościowe</span></span>
<span id="cb273-2"><a href="wykresy---pakiet-ggplot2.html#cb273-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-3"><a href="wykresy---pakiet-ggplot2.html#cb273-3" aria-hidden="true" tabindex="-1"></a><span class="co"># domyślny gradient</span></span>
<span id="cb273-4"><a href="wykresy---pakiet-ggplot2.html#cb273-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(dane1_2, pomiar <span class="sc">&lt;</span> <span class="dv">10</span>))</span>
<span id="cb273-5"><a href="wykresy---pakiet-ggplot2.html#cb273-5" aria-hidden="true" tabindex="-1"></a>p  <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">x =</span> Szczep, <span class="at">y =</span> pomiar, <span class="at">color =</span> pomiar), <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb273-6"><a href="wykresy---pakiet-ggplot2.html#cb273-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-7"><a href="wykresy---pakiet-ggplot2.html#cb273-7" aria-hidden="true" tabindex="-1"></a><span class="co"># dwa kolory</span></span>
<span id="cb273-8"><a href="wykresy---pakiet-ggplot2.html#cb273-8" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">high =</span> <span class="st">&quot;gold&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-58-9.png" width="672" /></p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="wykresy---pakiet-ggplot2.html#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># trzy kolory - domyślnie założy, że wartość środkowa to zero, jeżeli jest inaczej to trzeba to podać w midpoint</span></span>
<span id="cb274-2"><a href="wykresy---pakiet-ggplot2.html#cb274-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_color_gradient2</span>(<span class="at">low =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">mid =</span> <span class="st">&quot;coral&quot;</span>, <span class="at">high =</span> <span class="st">&quot;gold&quot;</span>, <span class="at">midpoint =</span> <span class="dv">6</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-58-10.png" width="672" /></p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="wykresy---pakiet-ggplot2.html#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="co"># więcej kolorów</span></span>
<span id="cb275-2"><a href="wykresy---pakiet-ggplot2.html#cb275-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_color_gradientn</span>(<span class="at">colours =</span> <span class="fu">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;blue&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-58-11.png" width="672" /></p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="wykresy---pakiet-ggplot2.html#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ColorBrewer</span></span>
<span id="cb276-2"><a href="wykresy---pakiet-ggplot2.html#cb276-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-3"><a href="wykresy---pakiet-ggplot2.html#cb276-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_color_distiller</span>(<span class="at">palette =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-58-12.png" width="672" /></p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="wykresy---pakiet-ggplot2.html#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="co"># viridis</span></span>
<span id="cb277-2"><a href="wykresy---pakiet-ggplot2.html#cb277-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-3"><a href="wykresy---pakiet-ggplot2.html#cb277-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">&#39;A&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-58-13.png" width="672" /></p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="wykresy---pakiet-ggplot2.html#cb278-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">&#39;D&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-58-14.png" width="672" /></p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="wykresy---pakiet-ggplot2.html#cb279-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">&#39;H&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-58-15.png" width="672" />
Analogicznie do kolorów można ustawiać skale dotyczące kształtu punktów, stylu linii itp.</p>
</div>
<div id="podział-wykresu-na-panele" class="section level3" number="5.6.3">
<h3><span class="header-section-number">5.6.3</span> Podział wykresu na panele</h3>
<p>Innym sposobem na rozróżnianie danych jest użycie paneli (facet).</p>
<p>Dzielimy wykres na części pod względem zmiennej np. Szczepu używając <code>facet_wrap</code> albo <code>facet_grid</code></p>
<p><code>facet_grid</code> - rozmieści wykresy w tabeli według jednej lub dwóch zmiennych podanych w formule np. zmienna1 ~ zmienna2
<code>facet_wrap</code> - stworzy “wstążkę” wykresów, końcową liczbę kolumn/wiersz można ustawić argumentami ncol/nrow. W formule po + można dodawać kolejne zmienne np. ~ zmienna1 + zmienna2</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="wykresy---pakiet-ggplot2.html#cb280-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dane1_2, <span class="fu">aes</span>(<span class="at">x =</span> pomiar))</span>
<span id="cb280-2"><a href="wykresy---pakiet-ggplot2.html#cb280-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="fl">0.5</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)<span class="sc">+</span></span>
<span id="cb280-3"><a href="wykresy---pakiet-ggplot2.html#cb280-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Szczep, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="wykresy---pakiet-ggplot2.html#cb281-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">color =</span> Szczep)) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Szczep, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-59-2.png" width="672" /></p>
<p>Oba sposoby można ze sobą dowolnie łączyć.</p>
<p>Analizujemy dane pod względem szczepu i warunków.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="wykresy---pakiet-ggplot2.html#cb282-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dane1, <span class="fu">aes</span>(<span class="at">x =</span> pomiar))</span>
<span id="cb282-2"><a href="wykresy---pakiet-ggplot2.html#cb282-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(warunki)), <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)<span class="sc">+</span></span>
<span id="cb282-3"><a href="wykresy---pakiet-ggplot2.html#cb282-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Szczep, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-60-1.png" width="672" /></p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="wykresy---pakiet-ggplot2.html#cb283-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">color =</span> Szczep)) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span> warunki, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-60-2.png" width="672" /></p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="wykresy---pakiet-ggplot2.html#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram podzielony pod względem szczepu i warunków - facet_grid</span></span>
<span id="cb284-2"><a href="wykresy---pakiet-ggplot2.html#cb284-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">facet_grid</span>(Szczep <span class="sc">~</span> warunki)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-60-3.png" width="672" /></p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="wykresy---pakiet-ggplot2.html#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Podobny efekt do facet_frid można osiągnąć stosując facet_wrap z więcej niż jednym warunkiem</span></span>
<span id="cb285-2"><a href="wykresy---pakiet-ggplot2.html#cb285-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Kolejne warunki dodaje się znakiem +</span></span>
<span id="cb285-3"><a href="wykresy---pakiet-ggplot2.html#cb285-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Szczep <span class="sc">+</span> warunki, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-60-4.png" width="672" /></p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="wykresy---pakiet-ggplot2.html#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Osie nie muszą być jednakowe dla wszystkich części</span></span>
<span id="cb286-2"><a href="wykresy---pakiet-ggplot2.html#cb286-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">facet_grid</span>(Szczep <span class="sc">~</span> warunki, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-60-5.png" width="672" /></p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="wykresy---pakiet-ggplot2.html#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dzielić na części dzięki facet można każdy typ wykresu</span></span>
<span id="cb287-2"><a href="wykresy---pakiet-ggplot2.html#cb287-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dane1, <span class="fu">aes</span>(<span class="at">x =</span> Szczep, <span class="at">y =</span> pomiar))</span>
<span id="cb287-3"><a href="wykresy---pakiet-ggplot2.html#cb287-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> Szczep)) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span> warunki)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-60-6.png" width="672" /></p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="wykresy---pakiet-ggplot2.html#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxploty można również rozmiescić według jednego czynnika, a pokolorować według drugiego</span></span>
<span id="cb288-2"><a href="wykresy---pakiet-ggplot2.html#cb288-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(warunki)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-60-7.png" width="672" /></p>
</div>
<div id="zmiana-skali-osi-obracanie-wykresu" class="section level3" number="5.6.4">
<h3><span class="header-section-number">5.6.4</span> Zmiana skali, osi, obracanie wykresu</h3>
<p>ggplot2 domyślnie dobiera takie parametry osi, żeby zmieściły się wszystkie dane, ale można je zmieniać używając <code>scale_x_continuous</code> albo <code>scale_y_continuous</code>.</p>
<p>Jeżeli chcemy tylko zmienić limity osi można to zrobić funkcją <code>xlim</code> i <code>ylim</code>.</p>
<p>Trzeba pamiętać, że po zmianie limitów osi najpierw zostaną usunięte wartości, które się nie mieszczą, a potem policzone statystyki, więc takie wykresy jak <code>geom_boxplot</code>, <code>stat_smooth</code>, <code>stat_summary</code> i inne mogą ulec zmianie. Jeżeli chcemy tego uniknąć należy zamiast osi zmieniać układ współrzędnych - <code>coord_cartesian(xlim, ylim)</code>.</p>
<p>Przy ich pomocy możemy zmienić np. parametry:
* limits - miejsce startu i końca osi np <code>limits = c(1,10)</code>
* name - nazwa osi
* breaks - miejsca “tick marks”
* labels - nazwy “tick marks”</p>
<p>Podstawowe transformacje osi to <code>scale_y_log10</code>, <code>scale_y_reverse</code>, <code>scale_y_sqrt</code>.</p>
<p>Oś % - należy wpisać <code>labels=percent</code> w scale oraz załadować pakiet scales.</p>
<p>Jeżeli chcemy obrócić wykres o 90 stopni możemy użyć funkcji <code>coord_flip</code>.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="wykresy---pakiet-ggplot2.html#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Zmiana osi na przykładzie boxplot</span></span>
<span id="cb289-2"><a href="wykresy---pakiet-ggplot2.html#cb289-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dane1_2, <span class="fu">aes</span>(<span class="at">x =</span> Szczep, <span class="at">y =</span> pomiar))</span>
<span id="cb289-3"><a href="wykresy---pakiet-ggplot2.html#cb289-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span>
<span id="cb289-4"><a href="wykresy---pakiet-ggplot2.html#cb289-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-5"><a href="wykresy---pakiet-ggplot2.html#cb289-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Ustawienie startu i końca osi oraz miejsc podziału</span></span>
<span id="cb289-6"><a href="wykresy---pakiet-ggplot2.html#cb289-6" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">15</span>), <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">15</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="wykresy---pakiet-ggplot2.html#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Miejsca podziału nie muszą być w równych odstępach i mogą być dowolnie nazwane</span></span>
<span id="cb290-2"><a href="wykresy---pakiet-ggplot2.html#cb290-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">15</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">15</span>), </span>
<span id="cb290-3"><a href="wykresy---pakiet-ggplot2.html#cb290-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;mało&quot;</span>, <span class="st">&quot;lepiej&quot;</span>, <span class="st">&quot;ok&quot;</span>, <span class="st">&quot;za dużo&quot;</span>), </span>
<span id="cb290-4"><a href="wykresy---pakiet-ggplot2.html#cb290-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">&quot;Coś&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-61-2.png" width="672" /></p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="wykresy---pakiet-ggplot2.html#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres obrócony</span></span>
<span id="cb291-2"><a href="wykresy---pakiet-ggplot2.html#cb291-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">15</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">15</span>), </span>
<span id="cb291-3"><a href="wykresy---pakiet-ggplot2.html#cb291-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;mało&quot;</span>, <span class="st">&quot;lepiej&quot;</span>, <span class="st">&quot;ok&quot;</span>, <span class="st">&quot;za dużo&quot;</span>), </span>
<span id="cb291-4"><a href="wykresy---pakiet-ggplot2.html#cb291-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name=</span><span class="st">&quot;Coś&quot;</span>) <span class="sc">+</span> <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-61-3.png" width="672" /></p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="wykresy---pakiet-ggplot2.html#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Skala logarytmiczna</span></span>
<span id="cb292-2"><a href="wykresy---pakiet-ggplot2.html#cb292-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">15</span>), <span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-61-4.png" width="672" /></p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="wykresy---pakiet-ggplot2.html#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres &quot;do góry nogami&quot;</span></span>
<span id="cb293-2"><a href="wykresy---pakiet-ggplot2.html#cb293-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_y_reverse</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-61-5.png" width="672" /></p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="wykresy---pakiet-ggplot2.html#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb294-2"><a href="wykresy---pakiet-ggplot2.html#cb294-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Oś procentowa</span></span>
<span id="cb294-3"><a href="wykresy---pakiet-ggplot2.html#cb294-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dane1_1, <span class="fu">aes</span>(<span class="at">x =</span> pomiar))</span>
<span id="cb294-4"><a href="wykresy---pakiet-ggplot2.html#cb294-4" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> ((..count..)<span class="sc">/</span><span class="fu">sum</span>(..count..))))<span class="sc">+</span></span>
<span id="cb294-5"><a href="wykresy---pakiet-ggplot2.html#cb294-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent, <span class="at">name =</span> <span class="st">&quot;Procent komórek&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-61-6.png" width="672" /></p>
</div>
</div>
<div id="motyw-theme" class="section level2" number="5.7">
<h2><span class="header-section-number">5.7</span> Motyw (theme)</h2>
<p>W pakiecie ggplot2 jest dostępnych kilka różnych motywów. Domyślnie ustawiony jest <code>theme_grey</code>, inne dostępne to <code>theme_bw</code>, <code>theme_minimal</code>, <code>theme_classic</code>, <code>theme_linedraw</code>, <code>theme_light</code>. W pakiecie ggthemes znajdują się dodatkowe wersje motywów, nawet (o zgrozo) <code>theme_excel</code> ;) Inny pakiet zawierający gotowe motywy to ggthemr - można go pobrać z GitHub.</p>
<p>Tytuł do wykresu możemy dodać korzystając z funkcji <code>ggtitle</code>. Nazwy osi też można szybko zmienić przy pomocy <code>xlab</code> i <code>ylab</code>.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="wykresy---pakiet-ggplot2.html#cb295-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dane1, <span class="fu">aes</span>(<span class="at">x =</span> pomiar))</span>
<span id="cb295-2"><a href="wykresy---pakiet-ggplot2.html#cb295-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(warunki)), <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)<span class="sc">+</span></span>
<span id="cb295-3"><a href="wykresy---pakiet-ggplot2.html#cb295-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Szczep, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb295-4"><a href="wykresy---pakiet-ggplot2.html#cb295-4" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="wykresy---pakiet-ggplot2.html#cb296-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-62-2.png" width="672" /></p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="wykresy---pakiet-ggplot2.html#cb297-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-62-3.png" width="672" /></p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="wykresy---pakiet-ggplot2.html#cb298-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-62-4.png" width="672" /></p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="wykresy---pakiet-ggplot2.html#cb299-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Tytuł&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Rodzaj pomiaru&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-62-5.png" width="672" /></p>
<p>Legendę wykresu można modyfikować przy pomocy <code>guide_legend</code> wewnątrz funkcji <code>scale_fill_discrete</code> , <code>scale_colour_discrete</code> itp. Dostępne parametry to m.in. title, title.position, label.position, direction, nrow i ncol legendy. Modyfikacje są możliwe też bezpośrednio w funkcji <code>theme</code> albo samodzielnie ustawiając przez <code>scale_color_manual</code>.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="wykresy---pakiet-ggplot2.html#cb300-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_fill_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;Warunki&quot;</span>, </span>
<span id="cb300-2"><a href="wykresy---pakiet-ggplot2.html#cb300-2" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">title.position =</span> <span class="st">&quot;left&quot;</span>, </span>
<span id="cb300-3"><a href="wykresy---pakiet-ggplot2.html#cb300-3" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">label.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">ncol =</span> <span class="dv">2</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
<p>Można również modyfikować osobno każdy element wykresu np. czcionkę, kolor, linie, tło itd. przy pomocy funkcji <code>theme</code>, dużo przykładów znajduję się na <a href="http://docs.ggplot2.org/current/theme.html">stronie</a>.</p>
<p>Można modyfikować jednocześnie wszystkie elementy danego rodzaju np. tekst przy pomocy <code>text = element_text()</code> albo pojedyncze części wykresu np. tytuł - <code>plot.title=element_text()</code>.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="wykresy---pakiet-ggplot2.html#cb301-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">22</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="wykresy---pakiet-ggplot2.html#cb302-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Tytuł wykresu&quot;</span>)<span class="sc">+</span><span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb302-2"><a href="wykresy---pakiet-ggplot2.html#cb302-2" aria-hidden="true" tabindex="-1"></a>                                                           <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">30</span>, <span class="at">angle =</span> <span class="dv">350</span>, <span class="at">hjust =</span> <span class="fl">0.2</span>, <span class="at">vjust =</span> <span class="fl">0.8</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-64-2.png" width="672" /></p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="wykresy---pakiet-ggplot2.html#cb303-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;lightyellow&quot;</span>), </span>
<span id="cb303-2"><a href="wykresy---pakiet-ggplot2.html#cb303-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;snow4&quot;</span>),</span>
<span id="cb303-3"><a href="wykresy---pakiet-ggplot2.html#cb303-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue3&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-64-3.png" width="672" /></p>
<p>Jeżeli chcemy przygotować kilka pasujących do siebie wykresów możemy zapisać swój motyw i potem dodawać go do kolejnych wykresów.</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="wykresy---pakiet-ggplot2.html#cb304-1" aria-hidden="true" tabindex="-1"></a>motyw <span class="ot">&lt;-</span> <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;lightyellow&quot;</span>), </span>
<span id="cb304-2"><a href="wykresy---pakiet-ggplot2.html#cb304-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;snow4&quot;</span>),</span>
<span id="cb304-3"><a href="wykresy---pakiet-ggplot2.html#cb304-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue3&quot;</span>))</span>
<span id="cb304-4"><a href="wykresy---pakiet-ggplot2.html#cb304-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-5"><a href="wykresy---pakiet-ggplot2.html#cb304-5" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="wykresy---pakiet-ggplot2.html#cb305-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> motyw</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-65-2.png" width="672" /></p>
</div>
<div id="różne" class="section level2" number="5.8">
<h2><span class="header-section-number">5.8</span> Różne</h2>
<div id="łączenie-wykresów" class="section level3" number="5.8.1">
<h3><span class="header-section-number">5.8.1</span> Łączenie wykresów</h3>
<p>Pakiet ggplot2 jest oparty o system wyświetlania kontrolowany przez pakiet grid (inny niż grafika z podstawowego R). Korzystając z funkcji <code>viewport</code> można z dużą dokładnością rozmieścić kilka wykresów różnych rozmiarów obok siebie, jeden na drugim itp.</p>
<p>W funkcji <code>viewport</code> ustawiamy parametry <code>width</code> i <code>height</code> oznaczające wymiary wykresu. Wykres zajmujący całą powierzchnię ma wymiary 1x1 oraz <code>x</code> i <code>y</code> oznaczające współrzędne środka wykresu np. x=0.5, y=0.5 da wykres umiejscowiony na samym środku.</p>
<p>Dużo łatwiejszym sposobem jest wykorzystanie pakietu patchwork. Pozwala on na ułożenie wykresów na jednej stronie tlyko przy użyciu +, | i /. Można też dokładnie ustalać rozmieszczenie wykresów, więcej na stronie <a href="https://patchwork.data-imaginist.com/index.html">autora pakietu</a></p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="wykresy---pakiet-ggplot2.html#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Przypisujemy wykresy do zmiennych</span></span>
<span id="cb306-2"><a href="wykresy---pakiet-ggplot2.html#cb306-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-3"><a href="wykresy---pakiet-ggplot2.html#cb306-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>dane1, <span class="fu">aes</span>(<span class="at">x=</span>pomiar))</span>
<span id="cb306-4"><a href="wykresy---pakiet-ggplot2.html#cb306-4" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">color=</span>Szczep))<span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>warunki, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb306-5"><a href="wykresy---pakiet-ggplot2.html#cb306-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-6"><a href="wykresy---pakiet-ggplot2.html#cb306-6" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>summ, <span class="fu">aes</span>(<span class="at">x=</span>czas, <span class="at">y=</span>mean, <span class="at">color=</span>Szczep, <span class="at">fill=</span>Szczep))</span>
<span id="cb306-7"><a href="wykresy---pakiet-ggplot2.html#cb306-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p2 <span class="sc">+</span> <span class="fu">geom_line</span>()<span class="sc">+</span><span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lower, <span class="at">ymax=</span>upper),<span class="at">alpha=</span><span class="fl">0.25</span>)</span>
<span id="cb306-8"><a href="wykresy---pakiet-ggplot2.html#cb306-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-9"><a href="wykresy---pakiet-ggplot2.html#cb306-9" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(gear, disp, <span class="at">group =</span> gear))</span>
<span id="cb306-10"><a href="wykresy---pakiet-ggplot2.html#cb306-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-11"><a href="wykresy---pakiet-ggplot2.html#cb306-11" aria-hidden="true" tabindex="-1"></a><span class="co"># z wykorzytsaniem patchwork</span></span>
<span id="cb306-12"><a href="wykresy---pakiet-ggplot2.html#cb306-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-13"><a href="wykresy---pakiet-ggplot2.html#cb306-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb306-14"><a href="wykresy---pakiet-ggplot2.html#cb306-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-15"><a href="wykresy---pakiet-ggplot2.html#cb306-15" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-66-1.png" width="768" /></p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="wykresy---pakiet-ggplot2.html#cb307-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2 <span class="sc">/</span> p3</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-66-2.png" width="768" /></p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="wykresy---pakiet-ggplot2.html#cb308-1" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">|</span> p2 )<span class="sc">/</span> p3</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-66-3.png" width="768" /></p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="wykresy---pakiet-ggplot2.html#cb309-1" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">|</span> p2 )<span class="sc">/</span> p3 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&#39;collect&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-66-4.png" width="768" /></p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="wykresy---pakiet-ggplot2.html#cb310-1" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb310-2"><a href="wykresy---pakiet-ggplot2.html#cb310-2" aria-hidden="true" tabindex="-1"></a><span class="st">##BBBB</span></span>
<span id="cb310-3"><a href="wykresy---pakiet-ggplot2.html#cb310-3" aria-hidden="true" tabindex="-1"></a><span class="st">AACCCC</span></span>
<span id="cb310-4"><a href="wykresy---pakiet-ggplot2.html#cb310-4" aria-hidden="true" tabindex="-1"></a><span class="st">AACCCC</span></span>
<span id="cb310-5"><a href="wykresy---pakiet-ggplot2.html#cb310-5" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb310-6"><a href="wykresy---pakiet-ggplot2.html#cb310-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-7"><a href="wykresy---pakiet-ggplot2.html#cb310-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> </span>
<span id="cb310-8"><a href="wykresy---pakiet-ggplot2.html#cb310-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> layout)</span>
<span id="cb310-9"><a href="wykresy---pakiet-ggplot2.html#cb310-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-10"><a href="wykresy---pakiet-ggplot2.html#cb310-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Z wykorzystaniem pakietu grid</span></span>
<span id="cb310-11"><a href="wykresy---pakiet-ggplot2.html#cb310-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-12"><a href="wykresy---pakiet-ggplot2.html#cb310-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb310-13"><a href="wykresy---pakiet-ggplot2.html#cb310-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-14"><a href="wykresy---pakiet-ggplot2.html#cb310-14" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>))</span>
<span id="cb310-15"><a href="wykresy---pakiet-ggplot2.html#cb310-15" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p2 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb310-16"><a href="wykresy---pakiet-ggplot2.html#cb310-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-17"><a href="wykresy---pakiet-ggplot2.html#cb310-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Ustawiamy parametry viewportóW</span></span>
<span id="cb310-18"><a href="wykresy---pakiet-ggplot2.html#cb310-18" aria-hidden="true" tabindex="-1"></a>vp1 <span class="ot">&lt;-</span> <span class="fu">viewport</span>(<span class="at">width=</span><span class="dv">1</span>, <span class="at">height=</span><span class="fl">0.5</span>, <span class="at">x=</span><span class="fl">0.5</span>, <span class="at">y=</span><span class="fl">0.75</span>)</span>
<span id="cb310-19"><a href="wykresy---pakiet-ggplot2.html#cb310-19" aria-hidden="true" tabindex="-1"></a>vp2 <span class="ot">&lt;-</span> <span class="fu">viewport</span>(<span class="at">width=</span><span class="fl">0.4</span>, <span class="at">height=</span><span class="fl">0.5</span>, <span class="at">x=</span><span class="fl">0.2</span>, <span class="at">y=</span><span class="fl">0.25</span>)</span>
<span id="cb310-20"><a href="wykresy---pakiet-ggplot2.html#cb310-20" aria-hidden="true" tabindex="-1"></a>vp3 <span class="ot">&lt;-</span> <span class="fu">viewport</span>(<span class="at">width=</span><span class="fl">0.6</span>, <span class="at">height=</span><span class="fl">0.5</span>, <span class="at">x=</span><span class="fl">0.7</span>, <span class="at">y=</span><span class="fl">0.25</span>)</span>
<span id="cb310-21"><a href="wykresy---pakiet-ggplot2.html#cb310-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-22"><a href="wykresy---pakiet-ggplot2.html#cb310-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Wyświetlamy wykresy w ospowiednich viewportach</span></span>
<span id="cb310-23"><a href="wykresy---pakiet-ggplot2.html#cb310-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1, <span class="at">vp=</span>vp1)</span>
<span id="cb310-24"><a href="wykresy---pakiet-ggplot2.html#cb310-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2, <span class="at">vp=</span>vp2)</span>
<span id="cb310-25"><a href="wykresy---pakiet-ggplot2.html#cb310-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p3, <span class="at">vp=</span>vp3)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-66-5.png" width="768" /></p>
</div>
<div id="ten-sam-wykres-różne-dane" class="section level3" number="5.8.2">
<h3><span class="header-section-number">5.8.2</span> Ten sam wykres różne dane</h3>
<p>Istnieje kilka sposobów na przygotowanie kilku takich samych wykresów, różniących się jedynie danymi.</p>
<p>Można oczywiście ręcznie podmienić wartość parametru data na inny albo skorzystać z wbudowanego w pakiet ggplot2 operatora - <code>%+%</code>.</p>
<p>Alternatywą jest też napisanie własnej funkcji przygotowującej konkretny wykres. Zaletą tego rozwiązania jest możliwość wpisania do funkcji odpowiednich argumentów dostosowujących wykres do konkretnej sytuacji.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="wykresy---pakiet-ggplot2.html#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Przykładowe zestawy danych</span></span>
<span id="cb311-2"><a href="wykresy---pakiet-ggplot2.html#cb311-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>))</span>
<span id="cb311-3"><a href="wykresy---pakiet-ggplot2.html#cb311-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rlnorm</span>(<span class="dv">1000</span>))</span>
<span id="cb311-4"><a href="wykresy---pakiet-ggplot2.html#cb311-4" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">runif</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">5</span>))</span>
<span id="cb311-5"><a href="wykresy---pakiet-ggplot2.html#cb311-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-6"><a href="wykresy---pakiet-ggplot2.html#cb311-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Przygotujemy wykres składajacy się z kilku elementów dla danych a</span></span>
<span id="cb311-7"><a href="wykresy---pakiet-ggplot2.html#cb311-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-8"><a href="wykresy---pakiet-ggplot2.html#cb311-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> a, <span class="fu">aes</span>(<span class="at">x =</span> x))</span>
<span id="cb311-9"><a href="wykresy---pakiet-ggplot2.html#cb311-9" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.25</span>, <span class="at">fill =</span> <span class="st">&quot;blue4&quot;</span>, <span class="fu">aes</span>(<span class="at">y =</span> (..count..<span class="sc">/</span><span class="fu">sum</span>(..count..))))<span class="sc">+</span></span>
<span id="cb311-10"><a href="wykresy---pakiet-ggplot2.html#cb311-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent, <span class="at">name =</span> <span class="st">&quot;Procent&quot;</span>)<span class="sc">+</span></span>
<span id="cb311-11"><a href="wykresy---pakiet-ggplot2.html#cb311-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Wartość&quot;</span>)<span class="sc">+</span></span>
<span id="cb311-12"><a href="wykresy---pakiet-ggplot2.html#cb311-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Przykładowy rozkład&quot;</span>)<span class="sc">+</span></span>
<span id="cb311-13"><a href="wykresy---pakiet-ggplot2.html#cb311-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background=</span><span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>), <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>), </span>
<span id="cb311-14"><a href="wykresy---pakiet-ggplot2.html#cb311-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;red4&quot;</span>))</span>
<span id="cb311-15"><a href="wykresy---pakiet-ggplot2.html#cb311-15" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-67-1.png" width="288" /></p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="wykresy---pakiet-ggplot2.html#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="co"># taki sam wykres dla danych b</span></span>
<span id="cb312-2"><a href="wykresy---pakiet-ggplot2.html#cb312-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-3"><a href="wykresy---pakiet-ggplot2.html#cb312-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">%+%</span> b</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-67-2.png" width="288" /></p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="wykresy---pakiet-ggplot2.html#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="co"># i c ;)</span></span>
<span id="cb313-2"><a href="wykresy---pakiet-ggplot2.html#cb313-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-3"><a href="wykresy---pakiet-ggplot2.html#cb313-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">%+%</span> c</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-67-3.png" width="288" /></p>
</div>
</div>
<div id="rozszeżenia-ggplot2" class="section level2" number="5.9">
<h2><span class="header-section-number">5.9</span> Rozszeżenia ggplot2</h2>
<p>W ostatnich latatach powstało bardzo wiele pakietów rozbudowujących możliwości ggplot2. Część z nich została już wspomniana wcześniej np. ggbeeswarm lub patchwork. Tutaj znajdą się inne, które również mogą okazać się przydatne. Większość dobrze udokumentowanych pakietów można znaleźć na stronie <a href="https://exts.ggplot2.tidyverse.org/gallery/">ggplot2 extensions - gallery</a>.</p>
<div id="pakiet-ggally" class="section level3" number="5.9.1">
<h3><span class="header-section-number">5.9.1</span> Pakiet GGally</h3>
<p>Pakiet GGally stanowi rozszeżenie ggplot2, zawiera kilka szablonóe i pozwala na stworzenie wykresów niedostępnych w wersji podstawowej np. macierz korelacji, wykres pokazujący sieć albo macierz wykresów dla ramki danych.</p>
<div id="macierz-wykresów---ggpairs" class="section level4" number="5.9.1.1">
<h4><span class="header-section-number">5.9.1.1</span> Macierz wykresów - ggpairs</h4>
<p>Funkcja <code>ggpairs</code> pozwala na szybką analizę danych. Jej argumentem jest ramka danych i dla każdej pary zmiennych zostanie narysowany wykres pozkazujący zalezność pomiędzy nimi. Wykresy są inne w zależności od rodzaju zmiennych - liczbowe lub kategoryczne. Dla pary zmiennych liczbowych zostanie narysowany wykres rozrzutu i obliczony współczynnik korelacji. Dla pary mieszanej (liczbowo-kategoryczna) narysuje wykres pudełkowy i histogram, dla dwóch zmiennych kategorycznych wykresy słupkowe. Rodzaje rysowanych wykresów można zmieniać, można też do macierzy dodać własny wykres.</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="wykresy---pakiet-ggplot2.html#cb314-1" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">liczb_1 =</span> <span class="fu">sort</span>(<span class="fu">rnorm</span>(<span class="dv">300</span>, <span class="dv">2</span>)), <span class="at">liczb_2 =</span> <span class="fu">sort</span>(<span class="fu">rlnorm</span>(<span class="dv">300</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)),</span>
<span id="cb314-2"><a href="wykresy---pakiet-ggplot2.html#cb314-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">kategoria_1 =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>), <span class="at">each=</span><span class="dv">100</span>), </span>
<span id="cb314-3"><a href="wykresy---pakiet-ggplot2.html#cb314-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">kategoria_2 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;Tak&quot;</span>,<span class="st">&quot;Nie&quot;</span>),<span class="dv">300</span>, <span class="at">replace=</span><span class="cn">TRUE</span>))</span>
<span id="cb314-4"><a href="wykresy---pakiet-ggplot2.html#cb314-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-5"><a href="wykresy---pakiet-ggplot2.html#cb314-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code></pre></div>
<pre><code>## Registered S3 method overwritten by &#39;GGally&#39;:
##   method from   
##   +.gg   ggplot2</code></pre>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="wykresy---pakiet-ggplot2.html#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(dane)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="wykresy---pakiet-ggplot2.html#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="co"># zmiana rodzaju wykresu np. górny panel pokaże wykres gęstości zamiast korelacji  </span></span>
<span id="cb319-2"><a href="wykresy---pakiet-ggplot2.html#cb319-2" aria-hidden="true" tabindex="-1"></a><span class="co"># i kropkowy zamiast boxplota</span></span>
<span id="cb319-3"><a href="wykresy---pakiet-ggplot2.html#cb319-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(dane, <span class="at">upper=</span><span class="fu">list</span>(<span class="at">continuous=</span><span class="st">&quot;density&quot;</span>, <span class="at">combo=</span><span class="st">&quot;dot&quot;</span>))</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-68-2.png" width="672" /></p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="wykresy---pakiet-ggplot2.html#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wykres pokolorowany według jednej z kategorii</span></span>
<span id="cb321-2"><a href="wykresy---pakiet-ggplot2.html#cb321-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-3"><a href="wykresy---pakiet-ggplot2.html#cb321-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(dane, <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">color=</span>kategoria_1))</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-68-3.png" width="672" /></p>
</div>
<div id="macierz-korelacji" class="section level4" number="5.9.1.2">
<h4><span class="header-section-number">5.9.1.2</span> Macierz korelacji</h4>
<p>Tworzenie macierzy korelacji jest opisane w dalszej części z wykorzystaniem pakietu corrplot, ale możliwe jest też użycie ggplot2.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="wykresy---pakiet-ggplot2.html#cb323-1" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a=</span><span class="fu">sort</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>)), <span class="at">b=</span><span class="fu">sort</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>)), <span class="at">c=</span><span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="at">d=</span><span class="fu">rlnorm</span>(<span class="dv">100</span>), <span class="at">e=</span><span class="fu">runif</span>(<span class="dv">100</span>),</span>
<span id="cb323-2"><a href="wykresy---pakiet-ggplot2.html#cb323-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">f=</span><span class="fu">sort</span>(<span class="fu">runif</span>(<span class="dv">100</span>)), <span class="at">g=</span><span class="fu">sort</span>(<span class="fu">rexp</span>(<span class="dv">100</span>), <span class="at">decreasing=</span><span class="cn">TRUE</span>))</span>
<span id="cb323-3"><a href="wykresy---pakiet-ggplot2.html#cb323-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-4"><a href="wykresy---pakiet-ggplot2.html#cb323-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorr</span>(dane)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="wykresy---pakiet-ggplot2.html#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="co"># z wpisanymi wartościami korelacji</span></span>
<span id="cb324-2"><a href="wykresy---pakiet-ggplot2.html#cb324-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-3"><a href="wykresy---pakiet-ggplot2.html#cb324-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorr</span>(dane, <span class="at">label=</span><span class="cn">TRUE</span>, <span class="at">label_color=</span><span class="st">&quot;black&quot;</span>, <span class="at">label_round=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-69-2.png" width="672" /></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="analiza-i-transformacja-danych.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="wykresy---pakiet-podstawowy.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/06-ggplot.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
