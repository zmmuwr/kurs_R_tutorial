<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Analiza i transformacja danych | Kurs R - Tutorial</title>
  <meta name="description" content="Pomoc do kursu R - zawiera przykłady użycia języka R do analizy i wizualizacji danych głównie przy użyciu pakietów tidyverse" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Analiza i transformacja danych | Kurs R - Tutorial" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Pomoc do kursu R - zawiera przykłady użycia języka R do analizy i wizualizacji danych głównie przy użyciu pakietów tidyverse" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Analiza i transformacja danych | Kurs R - Tutorial" />
  
  <meta name="twitter:description" content="Pomoc do kursu R - zawiera przykłady użycia języka R do analizy i wizualizacji danych głównie przy użyciu pakietów tidyverse" />
  

<meta name="author" content="Agnieszka Strzałka" />


<meta name="date" content="2021-08-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dane.html"/>
<link rel="next" href="wykresy---pakiet-ggplot2.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Pomoc do kursu R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Wstęp</a></li>
<li class="chapter" data-level="2" data-path="skąd-ściągnąć-r.html"><a href="skąd-ściągnąć-r.html"><i class="fa fa-check"></i><b>2</b> Skąd ściągnąć R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="skąd-ściągnąć-r.html"><a href="skąd-ściągnąć-r.html#pomoc"><i class="fa fa-check"></i><b>2.1</b> Pomoc</a></li>
<li class="chapter" data-level="2.2" data-path="skąd-ściągnąć-r.html"><a href="skąd-ściągnąć-r.html#packages"><i class="fa fa-check"></i><b>2.2</b> Packages</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="skąd-ściągnąć-r.html"><a href="skąd-ściągnąć-r.html#lista-pakietów-które-pojawiają-się-w-książce-uwaga-może-być-niekompletna"><i class="fa fa-check"></i><b>2.2.1</b> Lista pakietów, które pojawiają się w książce (uwaga może być niekompletna)</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="skąd-ściągnąć-r.html"><a href="skąd-ściągnąć-r.html#r-studio"><i class="fa fa-check"></i><b>2.3</b> R Studio</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dane.html"><a href="dane.html"><i class="fa fa-check"></i><b>3</b> Dane</a>
<ul>
<li class="chapter" data-level="3.1" data-path="dane.html"><a href="dane.html#wczytanie-danych"><i class="fa fa-check"></i><b>3.1</b> Wczytanie danych</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="dane.html"><a href="dane.html#wczytanie-danych-z-plików-tekstowych"><i class="fa fa-check"></i><b>3.1.1</b> Wczytanie danych z plików tekstowych</a></li>
<li class="chapter" data-level="3.1.2" data-path="dane.html"><a href="dane.html#wczytanie-danych-z-plików-excel"><i class="fa fa-check"></i><b>3.1.2</b> Wczytanie danych z plików excel</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="dane.html"><a href="dane.html#zapisanie-danych"><i class="fa fa-check"></i><b>3.2</b> Zapisanie danych</a></li>
<li class="chapter" data-level="3.3" data-path="dane.html"><a href="dane.html#podstawowe-typy-danych-w-r"><i class="fa fa-check"></i><b>3.3</b> Podstawowe typy danych w R</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="dane.html"><a href="dane.html#wektor-vector"><i class="fa fa-check"></i><b>3.3.1</b> Wektor (vector)</a></li>
<li class="chapter" data-level="3.3.2" data-path="dane.html"><a href="dane.html#ramka-danych-data-frame"><i class="fa fa-check"></i><b>3.3.2</b> Ramka danych (data frame)</a></li>
<li class="chapter" data-level="3.3.3" data-path="dane.html"><a href="dane.html#matryca-matrix"><i class="fa fa-check"></i><b>3.3.3</b> Matryca (matrix)</a></li>
<li class="chapter" data-level="3.3.4" data-path="dane.html"><a href="dane.html#lista-list"><i class="fa fa-check"></i><b>3.3.4</b> Lista (list)</a></li>
<li class="chapter" data-level="3.3.5" data-path="dane.html"><a href="dane.html#typ-liczbowy-numeric-znakowy-character-logiczny-logical"><i class="fa fa-check"></i><b>3.3.5</b> Typ liczbowy (numeric), znakowy (character), logiczny (logical)</a></li>
<li class="chapter" data-level="3.3.6" data-path="dane.html"><a href="dane.html#typ-czynnikowy-factor"><i class="fa fa-check"></i><b>3.3.6</b> Typ czynnikowy (factor)</a></li>
<li class="chapter" data-level="3.3.7" data-path="dane.html"><a href="dane.html#funkcje"><i class="fa fa-check"></i><b>3.3.7</b> Funkcje</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="analiza-i-transformacja-danych.html"><a href="analiza-i-transformacja-danych.html"><i class="fa fa-check"></i><b>4</b> Analiza i transformacja danych</a>
<ul>
<li class="chapter" data-level="4.1" data-path="analiza-i-transformacja-danych.html"><a href="analiza-i-transformacja-danych.html#format-uporządkowany-wąski"><i class="fa fa-check"></i><b>4.1</b> Format uporządkowany (wąski)</a></li>
<li class="chapter" data-level="4.2" data-path="analiza-i-transformacja-danych.html"><a href="analiza-i-transformacja-danych.html#pipes-potoki"><i class="fa fa-check"></i><b>4.2</b> Pipes (potoki)</a></li>
<li class="chapter" data-level="4.3" data-path="analiza-i-transformacja-danych.html"><a href="analiza-i-transformacja-danych.html#sortowanie"><i class="fa fa-check"></i><b>4.3</b> Sortowanie</a></li>
<li class="chapter" data-level="4.4" data-path="analiza-i-transformacja-danych.html"><a href="analiza-i-transformacja-danych.html#filtrowanie"><i class="fa fa-check"></i><b>4.4</b> Filtrowanie</a></li>
<li class="chapter" data-level="4.5" data-path="analiza-i-transformacja-danych.html"><a href="analiza-i-transformacja-danych.html#grupowanie-i-obliczanie-nowych-zmiennych"><i class="fa fa-check"></i><b>4.5</b> Grupowanie i obliczanie nowych zmiennych</a></li>
<li class="chapter" data-level="4.6" data-path="analiza-i-transformacja-danych.html"><a href="analiza-i-transformacja-danych.html#łączenie-tabel"><i class="fa fa-check"></i><b>4.6</b> Łączenie tabel</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html"><i class="fa fa-check"></i><b>5</b> Wykresy - pakiet ggplot2</a>
<ul>
<li class="chapter" data-level="5.1" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#używane-dane"><i class="fa fa-check"></i><b>5.1</b> Używane dane</a></li>
<li class="chapter" data-level="5.2" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#histogram-boxplot-i-inne"><i class="fa fa-check"></i><b>5.2</b> Histogram, boxplot i inne</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#histogram-i-density"><i class="fa fa-check"></i><b>5.2.1</b> Histogram i density</a></li>
<li class="chapter" data-level="5.2.2" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#wykres-pudełkowy---boxplot"><i class="fa fa-check"></i><b>5.2.2</b> Wykres pudełkowy - boxplot</a></li>
<li class="chapter" data-level="5.2.3" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#wykres-skrzypcowy"><i class="fa fa-check"></i><b>5.2.3</b> Wykres skrzypcowy</a></li>
<li class="chapter" data-level="5.2.4" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#dodanie-wszystkich-obserwacji-do-boxplotviolin"><i class="fa fa-check"></i><b>5.2.4</b> Dodanie wszystkich obserwacji do boxplot/violin</a></li>
<li class="chapter" data-level="5.2.5" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#dotplot"><i class="fa fa-check"></i><b>5.2.5</b> Dotplot</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#barplot---wykres-słupkowy"><i class="fa fa-check"></i><b>5.3</b> Barplot - wykres słupkowy</a></li>
<li class="chapter" data-level="5.4" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#średnia-mediana-itp.-na-wykresie"><i class="fa fa-check"></i><b>5.4</b> Średnia, mediana itp. na wykresie</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#stat_summary"><i class="fa fa-check"></i><b>5.4.1</b> Stat_summary</a></li>
<li class="chapter" data-level="5.4.2" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#summary-z-użyciem-dplyr"><i class="fa fa-check"></i><b>5.4.2</b> Summary z użyciem dplyr</a></li>
<li class="chapter" data-level="5.4.3" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#słupki-błędów"><i class="fa fa-check"></i><b>5.4.3</b> Słupki błędów</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#wykres-punktowy-i-liniowy"><i class="fa fa-check"></i><b>5.5</b> Wykres punktowy i liniowy</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#dopasowanie-linii-trendu-do-wykresu-punktowego"><i class="fa fa-check"></i><b>5.5.1</b> Dopasowanie linii trendu do wykresu punktowego</a></li>
<li class="chapter" data-level="5.5.2" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#jak-poradzić-sobie-z-nadmiarem-punktów-na-wykresie-overplotting"><i class="fa fa-check"></i><b>5.5.2</b> Jak poradzić sobie z nadmiarem punktów na wykresie (overplotting)?</a></li>
<li class="chapter" data-level="5.5.3" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#wykres-wstążka-ribbon"><i class="fa fa-check"></i><b>5.5.3</b> Wykres wstążka (ribbon)</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#kolory-osie-panele"><i class="fa fa-check"></i><b>5.6</b> Kolory, osie, panele</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#porównywanie---fill-color-shape"><i class="fa fa-check"></i><b>5.6.1</b> Porównywanie - fill, color, shape</a></li>
<li class="chapter" data-level="5.6.2" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#zmiana-skali-kolorów"><i class="fa fa-check"></i><b>5.6.2</b> Zmiana skali kolorów</a></li>
<li class="chapter" data-level="5.6.3" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#podział-wykresu-na-panele"><i class="fa fa-check"></i><b>5.6.3</b> Podział wykresu na panele</a></li>
<li class="chapter" data-level="5.6.4" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#zmiana-skali-osi-obracanie-wykresu"><i class="fa fa-check"></i><b>5.6.4</b> Zmiana skali, osi, obracanie wykresu</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#motyw-theme"><i class="fa fa-check"></i><b>5.7</b> Motyw (theme)</a></li>
<li class="chapter" data-level="5.8" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#różne"><i class="fa fa-check"></i><b>5.8</b> Różne</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#łączenie-wykresów"><i class="fa fa-check"></i><b>5.8.1</b> Łączenie wykresów</a></li>
<li class="chapter" data-level="5.8.2" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#ten-sam-wykres-różne-dane"><i class="fa fa-check"></i><b>5.8.2</b> Ten sam wykres różne dane</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#rozszeżenia-ggplot2"><i class="fa fa-check"></i><b>5.9</b> Rozszeżenia ggplot2</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="wykresy---pakiet-ggplot2.html"><a href="wykresy---pakiet-ggplot2.html#pakiet-ggally"><i class="fa fa-check"></i><b>5.9.1</b> Pakiet GGally</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="wykresy---pakiet-podstawowy.html"><a href="wykresy---pakiet-podstawowy.html"><i class="fa fa-check"></i><b>6</b> Wykresy - pakiet podstawowy</a>
<ul>
<li class="chapter" data-level="6.1" data-path="wykresy---pakiet-podstawowy.html"><a href="wykresy---pakiet-podstawowy.html#histogram---hist"><i class="fa fa-check"></i><b>6.1</b> Histogram - hist</a></li>
<li class="chapter" data-level="6.2" data-path="wykresy---pakiet-podstawowy.html"><a href="wykresy---pakiet-podstawowy.html#wykres-rozrzutu---plot"><i class="fa fa-check"></i><b>6.2</b> Wykres rozrzutu - plot</a></li>
<li class="chapter" data-level="6.3" data-path="wykresy---pakiet-podstawowy.html"><a href="wykresy---pakiet-podstawowy.html#wykres-pudełkowy---boxplot-1"><i class="fa fa-check"></i><b>6.3</b> Wykres pudełkowy - boxplot</a></li>
<li class="chapter" data-level="6.4" data-path="wykresy---pakiet-podstawowy.html"><a href="wykresy---pakiet-podstawowy.html#wykres-słupkowy---barplot"><i class="fa fa-check"></i><b>6.4</b> Wykres słupkowy - barplot</a></li>
<li class="chapter" data-level="6.5" data-path="wykresy---pakiet-podstawowy.html"><a href="wykresy---pakiet-podstawowy.html#wykres-mozaikowy---mosaicplot"><i class="fa fa-check"></i><b>6.5</b> Wykres mozaikowy - mosaicplot</a></li>
<li class="chapter" data-level="6.6" data-path="wykresy---pakiet-podstawowy.html"><a href="wykresy---pakiet-podstawowy.html#wykres-kwantylowy---qqplot"><i class="fa fa-check"></i><b>6.6</b> Wykres kwantylowy - qqPlot</a></li>
<li class="chapter" data-level="6.7" data-path="wykresy---pakiet-podstawowy.html"><a href="wykresy---pakiet-podstawowy.html#diagram-venna"><i class="fa fa-check"></i><b>6.7</b> Diagram venna</a></li>
<li class="chapter" data-level="6.8" data-path="wykresy---pakiet-podstawowy.html"><a href="wykresy---pakiet-podstawowy.html#wykres-korelacji---corrplot"><i class="fa fa-check"></i><b>6.8</b> Wykres korelacji - corrplot</a></li>
<li class="chapter" data-level="6.9" data-path="wykresy---pakiet-podstawowy.html"><a href="wykresy---pakiet-podstawowy.html#clustering---analiza-skupień"><i class="fa fa-check"></i><b>6.9</b> Clustering - analiza skupień</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="statystyka.html"><a href="statystyka.html"><i class="fa fa-check"></i><b>7</b> Statystyka</a>
<ul>
<li class="chapter" data-level="7.1" data-path="statystyka.html"><a href="statystyka.html#podstawowe-statystyki-opisowe"><i class="fa fa-check"></i><b>7.1</b> Podstawowe statystyki opisowe</a></li>
<li class="chapter" data-level="7.2" data-path="statystyka.html"><a href="statystyka.html#liczby-pseudolosowe"><i class="fa fa-check"></i><b>7.2</b> Liczby pseudolosowe</a></li>
<li class="chapter" data-level="7.3" data-path="statystyka.html"><a href="statystyka.html#podstawowe-testy-statystyczne"><i class="fa fa-check"></i><b>7.3</b> Podstawowe testy statystyczne</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="statystyka.html"><a href="statystyka.html#test-t-studenta---weryfikacja-równości-średnich"><i class="fa fa-check"></i><b>7.3.1</b> Test t-studenta - weryfikacja równości średnich</a></li>
<li class="chapter" data-level="7.3.2" data-path="statystyka.html"><a href="statystyka.html#test-f---weryfikacja-równości-wariancji"><i class="fa fa-check"></i><b>7.3.2</b> Test F - weryfikacja równości wariancji</a></li>
<li class="chapter" data-level="7.3.3" data-path="statystyka.html"><a href="statystyka.html#testowanie-zgodności-z-rozkładem-normalnym-i-dopasowywanie-parametrów-rozkładu"><i class="fa fa-check"></i><b>7.3.3</b> Testowanie zgodności z rozkładem normalnym i dopasowywanie parametrów rozkładu</a></li>
<li class="chapter" data-level="7.3.4" data-path="statystyka.html"><a href="statystyka.html#obliczanie-przedziałów-ufności-dla-średniej-i-błędu-standardowego"><i class="fa fa-check"></i><b>7.3.4</b> Obliczanie przedziałów ufności dla średniej i błędu standardowego</a></li>
<li class="chapter" data-level="7.3.5" data-path="statystyka.html"><a href="statystyka.html#testowanie-korelacji"><i class="fa fa-check"></i><b>7.3.5</b> Testowanie korelacji</a></li>
<li class="chapter" data-level="7.3.6" data-path="statystyka.html"><a href="statystyka.html#test-chi-kwadrat---zgodność-rozkładu-zmiennych-jakościowych"><i class="fa fa-check"></i><b>7.3.6</b> Test chi-kwadrat - zgodność rozkładu zmiennych jakościowych</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="statystyka.html"><a href="statystyka.html#modelowanie---czyli-jak-dopasować-linię-trendu"><i class="fa fa-check"></i><b>7.4</b> Modelowanie - czyli jak dopasować linię trendu</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="statystyka.html"><a href="statystyka.html#regresja-liniowa"><i class="fa fa-check"></i><b>7.4.1</b> Regresja liniowa</a></li>
<li class="chapter" data-level="7.4.2" data-path="statystyka.html"><a href="statystyka.html#zmienne-jakościowe-w-modelu"><i class="fa fa-check"></i><b>7.4.2</b> Zmienne jakościowe w modelu</a></li>
<li class="chapter" data-level="7.4.3" data-path="statystyka.html"><a href="statystyka.html#pakiet-drc---dose-response-models"><i class="fa fa-check"></i><b>7.4.3</b> Pakiet drc - dose response models</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="statystyka.html"><a href="statystyka.html#analiza-anova"><i class="fa fa-check"></i><b>7.5</b> Analiza ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="miscellaneous.html"><a href="miscellaneous.html"><i class="fa fa-check"></i><b>8</b> Miscellaneous</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Kurs R - Tutorial</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analiza-i-transformacja-danych" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Analiza i transformacja danych</h1>
<p>W tym rozdziale zostaną przedstawione metody transformacji danych wykorzystujące tidyverse, a konkretnie pakiety dplyr i tidyr. Większość z przedstawionych operacji może być też przeprowadzona przy pomocy funkcji pakietu podstawowego albo pakietu data.table, który jest szczególnie dedykowany do bardzo dużych zbiorów danych.</p>
<p>Typowa praca z danymi w R zwykle obejmuje kilka podstawowych zadań:
* zmiana formatu na uporządkowany - pakiet tidyr - <code>pivot_longer</code>, <code>pivot_wider</code>
* sortowanie - <code>arrange</code>, <code>relocate</code>
* filtrowanie - <code>filter</code>, <code>select</code>, <code>distinct</code>, <code>slice_*</code>
* podział na grupy - <code>group_by</code>
* obliczanie nowych zmiennych - <code>mutate</code>, <code>select</code>
* łączenie tabel - <code>*_join</code>, <code>bind_rows</code>, <code>bind_cols</code></p>
<div id="format-uporządkowany-wąski" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Format uporządkowany (wąski)</h2>
<p>Żeby wykorzystać pełnię możliwości pakietów dplyr i ggplot2 format danych powinien zostać zmieniony na uporządkowany (ang. tidy albo long). Brzmi to może skomplikowanie, ale sprowadza sie do dwóch prostych zasad:
1. Każda zmienna znajduje się w osobnej kolumnie np. długość, waga, szczep, rok itp.
2. Każdy przypadek znajduje się w osobnym rzędzie np. komórka, osoba, białko itp.</p>
<p>Przykład danych nieuporządkowanych (szerokie) - każda kolumna to pomiar długości dla innego szczepu</p>
<table>
<thead>
<tr class="header">
<th>szczep_1</th>
<th>szczep_2</th>
<th>szczep_3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>10</td>
<td>2</td>
</tr>
<tr class="even">
<td>3</td>
<td>15</td>
<td>4</td>
</tr>
<tr class="odd">
<td>2</td>
<td>11</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>Te same dane, ale uporządkowane (wąskie)</p>
<table>
<thead>
<tr class="header">
<th>szczep</th>
<th>dlugosc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>szczep_1</td>
<td>1</td>
</tr>
<tr class="even">
<td>szczep_1</td>
<td>3</td>
</tr>
<tr class="odd">
<td>szczep_1</td>
<td>2</td>
</tr>
<tr class="even">
<td>szczep_2</td>
<td>10</td>
</tr>
<tr class="odd">
<td>szczep_2</td>
<td>15</td>
</tr>
<tr class="even">
<td>szczep_2</td>
<td>11</td>
</tr>
<tr class="odd">
<td>szczep_3</td>
<td>2</td>
</tr>
<tr class="even">
<td>szczep_3</td>
<td>4</td>
</tr>
<tr class="odd">
<td>szczep_3</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>Pakiet tidyr zawiera dwie funkcje, które pozwalają na łatwy przejście pomiędzy danymi szerokimi a wąskimi: <code>pivot_wider</code>, <code>pivot_longer</code>.</p>
<p>Argumenty pivot_longer()
* data - podstawowy - ramka danych którą chcemy zmienić
* cols - które kolumny będą zmieniane: mamy różne opcje: everything() - wszystkie kolumny, c(‘nazwa_1,’ ‘nazwa_2’) - podajemy nazwy kolumn po przecinku, !nazwa_3 - po ! podajemy nazwę kolumny która ma pozostać niezmieniona. Jeżeli kolumny do zmiany mają wspólny początek nazwy możemy użyć starts_with(‘wspólna_część’)
* names_to - nazwa kolumny w której znajdą się poprzednia nazwy kolumn
* values_to - nazwa kolumny, w której znajdą się wartości</p>
<p>Warto zwrócić uwagę, że funkcje tidyr zawsze zwracają tibble zamiast zwykłej ramki danych.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="analiza-i-transformacja-danych.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb103-2"><a href="analiza-i-transformacja-danych.html#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="analiza-i-transformacja-danych.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># zmiana wszystkich kolumn - najprostszy przypadek</span></span>
<span id="cb107-2"><a href="analiza-i-transformacja-danych.html#cb107-2" aria-hidden="true" tabindex="-1"></a>mock_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">A =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="at">B =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="at">C =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>))</span>
<span id="cb107-3"><a href="analiza-i-transformacja-danych.html#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mock_data)</span></code></pre></div>
<pre><code>##            A          B          C
## 1 -1.9253865  0.9384206 -1.2754825
## 2 -0.3097715  0.8792462  1.3438799
## 3 -1.7869277 -0.8623875 -0.3378177
## 4 -0.3274623  0.1014223 -1.5603807
## 5  0.2832457 -0.7557189 -0.2082170
## 6 -0.1851464  0.8574634 -0.9259275</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="analiza-i-transformacja-danych.html#cb109-1" aria-hidden="true" tabindex="-1"></a>mock_data_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(mock_data, <span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&#39;key&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;value&#39;</span>)</span>
<span id="cb109-2"><a href="analiza-i-transformacja-danych.html#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mock_data_long)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##   key    value
##   &lt;chr&gt;  &lt;dbl&gt;
## 1 A     -1.93 
## 2 B      0.938
## 3 C     -1.28 
## 4 A     -0.310
## 5 B      0.879
## 6 C      1.34</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="analiza-i-transformacja-danych.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># i z powrotem</span></span>
<span id="cb111-2"><a href="analiza-i-transformacja-danych.html#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_wider</span>(mock_data_long, <span class="at">names_from =</span> key, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span> <span class="fu">unnest</span>() <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## Warning: Values are not uniquely identified; output will contain list-cols.
## * Use `values_fn = list` to suppress this warning.
## * Use `values_fn = length` to identify where the duplicates arise
## * Use `values_fn = {summary_fun}` to summarise duplicates</code></pre>
<pre><code>## Warning: `cols` is now required when using unnest().
## Please use `cols = c(A, B, C)`</code></pre>
<pre><code>## # A tibble: 6 × 3
##        A      B      C
##    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 -1.93   0.938 -1.28 
## 2 -0.310  0.879  1.34 
## 3 -1.79  -0.862 -0.338
## 4 -0.327  0.101 -1.56 
## 5  0.283 -0.756 -0.208
## 6 -0.185  0.857 -0.926</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="analiza-i-transformacja-danych.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># zmiana tylko częsci kolumn - argumencie cols można podać numery kolumn, nazwy albo </span></span>
<span id="cb115-2"><a href="analiza-i-transformacja-danych.html#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="co"># użyć funkcji pomocniczych dplyr np. starts_with()</span></span>
<span id="cb115-3"><a href="analiza-i-transformacja-danych.html#cb115-3" aria-hidden="true" tabindex="-1"></a>mock_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">A =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="at">B =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="at">C =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb115-4"><a href="analiza-i-transformacja-danych.html#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mock_data)</span></code></pre></div>
<pre><code>##             A          B             C id
## 1 -0.81097922 -0.5591041  0.2276615187  1
## 2 -1.93052568  0.9315119  0.0458679047  2
## 3  0.76224863 -0.5964077  0.0875130503  3
## 4  0.07097432  1.2933894  0.8103638296  4
## 5  1.77204725 -0.3455193 -0.3219783950  5
## 6 -0.40527091  0.5516613 -0.0009736571  6</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="analiza-i-transformacja-danych.html#cb117-1" aria-hidden="true" tabindex="-1"></a>mock_data_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(mock_data, <span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">names_to =</span> <span class="st">&#39;key&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;value&#39;</span>)</span>
<span id="cb117-2"><a href="analiza-i-transformacja-danych.html#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mock_data_long)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##      id key     value
##   &lt;int&gt; &lt;chr&gt;   &lt;dbl&gt;
## 1     1 A     -0.811 
## 2     1 B     -0.559 
## 3     1 C      0.228 
## 4     2 A     -1.93  
## 5     2 B      0.932 
## 6     2 C      0.0459</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="analiza-i-transformacja-danych.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># i z powrotem</span></span>
<span id="cb119-2"><a href="analiza-i-transformacja-danych.html#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_wider</span>(mock_data_long, <span class="at">names_from =</span> key, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##      id       A      B         C
##   &lt;int&gt;   &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;
## 1     1 -0.811  -0.559  0.228   
## 2     2 -1.93    0.932  0.0459  
## 3     3  0.762  -0.596  0.0875  
## 4     4  0.0710  1.29   0.810   
## 5     5  1.77   -0.346 -0.322   
## 6     6 -0.405   0.552 -0.000974</code></pre>
</div>
<div id="pipes-potoki" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Pipes (potoki)</h2>
<p>W R funkcje można łączyć w potoki przy pomocy operatora %&gt;% (pakiet magrittr) albo |&gt; (w podstawowym R od wersji 4.1.0).</p>
<p>Pipes można rozumieć jako zestaw instrukcji dla R, które zostaną wykonane po kolei. Kolejne funkcje połączone są %&gt;%, co sprawia że wynik pierwszej funkcji jest przekazywany do następnej, zawsze jako pierwszy argument i tak dalej aż do końca potoku. Zaletą takiego podejścia jest brak konieczności tworzenia zmiennych pośrednich oraz większa czytelność kodu.</p>
<p>Na podstawie przykładu powyżej</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="analiza-i-transformacja-danych.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pipes</span></span>
<span id="cb121-2"><a href="analiza-i-transformacja-danych.html#cb121-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-3"><a href="analiza-i-transformacja-danych.html#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_wider</span>(mock_data_long, <span class="at">names_from =</span> key, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span> <span class="fu">unnest</span>() <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Warning: `cols` is now required when using unnest().
## Please use `cols = c()`</code></pre>
<pre><code>## # A tibble: 3 × 4
##      id      A      B      C
##   &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1     1 -0.811 -0.559 0.228 
## 2     2 -1.93   0.932 0.0459
## 3     3  0.762 -0.596 0.0875</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="analiza-i-transformacja-danych.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># zmienne pośrednie</span></span>
<span id="cb124-2"><a href="analiza-i-transformacja-danych.html#cb124-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-3"><a href="analiza-i-transformacja-danych.html#cb124-3" aria-hidden="true" tabindex="-1"></a>zmienna_1 <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(mock_data_long, <span class="at">names_from =</span> key, <span class="at">values_from =</span> value) </span>
<span id="cb124-4"><a href="analiza-i-transformacja-danych.html#cb124-4" aria-hidden="true" tabindex="-1"></a>zmienna_2 <span class="ot">&lt;-</span> <span class="fu">unnest</span>(zmienna_1)</span></code></pre></div>
<pre><code>## Warning: `cols` is now required when using unnest().
## Please use `cols = c()`</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="analiza-i-transformacja-danych.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(zmienna_2, <span class="at">n =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 4
##      id      A      B      C
##   &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1     1 -0.811 -0.559 0.228 
## 2     2 -1.93   0.932 0.0459
## 3     3  0.762 -0.596 0.0875</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="analiza-i-transformacja-danych.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># funkcja w funkcji - nieczytelny kod</span></span>
<span id="cb128-2"><a href="analiza-i-transformacja-danych.html#cb128-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3"><a href="analiza-i-transformacja-danych.html#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">unnest</span>(<span class="fu">pivot_wider</span>(mock_data_long, <span class="at">names_from =</span> key, <span class="at">values_from =</span> value)), <span class="at">n =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Warning: `cols` is now required when using unnest().
## Please use `cols = c()`</code></pre>
<pre><code>## # A tibble: 3 × 4
##      id      A      B      C
##   &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1     1 -0.811 -0.559 0.228 
## 2     2 -1.93   0.932 0.0459
## 3     3  0.762 -0.596 0.0875</code></pre>
<p>Wszystkie funkcje zawarte w pakietach tidyverse są dostosowane do pracy w potokach - pierwszym argumentem zawsze jest ramka danych. Może się jednak zdarzyć przy korzystaniu np. ze starszych pakietów, że ramka danych nie znajdzie się w pierwszym argumencie funkcji. Wtedy można użyć notacji z . albo zastosować tradycyjny zapis.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="analiza-i-transformacja-danych.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wykorzystanie . do określenia gdzie ma zostać wpisany wynik funkcji znajdującje się po lewej stronie</span></span>
<span id="cb131-2"><a href="analiza-i-transformacja-danych.html#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lm dopasowuje model liniowy do danych, więcej na ten temat w rodziale statystyka</span></span>
<span id="cb131-3"><a href="analiza-i-transformacja-danych.html#cb131-3" aria-hidden="true" tabindex="-1"></a>mock_data_long <span class="sc">%&gt;%</span> <span class="fu">lm</span>(<span class="at">formula =</span> value <span class="sc">~</span> key, <span class="at">data =</span> .)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = value ~ key, data = .)
## 
## Coefficients:
## (Intercept)         keyB         keyC  
##    0.081042    -0.072308     0.002584</code></pre>
<p>Końcowy wynik potoku można przypisać do nowej zmiennej na początku korzystając ze strzałki &lt;- albo na końcu -&gt;</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="analiza-i-transformacja-danych.html#cb133-1" aria-hidden="true" tabindex="-1"></a>mock_data_long <span class="sc">%&gt;%</span> <span class="fu">lm</span>(<span class="at">formula =</span> value <span class="sc">~</span> key, <span class="at">data =</span> .) <span class="ot">-&gt;</span> wynik</span>
<span id="cb133-2"><a href="analiza-i-transformacja-danych.html#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wynik)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = value ~ key, data = .)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.34732 -0.67128 -0.02383  0.65961  2.84088 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  0.081042   0.096194   0.842    0.400
## keyB        -0.072308   0.136039  -0.532    0.595
## keyC         0.002584   0.136039   0.019    0.985
## 
## Residual standard error: 0.9619 on 297 degrees of freedom
## Multiple R-squared:  0.001314,   Adjusted R-squared:  -0.005412 
## F-statistic: 0.1953 on 2 and 297 DF,  p-value: 0.8227</code></pre>
</div>
<div id="sortowanie" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Sortowanie</h2>
<p>Do sortowania danych można użyć funkcji <code>arrange()</code>. Jako argumenty wystarczy podać nazwy kolumn według których dane mają być posortowane. Domyślnie sortuje rosnąco. Jeżeli dana kolumna ma być posortowana malejąco należy dodać do jej nazwy <code>desc()</code>.</p>
<p>Natomiast do zmiany położenia kolumn w danych służy funkcja <code>select</code> lub <code>relocate</code>. <code>select</code> pozwala też na usunięcie kolumn, jako argumenty trzeba po prostu podać nazwy kolumn w takiej kolejności jak chcemy żeby znalazły się wynikach. W przypadku <code>relocate</code> kolumny nigdy nie zostaną usunięte z danych, można kontrolować pozycję przenoszonej kolumny przy pomocy argumentów <code>.after</code> i <code>.before</code>.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="analiza-i-transformacja-danych.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb135-2"><a href="analiza-i-transformacja-danych.html#cb135-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-3"><a href="analiza-i-transformacja-danych.html#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sortowanie po jednej zmiennej</span></span>
<span id="cb135-4"><a href="analiza-i-transformacja-danych.html#cb135-4" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(body_mass_g)</span></code></pre></div>
<pre><code>## # A tibble: 344 × 8
##    species   island    bill_length_mm bill_depth_mm flipper_length_… body_mass_g
##    &lt;fct&gt;     &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;            &lt;int&gt;       &lt;int&gt;
##  1 Chinstrap Dream               46.9          16.6              192        2700
##  2 Adelie    Biscoe              36.5          16.6              181        2850
##  3 Adelie    Biscoe              36.4          17.1              184        2850
##  4 Adelie    Biscoe              34.5          18.1              187        2900
##  5 Adelie    Dream               33.1          16.1              178        2900
##  6 Adelie    Torgersen           38.6          17                188        2900
##  7 Chinstrap Dream               43.2          16.6              187        2900
##  8 Adelie    Biscoe              37.9          18.6              193        2925
##  9 Adelie    Dream               37.5          18.9              179        2975
## 10 Adelie    Dream               37            16.9              185        3000
## # … with 334 more rows, and 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="analiza-i-transformacja-danych.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wiele zmiennych</span></span>
<span id="cb137-2"><a href="analiza-i-transformacja-danych.html#cb137-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(species, <span class="fu">desc</span>(island), bill_length_mm)</span></code></pre></div>
<pre><code>## # A tibble: 344 × 8
##    species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
##    &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
##  1 Adelie  Torgersen           33.5          19                 190        3600
##  2 Adelie  Torgersen           34.1          18.1               193        3475
##  3 Adelie  Torgersen           34.4          18.4               184        3325
##  4 Adelie  Torgersen           34.6          21.1               198        4400
##  5 Adelie  Torgersen           34.6          17.2               189        3200
##  6 Adelie  Torgersen           35.1          19.4               193        4200
##  7 Adelie  Torgersen           35.2          15.9               186        3050
##  8 Adelie  Torgersen           35.5          17.5               190        3700
##  9 Adelie  Torgersen           35.7          17                 189        3350
## 10 Adelie  Torgersen           35.9          16.6               190        3050
## # … with 334 more rows, and 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="analiza-i-transformacja-danych.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># przykład relocate</span></span>
<span id="cb139-2"><a href="analiza-i-transformacja-danych.html#cb139-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">relocate</span>(year, <span class="at">.after =</span> island)</span></code></pre></div>
<pre><code>## # A tibble: 344 × 8
##    species island     year bill_length_mm bill_depth_mm flipper_length_mm
##    &lt;fct&gt;   &lt;fct&gt;     &lt;int&gt;          &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;
##  1 Adelie  Torgersen  2007           39.1          18.7               181
##  2 Adelie  Torgersen  2007           39.5          17.4               186
##  3 Adelie  Torgersen  2007           40.3          18                 195
##  4 Adelie  Torgersen  2007           NA            NA                  NA
##  5 Adelie  Torgersen  2007           36.7          19.3               193
##  6 Adelie  Torgersen  2007           39.3          20.6               190
##  7 Adelie  Torgersen  2007           38.9          17.8               181
##  8 Adelie  Torgersen  2007           39.2          19.6               195
##  9 Adelie  Torgersen  2007           34.1          18.1               193
## 10 Adelie  Torgersen  2007           42            20.2               190
## # … with 334 more rows, and 2 more variables: body_mass_g &lt;int&gt;, sex &lt;fct&gt;</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="analiza-i-transformacja-danych.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># przenoszenie kilku zmiennych naraz z wykorzystaniem starts_with</span></span>
<span id="cb141-2"><a href="analiza-i-transformacja-danych.html#cb141-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">relocate</span>(<span class="fu">starts_with</span>(<span class="st">&#39;bill&#39;</span>), <span class="at">.after =</span> body_mass_g)</span></code></pre></div>
<pre><code>## # A tibble: 344 × 8
##    species island    flipper_length_mm body_mass_g bill_length_mm bill_depth_mm
##    &lt;fct&gt;   &lt;fct&gt;                 &lt;int&gt;       &lt;int&gt;          &lt;dbl&gt;         &lt;dbl&gt;
##  1 Adelie  Torgersen               181        3750           39.1          18.7
##  2 Adelie  Torgersen               186        3800           39.5          17.4
##  3 Adelie  Torgersen               195        3250           40.3          18  
##  4 Adelie  Torgersen                NA          NA           NA            NA  
##  5 Adelie  Torgersen               193        3450           36.7          19.3
##  6 Adelie  Torgersen               190        3650           39.3          20.6
##  7 Adelie  Torgersen               181        3625           38.9          17.8
##  8 Adelie  Torgersen               195        4675           39.2          19.6
##  9 Adelie  Torgersen               193        3475           34.1          18.1
## 10 Adelie  Torgersen               190        4250           42            20.2
## # … with 334 more rows, and 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="analiza-i-transformacja-danych.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to samo ale z select - więcej pisania ;)</span></span>
<span id="cb143-2"><a href="analiza-i-transformacja-danych.html#cb143-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">select</span>(species, island, flipper_length_mm, body_mass_g, bill_length_mm, bill_depth_mm, sex, year)</span></code></pre></div>
<pre><code>## # A tibble: 344 × 8
##    species island    flipper_length_mm body_mass_g bill_length_mm bill_depth_mm
##    &lt;fct&gt;   &lt;fct&gt;                 &lt;int&gt;       &lt;int&gt;          &lt;dbl&gt;         &lt;dbl&gt;
##  1 Adelie  Torgersen               181        3750           39.1          18.7
##  2 Adelie  Torgersen               186        3800           39.5          17.4
##  3 Adelie  Torgersen               195        3250           40.3          18  
##  4 Adelie  Torgersen                NA          NA           NA            NA  
##  5 Adelie  Torgersen               193        3450           36.7          19.3
##  6 Adelie  Torgersen               190        3650           39.3          20.6
##  7 Adelie  Torgersen               181        3625           38.9          17.8
##  8 Adelie  Torgersen               195        4675           39.2          19.6
##  9 Adelie  Torgersen               193        3475           34.1          18.1
## 10 Adelie  Torgersen               190        4250           42            20.2
## # … with 334 more rows, and 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="analiza-i-transformacja-danych.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># albo tak</span></span>
<span id="cb145-2"><a href="analiza-i-transformacja-danych.html#cb145-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&#39;bill&#39;</span>), <span class="fu">everything</span>())</span></code></pre></div>
<pre><code>## # A tibble: 344 × 8
##    bill_length_mm bill_depth_mm species island    flipper_length_mm body_mass_g
##             &lt;dbl&gt;         &lt;dbl&gt; &lt;fct&gt;   &lt;fct&gt;                 &lt;int&gt;       &lt;int&gt;
##  1           39.1          18.7 Adelie  Torgersen               181        3750
##  2           39.5          17.4 Adelie  Torgersen               186        3800
##  3           40.3          18   Adelie  Torgersen               195        3250
##  4           NA            NA   Adelie  Torgersen                NA          NA
##  5           36.7          19.3 Adelie  Torgersen               193        3450
##  6           39.3          20.6 Adelie  Torgersen               190        3650
##  7           38.9          17.8 Adelie  Torgersen               181        3625
##  8           39.2          19.6 Adelie  Torgersen               195        4675
##  9           34.1          18.1 Adelie  Torgersen               193        3475
## 10           42            20.2 Adelie  Torgersen               190        4250
## # … with 334 more rows, and 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</code></pre>
</div>
<div id="filtrowanie" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Filtrowanie</h2>
<p>Do wybrania z tabeli tylko interesującego nas zbioru danych możemy użyć funkcji <code>filter</code>, <code>distinct</code>, <code>select</code> i <code>slice_*</code>.</p>
<p><code>filter</code> pozwala na wybranie wierszy spełniających konkretne warunki. Do wpisywania warunków konieczna jest znajomość wyrażeń logicznych w R:
* <code>==</code> równy
* <code>!=</code> nie równy
* <code>&lt;</code> mniejszy
* <code>&lt;=</code> mniejszy równy
* <code>&gt;</code> większy
* <code>&gt;=</code> większy równy
* <code>&amp;</code> i
* <code>|</code> lub
* <code>%in%</code> znajduje się w zbiorze danych (wektor)</p>
<p><code>select</code> można wybrać kolejne kolumny wpisując ich nawy albo korzystając z funkcji pomocniczych np. <code>starts_with</code>.</p>
<p><code>distinct</code> pozwala na pozostawienie jedynie unikalnych kombinacji zmiennych. Jako argumenty należy podac jedynie nazwy kolumn. Domyślnie usunie wszystkie pozostałe kolumny, ale można je zostawić wgumentem .keep. Przydatna funkcja np. do usuwania duplikatów z danych.</p>
<p>Natomiast do usunięcia z danych wszystkich wierszy w których pojawia się wartość NA można użyć funkcji <code>drop_na</code>.</p>
<p>Do wybrania jedynie fragmentu danych można też użyć funkcji <code>slice</code>. W najprostszej postaci można wybrać dane po numerach wierszy podobnie jak w indeksowaniu ramki danych przy pomocy []. Dodatkowe funkcje umożliwiają większą kontrolę: <code>slice_head</code> albo <code>slice_tail</code> wybierają z danych odpowiednio pierwsze i ostatnie wiersze, liczba kontrolowana argumentem n. Natomiast <code>slice_sample</code> wybierze z danych losowe wiersze, liczba określona argumentem n, działa analogicznie do funkcji <code>sample</code>.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="analiza-i-transformacja-danych.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filter - tylko Adelie z wyspy Torgersen</span></span>
<span id="cb147-2"><a href="analiza-i-transformacja-danych.html#cb147-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">&#39;Adelie&#39;</span>, island <span class="sc">==</span> <span class="st">&#39;Torgersen&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 52 × 8
##    species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
##    &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
##  1 Adelie  Torgersen           39.1          18.7               181        3750
##  2 Adelie  Torgersen           39.5          17.4               186        3800
##  3 Adelie  Torgersen           40.3          18                 195        3250
##  4 Adelie  Torgersen           NA            NA                  NA          NA
##  5 Adelie  Torgersen           36.7          19.3               193        3450
##  6 Adelie  Torgersen           39.3          20.6               190        3650
##  7 Adelie  Torgersen           38.9          17.8               181        3625
##  8 Adelie  Torgersen           39.2          19.6               195        4675
##  9 Adelie  Torgersen           34.1          18.1               193        3475
## 10 Adelie  Torgersen           42            20.2               190        4250
## # … with 42 more rows, and 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="analiza-i-transformacja-danych.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filter - tylko pingwiny cięższe niż 4000 i płeć male</span></span>
<span id="cb149-2"><a href="analiza-i-transformacja-danych.html#cb149-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">filter</span>(body_mass_g <span class="sc">&gt;=</span> <span class="dv">4000</span>, sex <span class="sc">==</span> <span class="st">&#39;male&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 114 × 8
##    species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
##    &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
##  1 Adelie  Torgersen           39.2          19.6               195        4675
##  2 Adelie  Torgersen           34.6          21.1               198        4400
##  3 Adelie  Torgersen           42.5          20.7               197        4500
##  4 Adelie  Torgersen           46            21.5               194        4200
##  5 Adelie  Dream               39.2          21.1               196        4150
##  6 Adelie  Dream               39.8          19.1               184        4650
##  7 Adelie  Dream               44.1          19.7               196        4400
##  8 Adelie  Dream               39.6          18.8               190        4600
##  9 Adelie  Dream               42.3          21.2               191        4150
## 10 Adelie  Biscoe              40.1          18.9               188        4300
## # … with 104 more rows, and 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="analiza-i-transformacja-danych.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># distinct - obecne w anych kombinacja species, island, sex</span></span>
<span id="cb151-2"><a href="analiza-i-transformacja-danych.html#cb151-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(species, island, sex)</span></code></pre></div>
<pre><code>## # A tibble: 13 × 3
##    species   island    sex   
##    &lt;fct&gt;     &lt;fct&gt;     &lt;fct&gt; 
##  1 Adelie    Torgersen male  
##  2 Adelie    Torgersen female
##  3 Adelie    Torgersen &lt;NA&gt;  
##  4 Adelie    Biscoe    female
##  5 Adelie    Biscoe    male  
##  6 Adelie    Dream     female
##  7 Adelie    Dream     male  
##  8 Adelie    Dream     &lt;NA&gt;  
##  9 Gentoo    Biscoe    female
## 10 Gentoo    Biscoe    male  
## 11 Gentoo    Biscoe    &lt;NA&gt;  
## 12 Chinstrap Dream     female
## 13 Chinstrap Dream     male</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="analiza-i-transformacja-danych.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># usuwanie NA i potem distinct</span></span>
<span id="cb153-2"><a href="analiza-i-transformacja-danych.html#cb153-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(species, island, sex)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##    species   island    sex   
##    &lt;fct&gt;     &lt;fct&gt;     &lt;fct&gt; 
##  1 Adelie    Torgersen male  
##  2 Adelie    Torgersen female
##  3 Adelie    Biscoe    female
##  4 Adelie    Biscoe    male  
##  5 Adelie    Dream     female
##  6 Adelie    Dream     male  
##  7 Gentoo    Biscoe    female
##  8 Gentoo    Biscoe    male  
##  9 Chinstrap Dream     female
## 10 Chinstrap Dream     male</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="analiza-i-transformacja-danych.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># do wyświetlenia wszystkich możliwych kombinacji zmiennych można użyć funkcji expand albo complete</span></span>
<span id="cb155-2"><a href="analiza-i-transformacja-danych.html#cb155-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(species, island, sex) <span class="sc">%&gt;%</span> <span class="fu">expand</span>(species, island)</span></code></pre></div>
<pre><code>## # A tibble: 9 × 2
##   species   island   
##   &lt;fct&gt;     &lt;fct&gt;    
## 1 Adelie    Biscoe   
## 2 Adelie    Dream    
## 3 Adelie    Torgersen
## 4 Chinstrap Biscoe   
## 5 Chinstrap Dream    
## 6 Chinstrap Torgersen
## 7 Gentoo    Biscoe   
## 8 Gentoo    Dream    
## 9 Gentoo    Torgersen</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="analiza-i-transformacja-danych.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># możliwe kombinacje + uzupełni NA w innych kolumnach tam gdzie brakuje danych</span></span>
<span id="cb157-2"><a href="analiza-i-transformacja-danych.html#cb157-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(species, island, sex) <span class="sc">%&gt;%</span> <span class="fu">complete</span>(species, island) </span></code></pre></div>
<pre><code>## # A tibble: 14 × 3
##    species   island    sex   
##    &lt;fct&gt;     &lt;fct&gt;     &lt;fct&gt; 
##  1 Adelie    Biscoe    female
##  2 Adelie    Biscoe    male  
##  3 Adelie    Dream     female
##  4 Adelie    Dream     male  
##  5 Adelie    Torgersen male  
##  6 Adelie    Torgersen female
##  7 Chinstrap Biscoe    &lt;NA&gt;  
##  8 Chinstrap Dream     female
##  9 Chinstrap Dream     male  
## 10 Chinstrap Torgersen &lt;NA&gt;  
## 11 Gentoo    Biscoe    female
## 12 Gentoo    Biscoe    male  
## 13 Gentoo    Dream     &lt;NA&gt;  
## 14 Gentoo    Torgersen &lt;NA&gt;</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="analiza-i-transformacja-danych.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wybrane wiersze od 3 do 8</span></span>
<span id="cb159-2"><a href="analiza-i-transformacja-danych.html#cb159-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">8</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 8
##   species island bill_length_mm bill_depth_mm flipper_length_… body_mass_g sex  
##   &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;            &lt;int&gt;       &lt;int&gt; &lt;fct&gt;
## 1 Adelie  Torge…           40.3          18                195        3250 fema…
## 2 Adelie  Torge…           NA            NA                 NA          NA &lt;NA&gt; 
## 3 Adelie  Torge…           36.7          19.3              193        3450 fema…
## 4 Adelie  Torge…           39.3          20.6              190        3650 male 
## 5 Adelie  Torge…           38.9          17.8              181        3625 fema…
## 6 Adelie  Torge…           39.2          19.6              195        4675 male 
## # … with 1 more variable: year &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="analiza-i-transformacja-danych.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pierwsze 10 wierszy </span></span>
<span id="cb161-2"><a href="analiza-i-transformacja-danych.html#cb161-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 8
##    species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
##    &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
##  1 Adelie  Torgersen           39.1          18.7               181        3750
##  2 Adelie  Torgersen           39.5          17.4               186        3800
##  3 Adelie  Torgersen           40.3          18                 195        3250
##  4 Adelie  Torgersen           NA            NA                  NA          NA
##  5 Adelie  Torgersen           36.7          19.3               193        3450
##  6 Adelie  Torgersen           39.3          20.6               190        3650
##  7 Adelie  Torgersen           38.9          17.8               181        3625
##  8 Adelie  Torgersen           39.2          19.6               195        4675
##  9 Adelie  Torgersen           34.1          18.1               193        3475
## 10 Adelie  Torgersen           42            20.2               190        4250
## # … with 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="analiza-i-transformacja-danych.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5 losowych wierszy</span></span>
<span id="cb163-2"><a href="analiza-i-transformacja-danych.html#cb163-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 8
##   species island bill_length_mm bill_depth_mm flipper_length_… body_mass_g sex  
##   &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;            &lt;int&gt;       &lt;int&gt; &lt;fct&gt;
## 1 Chinst… Dream            46.1          18.2              178        3250 fema…
## 2 Gentoo  Biscoe           42.9          13.1              215        5000 fema…
## 3 Gentoo  Biscoe           47.2          13.7              214        4925 fema…
## 4 Gentoo  Biscoe           46.3          15.8              215        5050 male 
## 5 Gentoo  Biscoe           50            15.3              220        5550 male 
## # … with 1 more variable: year &lt;int&gt;</code></pre>
</div>
<div id="grupowanie-i-obliczanie-nowych-zmiennych" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Grupowanie i obliczanie nowych zmiennych</h2>
<p>Jedną z najbardziej przydatnych funkcji pakietu dplyr jest <code>group_by</code>, która pozwala na wydzielenie grup w danych przed wykonaniem następnych funkcji. Argumentami <code>group_by</code> są kolejne nazwy kolumn rozdzielone przecinkami. <code>group_by</code> w żaden sposób nie zmienia danych w tabeli, jej efektem jest tylko dodanie do tabeli informacji o tym, w której kolumnie znajduje się zmienna. Grupy z danych można usunąć przy pomocy funkcji <code>ungroup</code> albo nadpisać nowym <code>group_by</code>.</p>
<p>Dodanie grup do danych sprawia, że wszystkie kolejne funkcje będą wykonywane na fragmentach oryginalnej tabeli. Dzięki temu można np. obliczyć średnią dla każdej grupy, odfiltrować z każdej grupy tylko wartości maksymalne, wyświetlić tylko 3 wiersze z każdej grupy, dopasować model do każdej grupy osobno itd.</p>
<p><code>group_by</code> można łączyć z dwiema funkcjami, które służą do dodawania nowych zmiennych do tabeli - <code>summarise</code> i <code>mutate</code>, ale przydaje się również przy filtrowaniu albo sortowaniu danych.</p>
<p><code>mutate</code> pozwala na dodanie nowych kolumn na końcu ramki danych, ale nie usuwa poprzednich kolumn. Jako argumenty w <code>mutate</code> należy podać nazwę nowej kolumny = sposób policzenia nowej kolumny.</p>
<p>Szczególnie przydatna jest funkcja <code>ifelse</code>, która pozwala na przygotowanie nowej zmiennej na podstawie warunku logicznego. Zawsze posiada ona trzy argumenty. Pierwszy to warunek logiczny np. kolumna == 5, drugi to wartość, która ma zostać podana w wypadku spełnienia warunku, trzeci to wartość, która ma zostać podana gry warunek nie będzie spełniony. W wypadku gdy potrzebne jest więcej niż dwie opcje można użyć funkcji <code>case_when</code></p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="analiza-i-transformacja-danych.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># operacje matematyczne na kolumnach</span></span>
<span id="cb165-2"><a href="analiza-i-transformacja-danych.html#cb165-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(species, sex) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">st_bill =</span> bill_length_mm<span class="sc">/</span>bill_depth_mm)</span></code></pre></div>
<pre><code>## # A tibble: 344 × 9
## # Groups:   species, sex [8]
##    species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
##    &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
##  1 Adelie  Torgersen           39.1          18.7               181        3750
##  2 Adelie  Torgersen           39.5          17.4               186        3800
##  3 Adelie  Torgersen           40.3          18                 195        3250
##  4 Adelie  Torgersen           NA            NA                  NA          NA
##  5 Adelie  Torgersen           36.7          19.3               193        3450
##  6 Adelie  Torgersen           39.3          20.6               190        3650
##  7 Adelie  Torgersen           38.9          17.8               181        3625
##  8 Adelie  Torgersen           39.2          19.6               195        4675
##  9 Adelie  Torgersen           34.1          18.1               193        3475
## 10 Adelie  Torgersen           42            20.2               190        4250
## # … with 334 more rows, and 3 more variables: sex &lt;fct&gt;, year &lt;int&gt;,
## #   st_bill &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="analiza-i-transformacja-danych.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wartość maksymalna i obliczanie procentów</span></span>
<span id="cb167-2"><a href="analiza-i-transformacja-danych.html#cb167-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(species, sex) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">max_bill_depth =</span> <span class="fu">max</span>(bill_depth_mm),</span>
<span id="cb167-3"><a href="analiza-i-transformacja-danych.html#cb167-3" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">procent =</span> bill_depth_mm<span class="sc">/</span>max_bill_depth) <span class="sc">%&gt;%</span></span>
<span id="cb167-4"><a href="analiza-i-transformacja-danych.html#cb167-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(procent, max_bill_depth, <span class="at">.after =</span> island)</span></code></pre></div>
<pre><code>## # A tibble: 344 × 10
## # Groups:   species, sex [8]
##    species island    procent max_bill_depth bill_length_mm bill_depth_mm
##    &lt;fct&gt;   &lt;fct&gt;       &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;         &lt;dbl&gt;
##  1 Adelie  Torgersen   0.870           21.5           39.1          18.7
##  2 Adelie  Torgersen   0.841           20.7           39.5          17.4
##  3 Adelie  Torgersen   0.870           20.7           40.3          18  
##  4 Adelie  Torgersen  NA               NA             NA            NA  
##  5 Adelie  Torgersen   0.932           20.7           36.7          19.3
##  6 Adelie  Torgersen   0.958           21.5           39.3          20.6
##  7 Adelie  Torgersen   0.860           20.7           38.9          17.8
##  8 Adelie  Torgersen   0.912           21.5           39.2          19.6
##  9 Adelie  Torgersen  NA               NA             34.1          18.1
## 10 Adelie  Torgersen  NA               NA             42            20.2
## # … with 334 more rows, and 4 more variables: flipper_length_mm &lt;int&gt;,
## #   body_mass_g &lt;int&gt;, sex &lt;fct&gt;, year &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="analiza-i-transformacja-danych.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># zastosowanie funkcji ifelse</span></span>
<span id="cb169-2"><a href="analiza-i-transformacja-danych.html#cb169-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(species, sex) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">czy_jest_plec =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(sex), <span class="st">&#39;tak&#39;</span>, <span class="st">&#39;nie&#39;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 344 × 9
## # Groups:   species, sex [8]
##    species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
##    &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
##  1 Adelie  Torgersen           39.1          18.7               181        3750
##  2 Adelie  Torgersen           39.5          17.4               186        3800
##  3 Adelie  Torgersen           40.3          18                 195        3250
##  4 Adelie  Torgersen           NA            NA                  NA          NA
##  5 Adelie  Torgersen           36.7          19.3               193        3450
##  6 Adelie  Torgersen           39.3          20.6               190        3650
##  7 Adelie  Torgersen           38.9          17.8               181        3625
##  8 Adelie  Torgersen           39.2          19.6               195        4675
##  9 Adelie  Torgersen           34.1          18.1               193        3475
## 10 Adelie  Torgersen           42            20.2               190        4250
## # … with 334 more rows, and 3 more variables: sex &lt;fct&gt;, year &lt;int&gt;,
## #   czy_jest_plec &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="analiza-i-transformacja-danych.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># zastosowanie case_when</span></span>
<span id="cb171-2"><a href="analiza-i-transformacja-danych.html#cb171-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(species, sex) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">wielkosc =</span> <span class="fu">case_when</span>(body_mass_g <span class="sc">&lt;=</span> <span class="dv">3000</span> <span class="sc">~</span> <span class="st">&#39;mały&#39;</span>,</span>
<span id="cb171-3"><a href="analiza-i-transformacja-danych.html#cb171-3" aria-hidden="true" tabindex="-1"></a>                                                                    body_mass_g <span class="sc">&gt;</span> <span class="dv">3000</span> <span class="sc">&amp;</span> body_mass_g <span class="sc">&lt;</span> <span class="dv">4000</span> <span class="sc">~</span> <span class="st">&#39;średni&#39;</span>,</span>
<span id="cb171-4"><a href="analiza-i-transformacja-danych.html#cb171-4" aria-hidden="true" tabindex="-1"></a>                                                                    body_mass_g <span class="sc">&gt;=</span> <span class="dv">4000</span> <span class="sc">~</span> <span class="st">&#39;duży&#39;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 344 × 9
## # Groups:   species, sex [8]
##    species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
##    &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
##  1 Adelie  Torgersen           39.1          18.7               181        3750
##  2 Adelie  Torgersen           39.5          17.4               186        3800
##  3 Adelie  Torgersen           40.3          18                 195        3250
##  4 Adelie  Torgersen           NA            NA                  NA          NA
##  5 Adelie  Torgersen           36.7          19.3               193        3450
##  6 Adelie  Torgersen           39.3          20.6               190        3650
##  7 Adelie  Torgersen           38.9          17.8               181        3625
##  8 Adelie  Torgersen           39.2          19.6               195        4675
##  9 Adelie  Torgersen           34.1          18.1               193        3475
## 10 Adelie  Torgersen           42            20.2               190        4250
## # … with 334 more rows, and 3 more variables: sex &lt;fct&gt;, year &lt;int&gt;,
## #   wielkosc &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="analiza-i-transformacja-danych.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># normaliazacja danych przy pomocy scale</span></span>
<span id="cb173-2"><a href="analiza-i-transformacja-danych.html#cb173-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(species, sex) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">nor_body_mass =</span> <span class="fu">scale</span>(body_mass_g))</span></code></pre></div>
<pre><code>## # A tibble: 344 × 9
## # Groups:   species, sex [8]
##    species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
##    &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
##  1 Adelie  Torgersen           39.1          18.7               181        3750
##  2 Adelie  Torgersen           39.5          17.4               186        3800
##  3 Adelie  Torgersen           40.3          18                 195        3250
##  4 Adelie  Torgersen           NA            NA                  NA          NA
##  5 Adelie  Torgersen           36.7          19.3               193        3450
##  6 Adelie  Torgersen           39.3          20.6               190        3650
##  7 Adelie  Torgersen           38.9          17.8               181        3625
##  8 Adelie  Torgersen           39.2          19.6               195        4675
##  9 Adelie  Torgersen           34.1          18.1               193        3475
## 10 Adelie  Torgersen           42            20.2               190        4250
## # … with 334 more rows, and 3 more variables: sex &lt;fct&gt;, year &lt;int&gt;,
## #   nor_body_mass &lt;dbl[,1]&gt;</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="analiza-i-transformacja-danych.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># średnia ruchoma  - konieczny pakiet zoo</span></span>
<span id="cb175-2"><a href="analiza-i-transformacja-danych.html#cb175-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(species, island, sex) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(species, island, sex) <span class="sc">%&gt;%</span></span>
<span id="cb175-3"><a href="analiza-i-transformacja-danych.html#cb175-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean =</span> zoo<span class="sc">::</span><span class="fu">rollmean</span>(body_mass_g,</span>
<span id="cb175-4"><a href="analiza-i-transformacja-danych.html#cb175-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">k =</span> <span class="dv">3</span>, <span class="co"># szerokość okna do średniej ruchomej</span></span>
<span id="cb175-5"><a href="analiza-i-transformacja-danych.html#cb175-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fill =</span> <span class="cn">NA</span>)) <span class="co"># czym uzupełnić brakujące wartości</span></span></code></pre></div>
<pre><code>## # A tibble: 344 × 9
## # Groups:   species, island, sex [13]
##    species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
##    &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
##  1 Adelie  Biscoe           37.8          18.3               174        3400
##  2 Adelie  Biscoe           35.9          19.2               189        3800
##  3 Adelie  Biscoe           35.3          18.9               187        3800
##  4 Adelie  Biscoe           40.5          17.9               187        3200
##  5 Adelie  Biscoe           37.9          18.6               172        3150
##  6 Adelie  Biscoe           39.6          17.7               186        3500
##  7 Adelie  Biscoe           35            17.9               190        3450
##  8 Adelie  Biscoe           34.5          18.1               187        2900
##  9 Adelie  Biscoe           39            17.5               186        3550
## 10 Adelie  Biscoe           36.5          16.6               181        2850
## # … with 334 more rows, and 3 more variables: sex &lt;fct&gt;, year &lt;int&gt;, mean &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="analiza-i-transformacja-danych.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># group_by + slice_head + arrange - dwa pierwsze wiersze z każdej grupy, posortowane po masie ciała</span></span>
<span id="cb177-2"><a href="analiza-i-transformacja-danych.html#cb177-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(body_mass_g)) <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 8
## # Groups:   species [3]
##   species island bill_length_mm bill_depth_mm flipper_length_… body_mass_g sex  
##   &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;            &lt;int&gt;       &lt;int&gt; &lt;fct&gt;
## 1 Adelie  Biscoe           43.2          19                197        4775 male 
## 2 Adelie  Biscoe           41            20                203        4725 male 
## 3 Chinst… Dream            52            20.7              210        4800 male 
## 4 Chinst… Dream            52.8          20                205        4550 male 
## 5 Gentoo  Biscoe           49.2          15.2              221        6300 male 
## 6 Gentoo  Biscoe           59.6          17                230        6050 male 
## # … with 1 more variable: year &lt;int&gt;</code></pre>
<p><code>summarise</code> tworzy nową tabelę, która będzie zawierała jedynie zmienne grupujące i nowo utworzone zmienne. Jeżeli dane nie są podzielone na żadne grupy to wynikiem <code>summarise</code> będzie tabela posiadająca tylko jeden wiersz.</p>
<p>Jeżeli potrzebne jest zastosowanie tej samej funkcji dla większej liczby kolumn np. <code>mean</code> można wykorzystać funkcję <code>across</code>.</p>
<p>Zliczenie elementów można przeprowadzić wykorzystując funkcje pomocniczą <code>n</code> albo <code>count</code></p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="analiza-i-transformacja-danych.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># obliczanie średniej</span></span>
<span id="cb179-2"><a href="analiza-i-transformacja-danych.html#cb179-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(species, sex) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sex)) <span class="sc">%&gt;%</span></span>
<span id="cb179-3"><a href="analiza-i-transformacja-danych.html#cb179-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_mass =</span> <span class="fu">mean</span>(body_mass_g))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;species&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>## # A tibble: 6 × 3
## # Groups:   species [3]
##   species   sex    mean_mass
##   &lt;fct&gt;     &lt;fct&gt;      &lt;dbl&gt;
## 1 Adelie    female     3369.
## 2 Adelie    male       4043.
## 3 Chinstrap female     3527.
## 4 Chinstrap male       3939.
## 5 Gentoo    female     4680.
## 6 Gentoo    male       5485.</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="analiza-i-transformacja-danych.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># średnia dla wszystkich zmiennych liczbowych</span></span>
<span id="cb182-2"><a href="analiza-i-transformacja-danych.html#cb182-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(species, sex) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sex)) <span class="sc">%&gt;%</span></span>
<span id="cb182-3"><a href="analiza-i-transformacja-danych.html#cb182-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">where</span>(is.numeric), <span class="co"># wybieramy tylko kolumny spełniajace warunke is.numeric</span></span>
<span id="cb182-4"><a href="analiza-i-transformacja-danych.html#cb182-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">.fns =</span> <span class="fu">c</span>(<span class="at">srednia =</span> mean, <span class="at">odch =</span> sd))) <span class="co"># lista funkcji - można każdą nazwać żeby w tabeli z wynikami były opisane</span></span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;species&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>## # A tibble: 6 × 12
## # Groups:   species [3]
##   species   sex    bill_length_mm_srednia bill_length_mm_odch bill_depth_mm_sre…
##   &lt;fct&gt;     &lt;fct&gt;                   &lt;dbl&gt;               &lt;dbl&gt;              &lt;dbl&gt;
## 1 Adelie    female                   37.3                2.03               17.6
## 2 Adelie    male                     40.4                2.28               19.1
## 3 Chinstrap female                   46.6                3.11               17.6
## 4 Chinstrap male                     51.1                1.56               19.3
## 5 Gentoo    female                   45.6                2.05               14.2
## 6 Gentoo    male                     49.5                2.72               15.7
## # … with 7 more variables: bill_depth_mm_odch &lt;dbl&gt;,
## #   flipper_length_mm_srednia &lt;dbl&gt;, flipper_length_mm_odch &lt;dbl&gt;,
## #   body_mass_g_srednia &lt;dbl&gt;, body_mass_g_odch &lt;dbl&gt;, year_srednia &lt;dbl&gt;,
## #   year_odch &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="analiza-i-transformacja-danych.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># zliczanie z n()</span></span>
<span id="cb185-2"><a href="analiza-i-transformacja-danych.html#cb185-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(species, sex) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sex)) <span class="sc">%&gt;%</span></span>
<span id="cb185-3"><a href="analiza-i-transformacja-danych.html#cb185-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;species&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>## # A tibble: 6 × 3
## # Groups:   species [3]
##   species   sex        n
##   &lt;fct&gt;     &lt;fct&gt;  &lt;int&gt;
## 1 Adelie    female    73
## 2 Adelie    male      73
## 3 Chinstrap female    34
## 4 Chinstrap male      34
## 5 Gentoo    female    58
## 6 Gentoo    male      61</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="analiza-i-transformacja-danych.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># zliczanie z count() - można pominąć group_by</span></span>
<span id="cb188-2"><a href="analiza-i-transformacja-danych.html#cb188-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sex)) <span class="sc">%&gt;%</span></span>
<span id="cb188-3"><a href="analiza-i-transformacja-danych.html#cb188-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(species, sex)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   species   sex        n
##   &lt;fct&gt;     &lt;fct&gt;  &lt;int&gt;
## 1 Adelie    female    73
## 2 Adelie    male      73
## 3 Chinstrap female    34
## 4 Chinstrap male      34
## 5 Gentoo    female    58
## 6 Gentoo    male      61</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="analiza-i-transformacja-danych.html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># połączenie z mutate</span></span>
<span id="cb190-2"><a href="analiza-i-transformacja-danych.html#cb190-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sex)) <span class="sc">%&gt;%</span> </span>
<span id="cb190-3"><a href="analiza-i-transformacja-danych.html#cb190-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(species, sex) <span class="sc">%&gt;%</span></span>
<span id="cb190-4"><a href="analiza-i-transformacja-danych.html#cb190-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb190-5"><a href="analiza-i-transformacja-danych.html#cb190-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">procent =</span> n<span class="sc">/</span><span class="fu">sum</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
## # Groups:   species [3]
##   species   sex        n procent
##   &lt;fct&gt;     &lt;fct&gt;  &lt;int&gt;   &lt;dbl&gt;
## 1 Adelie    female    73   0.5  
## 2 Adelie    male      73   0.5  
## 3 Chinstrap female    34   0.5  
## 4 Chinstrap male      34   0.5  
## 5 Gentoo    female    58   0.487
## 6 Gentoo    male      61   0.513</code></pre>
<p>Szczególnym przypadkiem funkcji tworzących nowe zmienne są <code>separate</code> i <code>unite</code> z pakietu tidyr. Ich działanie jest przeciwstawne i pozwalają odpowiednio na złączenie i rozłączenie zmiennych przy pomocy separatora np. _ albo .</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="analiza-i-transformacja-danych.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unite - domyślnie usuwa wejściowe kolumny, ale można je zostawić przy pomocy argumentu remove</span></span>
<span id="cb192-2"><a href="analiza-i-transformacja-danych.html#cb192-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">unite</span>(<span class="at">col =</span> nowa_kolumn, species, sex, <span class="at">sep =</span> <span class="st">&#39;_&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 344 × 7
##    nowa_kolumn   island    bill_length_mm bill_depth_mm flipper_length_… body_mass_g
##    &lt;chr&gt;         &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;            &lt;int&gt;       &lt;int&gt;
##  1 Adelie_male   Torgersen           39.1          18.7              181        3750
##  2 Adelie_female Torgersen           39.5          17.4              186        3800
##  3 Adelie_female Torgersen           40.3          18                195        3250
##  4 Adelie_NA     Torgersen           NA            NA                 NA          NA
##  5 Adelie_female Torgersen           36.7          19.3              193        3450
##  6 Adelie_male   Torgersen           39.3          20.6              190        3650
##  7 Adelie_female Torgersen           38.9          17.8              181        3625
##  8 Adelie_male   Torgersen           39.2          19.6              195        4675
##  9 Adelie_NA     Torgersen           34.1          18.1              193        3475
## 10 Adelie_NA     Torgersen           42            20.2              190        4250
## # … with 334 more rows, and 1 more variable: year &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="analiza-i-transformacja-danych.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># separate - również można wejściową kolumnę zostawić przy pomocy argumentu remove</span></span>
<span id="cb194-2"><a href="analiza-i-transformacja-danych.html#cb194-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">unite</span>(<span class="at">col =</span> nowa_kolumna, species, sex, <span class="at">sep =</span> <span class="st">&#39;_&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-3"><a href="analiza-i-transformacja-danych.html#cb194-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col =</span> nowa_kolumna, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&#39;gatunek&#39;</span>, <span class="st">&#39;plec&#39;</span>), <span class="at">sep =</span> <span class="st">&#39;_&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 344 × 8
##    gatunek plec   island    bill_length_mm bill_depth_mm flipper_length_mm
##    &lt;chr&gt;   &lt;chr&gt;  &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;
##  1 Adelie  male   Torgersen           39.1          18.7               181
##  2 Adelie  female Torgersen           39.5          17.4               186
##  3 Adelie  female Torgersen           40.3          18                 195
##  4 Adelie  NA     Torgersen           NA            NA                  NA
##  5 Adelie  female Torgersen           36.7          19.3               193
##  6 Adelie  male   Torgersen           39.3          20.6               190
##  7 Adelie  female Torgersen           38.9          17.8               181
##  8 Adelie  male   Torgersen           39.2          19.6               195
##  9 Adelie  NA     Torgersen           34.1          18.1               193
## 10 Adelie  NA     Torgersen           42            20.2               190
## # … with 334 more rows, and 2 more variables: body_mass_g &lt;int&gt;, year &lt;int&gt;</code></pre>
</div>
<div id="łączenie-tabel" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Łączenie tabel</h2>
<p>Do łączenia tabel w R można wykorzystać dwa typy funkcji: <code>bind_*</code> i <code>*_join</code>.</p>
<p>Funkcje <code>bind_cols</code> i <code>bind_rows</code> służą do sklejania tabel ze sobą odpowiednio według kolumn (jedna obok drugiej) i wierszy (jedna pod drugą). Są szczególnie przydatne w sytuacjach gdy dane wejściowe do analizy znajdują się w kilku różnych plikach, których struktura jest taka sama (układ kolumn itp.).</p>
<p>Do funkcji bind_rows, można dodać argument .id, który doda nową kolumnę do danych, zawierającą nazwy pierwotnych kolumn.</p>
<p>Druga grupa funkcji - <code>*_join</code> obejmuje funkcje, które łączą dane według pewnego klucza. Za klucz może służyć jedna albo więcej kolumn. Przykładowym kluczem może być np. nazwa genu albo kombinacja szczepu, nr komórki i czasu obserwacji.</p>
<p>Możliwe zastosowania funkcji <code>_join</code>
* wzbogacenie tabeli o dodatkowe informacje np. dołączenie do tabeli zawierającej ekspresję genu informacje o ich funkcji, położenia na genomie
* ponowne połączenie danych rozdzielonych w wyniku analizy np. dołączenie wyniku funkcji summarise do wejściowej tabeli
* wybranie tabeli tylko wierszy występujących w obu tabelach np. wybór genów o istotnie zmienionej ekspersji z dwóch eksperymentów RNA-seq.</p>
<p>Dla funkcji <code>*_join</code> kluczowe jest podanie argumentu by, który zidentyfikuje kolumny-klucze. Gdy w obu tabelach kolumny-klucze posiadają takie same nazwy funkcja sama je odnajdzie, w przeciwnym wypadku konieczne jest podanie ich nazw w formacie <code>by = c('kolumna_z_tab_1' = 'kolumna_z_tab_2')</code>.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="analiza-i-transformacja-danych.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># przykład bind_rows</span></span>
<span id="cb196-2"><a href="analiza-i-transformacja-danych.html#cb196-2" aria-hidden="true" tabindex="-1"></a>data_1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">y =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">z =</span> <span class="fu">c</span>(<span class="st">&#39;jeden&#39;</span>, <span class="st">&#39;dwa&#39;</span>, <span class="st">&#39;trzy&#39;</span>))</span>
<span id="cb196-3"><a href="analiza-i-transformacja-danych.html#cb196-3" aria-hidden="true" tabindex="-1"></a>data_2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">y =</span> letters[<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>], <span class="at">z =</span> <span class="fu">c</span>(<span class="st">&#39;jeden&#39;</span>, <span class="st">&#39;dwa&#39;</span>, <span class="st">&#39;trzy&#39;</span>))</span>
<span id="cb196-4"><a href="analiza-i-transformacja-danych.html#cb196-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-5"><a href="analiza-i-transformacja-danych.html#cb196-5" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(data_1, data_2)</span></code></pre></div>
<pre><code>##   x y     z
## 1 1 a jeden
## 2 2 b   dwa
## 3 3 c  trzy
## 4 4 j jeden
## 5 5 k   dwa
## 6 6 l  trzy</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="analiza-i-transformacja-danych.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># z ustawionym .id</span></span>
<span id="cb198-2"><a href="analiza-i-transformacja-danych.html#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="at">x =</span> data_1, <span class="at">y =</span> data_2, <span class="at">.id =</span> <span class="st">&#39;id&#39;</span>) <span class="co"># x =  itd. to podane nazwy tabel do kolumny id</span></span></code></pre></div>
<pre><code>##   id x y     z
## 1  x 1 a jeden
## 2  x 2 b   dwa
## 3  x 3 c  trzy
## 4  y 4 j jeden
## 5  y 5 k   dwa
## 6  y 6 l  trzy</code></pre>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="analiza-i-transformacja-danych.html#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># przykład bind_cols</span></span>
<span id="cb200-2"><a href="analiza-i-transformacja-danych.html#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_cols</span>(data_1, data_2)</span></code></pre></div>
<pre><code>## New names:
## * x -&gt; x...1
## * y -&gt; y...2
## * z -&gt; z...3
## * x -&gt; x...4
## * y -&gt; y...5
## * ...</code></pre>
<pre><code>##   x...1 y...2 z...3 x...4 y...5 z...6
## 1     1     a jeden     4     j jeden
## 2     2     b   dwa     5     k   dwa
## 3     3     c  trzy     6     l  trzy</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="analiza-i-transformacja-danych.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># przykład left_join - do tabeli po lewej dodaje pasujące wiersze z tabeli w nawiasie</span></span>
<span id="cb203-2"><a href="analiza-i-transformacja-danych.html#cb203-2" aria-hidden="true" tabindex="-1"></a>band_instruments</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   name  plays 
##   &lt;chr&gt; &lt;chr&gt; 
## 1 John  guitar
## 2 Paul  bass  
## 3 Keith guitar</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="analiza-i-transformacja-danych.html#cb205-1" aria-hidden="true" tabindex="-1"></a>band_members</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   name  band   
##   &lt;chr&gt; &lt;chr&gt;  
## 1 Mick  Stones 
## 2 John  Beatles
## 3 Paul  Beatles</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="analiza-i-transformacja-danych.html#cb207-1" aria-hidden="true" tabindex="-1"></a>band_instruments <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(band_members)</span></code></pre></div>
<pre><code>## Joining, by = &quot;name&quot;</code></pre>
<pre><code>## # A tibble: 3 × 3
##   name  plays  band   
##   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  
## 1 John  guitar Beatles
## 2 Paul  bass   Beatles
## 3 Keith guitar &lt;NA&gt;</code></pre>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="analiza-i-transformacja-danych.html#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># z by</span></span>
<span id="cb210-2"><a href="analiza-i-transformacja-danych.html#cb210-2" aria-hidden="true" tabindex="-1"></a>band_instruments2 <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(band_members, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;artist&#39;</span> <span class="ot">=</span> <span class="st">&#39;name&#39;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   artist plays  band   
##   &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  
## 1 John   guitar Beatles
## 2 Paul   bass   Beatles
## 3 Keith  guitar &lt;NA&gt;</code></pre>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="analiza-i-transformacja-danych.html#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># przykład inner_join - zostawia tylko wiersze z tabeli po lewej, które pasują do tabeli w nawiasie</span></span>
<span id="cb212-2"><a href="analiza-i-transformacja-danych.html#cb212-2" aria-hidden="true" tabindex="-1"></a>band_instruments <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(band_members)</span></code></pre></div>
<pre><code>## Joining, by = &quot;name&quot;</code></pre>
<pre><code>## # A tibble: 2 × 3
##   name  plays  band   
##   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  
## 1 John  guitar Beatles
## 2 Paul  bass   Beatles</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="analiza-i-transformacja-danych.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># przykład full_join - zostawia wszystkie wiersze z obu tabel (uzupełnia brakujące wartości jako NA)</span></span>
<span id="cb215-2"><a href="analiza-i-transformacja-danych.html#cb215-2" aria-hidden="true" tabindex="-1"></a>band_instruments <span class="sc">%&gt;%</span> <span class="fu">full_join</span>(band_members)</span></code></pre></div>
<pre><code>## Joining, by = &quot;name&quot;</code></pre>
<pre><code>## # A tibble: 4 × 3
##   name  plays  band   
##   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  
## 1 John  guitar Beatles
## 2 Paul  bass   Beatles
## 3 Keith guitar &lt;NA&gt;   
## 4 Mick  &lt;NA&gt;   Stones</code></pre>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="analiza-i-transformacja-danych.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># przykład anti_join - tylko wiersze w tabeli po lewej, które nie mają pary w tabeli w nawiasie</span></span>
<span id="cb218-2"><a href="analiza-i-transformacja-danych.html#cb218-2" aria-hidden="true" tabindex="-1"></a>band_instruments <span class="sc">%&gt;%</span> <span class="fu">anti_join</span>(band_members)</span></code></pre></div>
<pre><code>## Joining, by = &quot;name&quot;</code></pre>
<pre><code>## # A tibble: 1 × 2
##   name  plays 
##   &lt;chr&gt; &lt;chr&gt; 
## 1 Keith guitar</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dane.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="wykresy---pakiet-ggplot2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/05-data_analysis_dplyr.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
